var Wa=Object.defineProperty;var ja=(e,i,t)=>i in e?Wa(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t;var si=(e,i,t)=>(ja(e,typeof i!="symbol"?i+"":i,t),t);import{h as Ka,g as tt,C as $a,m as Ya,M as Va,d as Xa,n as Qa}from"./index-04a97e2f.js";import{a as Ja,_ as dt,b as qa,c as eo,C as li,a3 as to,F as io,M as un,G as no,l as it,a2 as ro}from"./layer-c9eaa646.js";import{S as Ar,I as ao,T as oo,C as so}from"./text-layer-caa19765.js";import{T as lo,c as fo,a as uo,P as ho}from"./path-layer-b6abcc3b.js";const hn=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,co={lightSources:{}};function fi(){let{color:e=[0,0,0],intensity:i=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e.map(t=>t*i/255)}function po(e){let{ambientLight:i,pointLights:t=[],directionalLights:n=[]}=e;const r={};return i?r["lighting_uAmbientLight.color"]=fi(i):r["lighting_uAmbientLight.color"]=[0,0,0],t.forEach((a,o)=>{r["lighting_uPointLight[".concat(o,"].color")]=fi(a),r["lighting_uPointLight[".concat(o,"].position")]=a.position,r["lighting_uPointLight[".concat(o,"].attenuation")]=a.attenuation||[1,0,0]}),r.lighting_uPointLightCount=t.length,n.forEach((a,o)=>{r["lighting_uDirectionalLight[".concat(o,"].color")]=fi(a),r["lighting_uDirectionalLight[".concat(o,"].direction")]=a.direction}),r.lighting_uDirectionalLightCount=n.length,r}function Cr(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:co;if("lightSources"in e){const{ambientLight:i,pointLights:t,directionalLights:n}=e.lightSources||{};return i||t&&t.length>0||n&&n.length>0?Object.assign({},po({ambientLight:i,pointLights:t,directionalLights:n}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const i={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":i.ambientLight=t;break;case"directional":i.directionalLights.push(t);break;case"point":i.pointLights.push(t);break}return Cr({lightSources:i})}return{}}const Er={name:"lights",vs:hn,fs:hn,getUniforms:Cr,defines:{MAX_LIGHTS:3}},Sr=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,go={};function vo(e){const{ambient:i=.35,diffuse:t=.6,shininess:n=32,specularColor:r=[30,30,30]}=e;return{lighting_uAmbient:i,lighting_uDiffuse:t,lighting_uShininess:n,lighting_uSpecularColor:r.map(a=>a/255)}}function Dr(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:go;if(!("material"in e))return{};const{material:i}=e;return i?vo(i):{lighting_uEnabled:!1}}const _o={name:"gouraud-lighting",dependencies:[Er],vs:Sr,defines:{LIGHTING_VERTEX:1},getUniforms:Dr},Eu={name:"phong-lighting",dependencies:[Er],fs:Sr,defines:{LIGHTING_FRAGMENT:1},getUniforms:Dr},Lr={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function kr(e,i,t={}){return xo(e,t)!==i?(wo(e,t),!0):!1}function xo(e,i={}){return Math.sign(yo(e,i))}function yo(e,i={}){const{start:t=0,end:n=e.length}=i,r=i.size||2;let a=0;for(let o=t,s=n-r;o<n;o+=r)a+=(e[o]-e[s])*(e[o+1]+e[s+1]),s=o;return a/2}function wo(e,i){const{start:t=0,end:n=e.length,size:r=2}=i,a=(n-t)/r,o=Math.floor(a/2);for(let s=0;s<o;++s){const u=t+s*r,l=t+(a-1-s)*r;for(let f=0;f<r;++f){const d=e[u+f];e[u+f]=e[l+f],e[l+f]=d}}}var Gi={exports:{}};Gi.exports=Qt;Gi.exports.default=Qt;function Qt(e,i,t){t=t||2;var n=i&&i.length,r=n?i[0]*t:e.length,a=Ir(e,0,r,t,!0),o=[];if(!a||a.next===a.prev)return o;var s,u,l,f,d,h,c;if(n&&(a=Eo(e,i,a,t)),e.length>80*t){s=l=e[0],u=f=e[1];for(var p=t;p<r;p+=t)d=e[p],h=e[p+1],d<s&&(s=d),h<u&&(u=h),d>l&&(l=d),h>f&&(f=h);c=Math.max(l-s,f-u),c=c!==0?32767/c:0}return nt(a,o,t,s,u,c,0),o}function Ir(e,i,t,n,r){var a,o;if(r===Li(e,i,t,n)>0)for(a=i;a<t;a+=n)o=dn(a,e[a],e[a+1],o);else for(a=t-n;a>=i;a-=n)o=dn(a,e[a],e[a+1],o);return o&&Jt(o,o.next)&&(at(o),o=o.next),o}function Ae(e,i){if(!e)return e;i||(i=e);var t=e,n;do if(n=!1,!t.steiner&&(Jt(t,t.next)||I(t.prev,t,t.next)===0)){if(at(t),t=i=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==i);return i}function nt(e,i,t,n,r,a,o){if(e){!o&&a&&Io(e,n,r,a);for(var s=e,u,l;e.prev!==e.next;){if(u=e.prev,l=e.next,a?bo(e,n,r,a):mo(e)){i.push(u.i/t|0),i.push(e.i/t|0),i.push(l.i/t|0),at(e),e=l.next,s=l.next;continue}if(e=l,e===s){o?o===1?(e=Ao(Ae(e),i,t),nt(e,i,t,n,r,a,2)):o===2&&Co(e,i,t,n,r,a):nt(Ae(e),i,t,n,r,a,1);break}}}}function mo(e){var i=e.prev,t=e,n=e.next;if(I(i,t,n)>=0)return!1;for(var r=i.x,a=t.x,o=n.x,s=i.y,u=t.y,l=n.y,f=r<a?r<o?r:o:a<o?a:o,d=s<u?s<l?s:l:u<l?u:l,h=r>a?r>o?r:o:a>o?a:o,c=s>u?s>l?s:l:u>l?u:l,p=n.next;p!==i;){if(p.x>=f&&p.x<=h&&p.y>=d&&p.y<=c&&Fe(r,s,a,u,o,l,p.x,p.y)&&I(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function bo(e,i,t,n){var r=e.prev,a=e,o=e.next;if(I(r,a,o)>=0)return!1;for(var s=r.x,u=a.x,l=o.x,f=r.y,d=a.y,h=o.y,c=s<u?s<l?s:l:u<l?u:l,p=f<d?f<h?f:h:d<h?d:h,_=s>u?s>l?s:l:u>l?u:l,w=f>d?f>h?f:h:d>h?d:h,x=Si(c,p,i,t,n),m=Si(_,w,i,t,n),v=e.prevZ,g=e.nextZ;v&&v.z>=x&&g&&g.z<=m;){if(v.x>=c&&v.x<=_&&v.y>=p&&v.y<=w&&v!==r&&v!==o&&Fe(s,f,u,d,l,h,v.x,v.y)&&I(v.prev,v,v.next)>=0||(v=v.prevZ,g.x>=c&&g.x<=_&&g.y>=p&&g.y<=w&&g!==r&&g!==o&&Fe(s,f,u,d,l,h,g.x,g.y)&&I(g.prev,g,g.next)>=0))return!1;g=g.nextZ}for(;v&&v.z>=x;){if(v.x>=c&&v.x<=_&&v.y>=p&&v.y<=w&&v!==r&&v!==o&&Fe(s,f,u,d,l,h,v.x,v.y)&&I(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;g&&g.z<=m;){if(g.x>=c&&g.x<=_&&g.y>=p&&g.y<=w&&g!==r&&g!==o&&Fe(s,f,u,d,l,h,g.x,g.y)&&I(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function Ao(e,i,t){var n=e;do{var r=n.prev,a=n.next.next;!Jt(r,a)&&Br(r,n,n.next,a)&&rt(r,a)&&rt(a,r)&&(i.push(r.i/t|0),i.push(n.i/t|0),i.push(a.i/t|0),at(n),at(n.next),n=e=a),n=n.next}while(n!==e);return Ae(n)}function Co(e,i,t,n,r,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Po(o,s)){var u=Tr(o,s);o=Ae(o,o.next),u=Ae(u,u.next),nt(o,i,t,n,r,a,0),nt(u,i,t,n,r,a,0);return}s=s.next}o=o.next}while(o!==e)}function Eo(e,i,t,n){var r=[],a,o,s,u,l;for(a=0,o=i.length;a<o;a++)s=i[a]*n,u=a<o-1?i[a+1]*n:e.length,l=Ir(e,s,u,n,!1),l===l.next&&(l.steiner=!0),r.push(To(l));for(r.sort(So),a=0;a<r.length;a++)t=Do(r[a],t);return t}function So(e,i){return e.x-i.x}function Do(e,i){var t=Lo(e,i);if(!t)return i;var n=Tr(t,e);return Ae(n,n.next),Ae(t,t.next)}function Lo(e,i){var t=i,n=e.x,r=e.y,a=-1/0,o;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){var s=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(s<=n&&s>a&&(a=s,o=t.x<t.next.x?t:t.next,s===n))return o}t=t.next}while(t!==i);if(!o)return null;var u=o,l=o.x,f=o.y,d=1/0,h;t=o;do n>=t.x&&t.x>=l&&n!==t.x&&Fe(r<f?n:a,r,l,f,r<f?a:n,r,t.x,t.y)&&(h=Math.abs(r-t.y)/(n-t.x),rt(t,e)&&(h<d||h===d&&(t.x>o.x||t.x===o.x&&ko(o,t)))&&(o=t,d=h)),t=t.next;while(t!==u);return o}function ko(e,i){return I(e.prev,e,i.prev)<0&&I(i.next,e,e.next)<0}function Io(e,i,t,n){var r=e;do r.z===0&&(r.z=Si(r.x,r.y,i,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,Bo(r)}function Bo(e){var i,t,n,r,a,o,s,u,l=1;do{for(t=e,e=null,a=null,o=0;t;){for(o++,n=t,s=0,i=0;i<l&&(s++,n=n.nextZ,!!n);i++);for(u=l;s>0||u>0&&n;)s!==0&&(u===0||!n||t.z<=n.z)?(r=t,t=t.nextZ,s--):(r=n,n=n.nextZ,u--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;t=n}a.nextZ=null,l*=2}while(o>1);return e}function Si(e,i,t,n,r){return e=(e-t)*r|0,i=(i-n)*r|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e|i<<1}function To(e){var i=e,t=e;do(i.x<t.x||i.x===t.x&&i.y<t.y)&&(t=i),i=i.next;while(i!==e);return t}function Fe(e,i,t,n,r,a,o,s){return(r-o)*(i-s)>=(e-o)*(a-s)&&(e-o)*(n-s)>=(t-o)*(i-s)&&(t-o)*(a-s)>=(r-o)*(n-s)}function Po(e,i){return e.next.i!==i.i&&e.prev.i!==i.i&&!Fo(e,i)&&(rt(e,i)&&rt(i,e)&&zo(e,i)&&(I(e.prev,e,i.prev)||I(e,i.prev,i))||Jt(e,i)&&I(e.prev,e,e.next)>0&&I(i.prev,i,i.next)>0)}function I(e,i,t){return(i.y-e.y)*(t.x-i.x)-(i.x-e.x)*(t.y-i.y)}function Jt(e,i){return e.x===i.x&&e.y===i.y}function Br(e,i,t,n){var r=Dt(I(e,i,t)),a=Dt(I(e,i,n)),o=Dt(I(t,n,e)),s=Dt(I(t,n,i));return!!(r!==a&&o!==s||r===0&&St(e,t,i)||a===0&&St(e,n,i)||o===0&&St(t,e,n)||s===0&&St(t,i,n))}function St(e,i,t){return i.x<=Math.max(e.x,t.x)&&i.x>=Math.min(e.x,t.x)&&i.y<=Math.max(e.y,t.y)&&i.y>=Math.min(e.y,t.y)}function Dt(e){return e>0?1:e<0?-1:0}function Fo(e,i){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==i.i&&t.next.i!==i.i&&Br(t,t.next,e,i))return!0;t=t.next}while(t!==e);return!1}function rt(e,i){return I(e.prev,e,e.next)<0?I(e,i,e.next)>=0&&I(e,e.prev,i)>=0:I(e,i,e.prev)<0||I(e,e.next,i)<0}function zo(e,i){var t=e,n=!1,r=(e.x+i.x)/2,a=(e.y+i.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&r<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==e);return n}function Tr(e,i){var t=new Di(e.i,e.x,e.y),n=new Di(i.i,i.x,i.y),r=e.next,a=i.prev;return e.next=i,i.prev=e,t.next=r,r.prev=t,n.next=t,t.prev=n,a.next=n,n.prev=a,n}function dn(e,i,t,n){var r=new Di(e,i,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function at(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Di(e,i,t){this.i=e,this.x=i,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Qt.deviation=function(e,i,t,n){var r=i&&i.length,a=r?i[0]*t:e.length,o=Math.abs(Li(e,0,a,t));if(r)for(var s=0,u=i.length;s<u;s++){var l=i[s]*t,f=s<u-1?i[s+1]*t:e.length;o-=Math.abs(Li(e,l,f,t))}var d=0;for(s=0;s<n.length;s+=3){var h=n[s]*t,c=n[s+1]*t,p=n[s+2]*t;d+=Math.abs((e[h]-e[p])*(e[c+1]-e[h+1])-(e[h]-e[c])*(e[p+1]-e[h+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function Li(e,i,t,n){for(var r=0,a=i,o=t-n;a<t;a+=n)r+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return r}Qt.flatten=function(e){for(var i=e[0][0].length,t={vertices:[],holes:[],dimensions:i},n=0,r=0;r<e.length;r++){for(var a=0;a<e[r].length;a++)for(var o=0;o<i;o++)t.vertices.push(e[r][a][o]);r>0&&(n+=e[r-1].length,t.holes.push(n))}return t};var Oo=Gi.exports;const Ro=Ka(Oo),Lt=Lr.CLOCKWISE,cn=Lr.COUNTER_CLOCKWISE,pe={isClosed:!0};function Mo(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}function Ke(e){return"positions"in e?e.positions:e}function Mt(e){return"holeIndices"in e?e.holeIndices:null}function No(e){return Array.isArray(e[0])}function Uo(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}function Zo(e){const i=e[0],t=e[e.length-1];return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]}function Go(e,i,t,n){for(let r=0;r<i;r++)if(e[t+r]!==e[n-i+r])return!1;return!0}function pn(e,i,t,n,r){let a=i;const o=t.length;for(let s=0;s<o;s++)for(let u=0;u<n;u++)e[a++]=t[s][u]||0;if(!Zo(t))for(let s=0;s<n;s++)e[a++]=t[0][s]||0;return pe.start=i,pe.end=a,pe.size=n,kr(e,r,pe),a}function gn(e,i,t,n,r=0,a,o){a=a||t.length;const s=a-r;if(s<=0)return i;let u=i;for(let l=0;l<s;l++)e[u++]=t[r+l];if(!Go(t,n,r,a))for(let l=0;l<n;l++)e[u++]=t[r+l];return pe.start=i,pe.end=u,pe.size=n,kr(e,o,pe),u}function Ho(e,i){Mo(e);const t=[],n=[];if("positions"in e){const{positions:r,holeIndices:a}=e;if(a){let o=0;for(let s=0;s<=a.length;s++)o=gn(t,o,r,i,a[s-1],a[s],s===0?Lt:cn),n.push(o);return n.pop(),{positions:t,holeIndices:n}}e=r}if(!No(e))return gn(t,0,e,i,0,t.length,Lt),t;if(!Uo(e)){let r=0;for(const[a,o]of e.entries())r=pn(t,r,o,i,a===0?Lt:cn),n.push(r);return n.pop(),{positions:t,holeIndices:n}}return pn(t,0,e,i,Lt),t}function Wo(e,i,t){let n=Mt(e);n&&(n=n.map(a=>a/i));let r=Ke(e);if(t){const a=r.length;r=r.slice();const o=[];for(let s=0;s<a;s+=i){o[0]=r[s],o[1]=r[s+1];const u=t(o);r[s]=u[0],r[s+1]=u[1]}}return Ro(r,n,i)}class jo extends lo{constructor(i){const{fp64:t,IndexType:n=Uint32Array}=i;super({...i,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(i){const{attributes:t}=this;return i==="indices"?t.indices&&t.indices.subarray(0,this.vertexCount):t[i]}updateGeometry(i){super.updateGeometry(i);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(i){if(this.normalize){const t=Ho(i,this.positionSize);return this.opts.resolution?fo(Ke(t),Mt(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?uo(Ke(t),Mt(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return i}getGeometrySize(i){if(vn(i)){let t=0;for(const n of i)t+=this.getGeometrySize(n);return t}return Ke(i).length/this.positionSize}getGeometryFromBuffer(i){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(i):null}updateGeometryAttributes(i,t){if(i&&vn(i))for(const n of i){const r=this.getGeometrySize(n);t.geometrySize=r,this.updateGeometryAttributes(n,t),t.vertexStart+=r,t.indexStart=this.indexStarts[t.geometryIndex+1]}else this._updateIndices(i,t),this._updatePositions(i,t),this._updateVertexValid(i,t)}_updateIndices(i,{geometryIndex:t,vertexStart:n,indexStart:r}){const{attributes:a,indexStarts:o,typedArrayManager:s}=this;let u=a.indices;if(!u||!i)return;let l=r;const f=Wo(i,this.positionSize,this.opts.preproject);u=s.allocate(u,r+f.length,{copy:!0});for(let d=0;d<f.length;d++)u[l++]=f[d]+n;o[t+1]=r+f.length,a.indices=u}_updatePositions(i,{vertexStart:t,geometrySize:n}){const{attributes:{positions:r},positionSize:a}=this;if(!r||!i)return;const o=Ke(i);for(let s=t,u=0;u<n;s++,u++){const l=o[u*a],f=o[u*a+1],d=a>2?o[u*a+2]:0;r[s*3]=l,r[s*3+1]=f,r[s*3+2]=d}}_updateVertexValid(i,{vertexStart:t,geometrySize:n}){const{positionSize:r}=this,a=this.attributes.vertexValid,o=i&&Mt(i);if(i&&i.edgeTypes?a.set(i.edgeTypes,t):a.fill(1,t,t+n),o)for(let s=0;s<o.length;s++)a[t+o[s]/r-1]=0;a[t+n-1]=0}}function vn(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}const Pr=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Ko=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(Pr,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),$o=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(Pr,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Yo=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,jt=[0,0,0,255],Vo={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:jt},getLineColor:{type:"accessor",value:jt},material:!0},kt={enter:(e,i)=>i.length?i.subarray(i.length-e.length):e};class Hi extends Ja{constructor(...i){super(...i),dt(this,"state",void 0)}getShaders(i){return super.getShaders({vs:i==="top"?Ko:$o,fs:Yo,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[qa,_o,eo]})}get wrapLongitude(){return!1}initializeState(){const{gl:i,viewport:t}=this.context;let{coordinateSystem:n}=this.props;t.isGeospatial&&n===li.DEFAULT&&(n=li.LNGLAT),this.setState({numInstances:0,polygonTesselator:new jo({preproject:n===li.LNGLAT&&t.projectFlat.bind(t),fp64:this.use64bitPositions(),IndexType:!i||to(i,io.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const r=this.getAttributeManager(),a=!0;r.remove(["instancePickingColors"]),r.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:a},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:kt,accessor:"getPolygon",update:this.calculatePositions,noAlloc:a,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:a},elevations:{size:1,transition:kt,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:kt,accessor:"getFillColor",defaultValue:jt,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:kt,accessor:"getLineColor",defaultValue:jt,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(o,{index:s,target:u})=>this.encodePickingColor(o&&o.__source?o.__source.index:s,u),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(i){const t=super.getPickingInfo(i),{index:n}=t,{data:r}=this.props;return r[0]&&r[0].__source&&(t.object=r.find(a=>a.__source.index===n)),t}disablePickingIndex(i){const{data:t}=this.props;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===i&&this._disablePickingIndex(n);else this._disablePickingIndex(i)}draw({uniforms:i}){const{extruded:t,filled:n,wireframe:r,elevationScale:a}=this.props,{topModel:o,sideModel:s,polygonTesselator:u}=this.state,l={...i,extruded:!!t,elevationScale:a};s&&(s.setInstanceCount(u.instanceCount-1),s.setUniforms(l),r&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(u.vertexCount),o.setUniforms(l).draw())}updateState(i){super.updateState(i),this.updateGeometry(i);const{props:t,oldProps:n,changeFlags:r}=i,a=this.getAttributeManager();if(r.extensionsChanged||t.filled!==n.filled||t.extruded!==n.extruded){var s;(s=this.state.models)===null||s===void 0||s.forEach(u=>u.delete()),this.setState(this._getModels(this.context.gl)),a.invalidateAll()}}updateGeometry({props:i,oldProps:t,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:a}=this.state;if(a.instanceCount)return;const o=i.data.attributes||{};a.updateGeometry({data:i.data,normalize:i._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:i.getPolygon,positionFormat:i.positionFormat,wrapLongitude:i.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(i){const{id:t,filled:n,extruded:r}=this.props;let a,o;if(n){const s=this.getShaders("top");s.defines.NON_INSTANCED_MODEL=1,a=new un(i,{...s,id:"".concat(t,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(o=new un(i,{...this.getShaders("side"),id:"".concat(t,"-side"),geometry:new no({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,a].filter(Boolean),topModel:a,sideModel:o}}calculateIndices(i){const{polygonTesselator:t}=this.state;i.startIndices=t.indexStarts,i.value=t.get("indices")}calculatePositions(i){const{polygonTesselator:t}=this.state;i.startIndices=t.vertexStarts,i.value=t.get("positions")}calculateVertexValid(i){i.value=this.state.polygonTesselator.get("vertexValid")}}dt(Hi,"defaultProps",Vo);dt(Hi,"layerName","SolidPolygonLayer");function Xo({data:e,getIndex:i,dataRange:t,replace:n}){const{startRow:r=0,endRow:a=1/0}=t,o=e.length;let s=o,u=o;for(let h=0;h<o;h++){const c=i(e[h]);if(s>h&&c>=r&&(s=h),c>=a){u=h;break}}let l=s;const d=u-s!==n.length?e.slice(u):void 0;for(let h=0;h<n.length;h++)e[l++]=n[h];if(d){for(let h=0;h<d.length;h++)e[l++]=d[h];e.length=l}return{startRow:s,endRow:s+n.length}}function Qo(e,i){if(!e)return null;const t="startIndices"in e?e.startIndices[i]:i,n=e.featureIds.value[t];return t!==-1?Jo(e,n,t):null}function Jo(e,i,t){const n={properties:{...e.properties[i]}};for(const r in e.numericProps)n.properties[r]=e.numericProps[r].value[t];return n}function qo(e,i){const t={points:null,lines:null,polygons:null};for(const n in t){const r=e[n].globalFeatureIds.value;t[n]=new Uint8ClampedArray(r.length*3);const a=[];for(let o=0;o<r.length;o++)i(r[o],a),t[n][o*3+0]=a[0],t[n][o*3+1]=a[1],t[n][o*3+2]=a[2]}return t}const Nt={circle:{type:Ar,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:ao,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:oo,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Ut={type:ho,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},ki={type:Hi,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function We({type:e,props:i}){const t={};for(const n in i)t[n]=e.defaultProps[i[n]];return t}function ui(e,i){const{transitions:t,updateTriggers:n}=e.props,r={updateTriggers:{},transitions:t&&{getPosition:t.geometry}};for(const a in i){const o=i[a];let s=e.props[a];a.startsWith("get")&&(s=e.getSubLayerAccessor(s),r.updateTriggers[o]=n[a],t&&(r.transitions[o]=t[a])),r[o]=s}return r}function es(e){if(Array.isArray(e))return e;switch(it.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return it.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}function _n(e,i,t={}){const n={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:a=e.length}=t;for(let o=r;o<a;o++){const s=e[o],{geometry:u}=s;if(u)if(u.type==="GeometryCollection"){it.assert(Array.isArray(u.geometries),"GeoJSON does not have geometries array");const{geometries:l}=u;for(let f=0;f<l.length;f++){const d=l[f];xn(d,n,i,s,o)}}else xn(u,n,i,s,o)}return n}function xn(e,i,t,n,r){const{type:a,coordinates:o}=e,{pointFeatures:s,lineFeatures:u,polygonFeatures:l,polygonOutlineFeatures:f}=i;if(!is(a,o)){it.warn("".concat(a," coordinates are malformed"))();return}switch(a){case"Point":s.push(t({geometry:e},n,r));break;case"MultiPoint":o.forEach(d=>{s.push(t({geometry:{type:"Point",coordinates:d}},n,r))});break;case"LineString":u.push(t({geometry:e},n,r));break;case"MultiLineString":o.forEach(d=>{u.push(t({geometry:{type:"LineString",coordinates:d}},n,r))});break;case"Polygon":l.push(t({geometry:e},n,r)),o.forEach(d=>{f.push(t({geometry:{type:"LineString",coordinates:d}},n,r))});break;case"MultiPolygon":o.forEach(d=>{l.push(t({geometry:{type:"Polygon",coordinates:d}},n,r)),d.forEach(h=>{f.push(t({geometry:{type:"LineString",coordinates:h}},n,r))})});break}}const ts={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function is(e,i){let t=ts[e];for(it.assert(t,"Unknown GeoJSON type ".concat(e));i&&--t>0;)i=i[0];return i&&Number.isFinite(i[0])}function Fr(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function It(e){return e.geometry.coordinates}function ns(e,i){const t=Fr(),{pointFeatures:n,lineFeatures:r,polygonFeatures:a,polygonOutlineFeatures:o}=e;return t.points.data=n,t.points._dataDiff=i.pointFeatures&&(()=>i.pointFeatures),t.points.getPosition=It,t.lines.data=r,t.lines._dataDiff=i.lineFeatures&&(()=>i.lineFeatures),t.lines.getPath=It,t.polygons.data=a,t.polygons._dataDiff=i.polygonFeatures&&(()=>i.polygonFeatures),t.polygons.getPolygon=It,t.polygonsOutline.data=o,t.polygonsOutline._dataDiff=i.polygonOutlineFeatures&&(()=>i.polygonOutlineFeatures),t.polygonsOutline.getPath=It,t}function rs(e,i){const t=Fr(),{points:n,lines:r,polygons:a}=e,o=qo(e,i);return t.points.data={length:n.positions.value.length/n.positions.size,attributes:{...n.attributes,getPosition:n.positions,instancePickingColors:{size:3,value:o.points}},properties:n.properties,numericProps:n.numericProps,featureIds:n.featureIds},t.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:o.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},t.lines._pathType="open",t.polygons.data={length:a.polygonIndices.value.length-1,startIndices:a.polygonIndices.value,attributes:{...a.attributes,getPolygon:a.positions,pickingColors:{size:3,value:o.polygons}},properties:a.properties,numericProps:a.numericProps,featureIds:a.featureIds},t.polygons._normalize=!1,a.triangles&&(t.polygons.data.attributes.indices=a.triangles.value),t.polygonsOutline.data={length:a.primitivePolygonIndices.value.length-1,startIndices:a.primitivePolygonIndices.value,attributes:{...a.attributes,getPath:a.positions,instancePickingColors:{size:3,value:o.polygons}},properties:a.properties,numericProps:a.numericProps,featureIds:a.featureIds},t.polygonsOutline._pathType="open",t}const as=["points","linestrings","polygons"],os={...We(Nt.circle),...We(Nt.icon),...We(Nt.text),...We(Ut),...We(ki),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Wi extends so{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:i,changeFlags:t}){if(!t.dataChanged)return;const{data:n}=this.props,r=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:r}),r?this._updateStateBinary({props:i,changeFlags:t}):this._updateStateJSON({props:i,changeFlags:t})}_updateStateBinary({props:i,changeFlags:t}){const n=rs(i.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:i,changeFlags:t}){const n=es(i.data),r=this.getSubLayerRow.bind(this);let a={};const o={};if(Array.isArray(t.dataChanged)){const u=this.state.features;for(const l in u)a[l]=u[l].slice(),o[l]=[];for(const l of t.dataChanged){const f=_n(n,r,l);for(const d in u)o[d].push(Xo({data:a[d],getIndex:h=>h.__source.index,dataRange:l,replace:f[d]}))}}else a=_n(n,r);const s=ns(a,o);this.setState({features:a,featuresDiff:o,layerProps:s})}getPickingInfo(i){const t=super.getPickingInfo(i),{index:n,sourceLayer:r}=t;return t.featureType=as.find(a=>r.id.startsWith("".concat(this.id,"-").concat(a,"-"))),n>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[n]),t}_updateAutoHighlight(i){const t="".concat(this.id,"-points-"),n=i.featureType==="points";for(const r of this.getSubLayers())r.id.startsWith(t)===n&&r.updateAutoHighlight(i)}_renderPolygonLayer(){const{extruded:i,wireframe:t}=this.props,{layerProps:n}=this.state,r="polygons-fill",a=this.shouldRenderSubLayer(r,n.polygons.data)&&this.getSubLayerClass(r,ki.type);if(a){const o=ui(this,ki.props),s=i&&t;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new a(o,this.getSubLayerProps({id:r,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:i,stroked:t}=this.props,{layerProps:n}=this.state,r="polygons-stroke",a="linestrings",o=!i&&t&&this.shouldRenderSubLayer(r,n.polygonsOutline.data)&&this.getSubLayerClass(r,Ut.type),s=this.shouldRenderSubLayer(a,n.lines.data)&&this.getSubLayerClass(a,Ut.type);if(o||s){const u=ui(this,Ut.props);return[o&&new o(u,this.getSubLayerProps({id:r,updateTriggers:u.updateTriggers}),n.polygonsOutline),s&&new s(u,this.getSubLayerProps({id:a,updateTriggers:u.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:i}=this.props,{layerProps:t,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=t.points.data.findIndex(s=>s.__source.index===r));const a=new Set(i.split("+")),o=[];for(const s of a){const u="points-".concat(s),l=Nt[s],f=l&&this.shouldRenderSubLayer(u,t.points.data)&&this.getSubLayerClass(u,l.type);if(f){const d=ui(this,l.props);let h=t.points;if(s==="text"&&n){const{instancePickingColors:c,...p}=h.data.attributes;h={...h,data:{...h.data,attributes:p}}}o.push(new f(d,this.getSubLayerProps({id:u,updateTriggers:d.updateTriggers,highlightedObjectIndex:r}),h))}}return o}renderLayers(){const{extruded:i}=this.props,t=this._renderPolygonLayer(),n=this._renderLineLayers(),r=this._renderPointLayers();return[!i&&t,n,r,i&&t]}getSubLayerAccessor(i){const{binary:t}=this.state;return!t||typeof i!="function"?super.getSubLayerAccessor(i):(n,r)=>{const{data:a,index:o}=r,s=Qo(a,o);return i(s,r)}}}dt(Wi,"layerName","GeoJsonLayer");dt(Wi,"defaultProps",os);var qt={},ji={};ji.geometries={NULL:0,POINT:1,POLYLINE:3,POLYGON:5,MULTIPOINT:8,POINTZ:11,POLYLINEZ:13,POLYGONZ:15,MULTIPOINTZ:18,POINTM:21,POLYLINEM:23,POLYGONM:25,MULTIPOINTM:28,MULTIPATCH:31};var zr={},ss={C:254,L:1,D:8,N:18,M:18,F:18,B:8},ei={};ei.lpad=function(i,t,n){for(;i.length<t;)i=n+i;return i};ei.rpad=function(i,t,n){for(;i.length<t;)i=i+n;return i};ei.writeField=function(i,t,n,r){for(var a=0;a<t;a++)i.setUint8(r,n.charCodeAt(a)),r++;return r};var ti={},ls=ss,fs={string:"C",number:"N",boolean:"L",null:"C"};ti.multi=us;ti.bytesPer=ds;ti.obj=Or;function us(e){var i={};e.forEach(t);function t(n){hs(i,n)}return Or(i)}function hs(e,i){for(var t in i){var n=typeof i[t]<"u"&&i[t]!==null;(typeof e[t]>"u"||n)&&(e[t]=i[t])}return e}function Or(e){var i={},t=[];for(var n in e)i[n]=e[n]===null?"null":typeof e[n];for(var r in i){var a=fs[i[r]];a&&t.push({name:r,type:a,size:ls[a]})}return t}function ds(e){return e.reduce(function(i,t){return i+t.size},1)}var Be=ei,yn=ti,cs=function(i,t){var n=t||yn.multi(i),r=32*n.length+1,a=yn.bytesPer(n),o=new ArrayBuffer(r+32+a*i.length+1),s=new Date,u=new DataView(o);u.setUint8(0,3),u.setUint8(1,s.getFullYear()-1900),u.setUint8(2,s.getMonth()),u.setUint8(3,s.getDate()),u.setUint32(4,i.length,!0);var l=r+32;u.setUint16(8,l,!0),u.setUint16(10,a,!0),u.setInt8(32+r-1,13),n.forEach(function(d,h){d.name.split("").slice(0,8).forEach(function(c,p){u.setInt8(32+h*32+p,c.charCodeAt(0))}),u.setInt8(32+h*32+11,d.type.charCodeAt(0)),u.setInt8(32+h*32+16,d.size),d.type=="N"&&u.setInt8(32+h*32+17,3)});var f=r+32;return i.forEach(function(d,h){u.setUint8(f,32),f++,n.forEach(function(c){var p=d[c.name];switch((p===null||typeof p>"u")&&(p=""),c.type){case"L":u.setUint8(f,p?84:70),f++;break;case"D":f=Be.writeField(u,8,Be.lpad(p.toString(),8," "),f);break;case"N":f=Be.writeField(u,c.size,Be.lpad(p.toString(),c.size," ").substr(0,18),f);break;case"C":f=Be.writeField(u,c.size,Be.rpad(p.toString(),c.size," "),f);break;default:throw new Error("Unknown field type")}})}),u.setUint8(f,26),u};zr.structure=cs;var Rr='GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]]',ct={};ct.enlarge=function(i,t){return t[0]<i.xmin&&(i.xmin=t[0]),t[0]>i.xmax&&(i.xmax=t[0]),t[1]<i.ymin&&(i.ymin=t[1]),t[1]>i.ymax&&(i.ymax=t[1]),i};ct.enlargeExtent=function(i,t){return t.xmax>i.xmax&&(i.xmax=t.xmax),t.xmin<i.xmin&&(i.xmin=t.xmin),t.ymax>i.ymax&&(i.ymax=t.ymax),t.ymin<i.ymin&&(i.ymin=t.ymin),i};ct.blank=function(){return{xmin:Number.MAX_VALUE,ymin:Number.MAX_VALUE,xmax:-Number.MAX_VALUE,ymax:-Number.MAX_VALUE}};var Me={},wn=ct;Me.write=function(i,t,n,r){var a=28,o=100,s=0,u=0;i.forEach(function(f,d){n.setInt32(s,d),n.setInt32(s+4,10),n.setInt32(s+8,1,!0),n.setFloat64(s+12,f[0],!0),n.setFloat64(s+20,f[1],!0),r.setInt32(u,o/2),r.setInt32(u+4,10),u+=8,s+=a,o+=a})};Me.extent=function(e){return e.reduce(function(i,t){return wn.enlarge(i,t)},wn.blank())};Me.parts=function(i,t){return i.length};Me.shxLength=function(e){return e.length*8};Me.shpLength=function(e){return e.length*28};var Ne={},Kt=ct,mn=ji;Ne.write=function(i,t,n,r,a){var o=0,s=0,u=100;i.forEach(l);function l(f,d){var h=ii(f),c=Mr([f],a),p=h.length*16+48+(c-1)*4,_=h.reduce(function(m,v){return Kt.enlarge(m,v)},Kt.blank());r.setInt32(s,u/2),r.setInt32(s+4,p/2),s+=8,u+=p+8,n.setInt32(o,d+1),n.setInt32(o+4,p/2),n.setInt32(o+8,a,!0),n.setFloat64(o+12,_.xmin,!0),n.setFloat64(o+20,_.ymin,!0),n.setFloat64(o+28,_.xmax,!0),n.setFloat64(o+36,_.ymax,!0),n.setInt32(o+44,c,!0),n.setInt32(o+48,h.length,!0),n.setInt32(o+52,0,!0);for(var w=f.reduce(function(m,v){return Array.isArray(v[0][0])?m=m.concat(v):m.push(v),m},[]),x=1;x<c;x++)n.setInt32(o+52+x*4,w.reduce(function(m,v,g){return g<x?m+v.length:m},0),!0);h.forEach(function(v,g){n.setFloat64(o+56+g*16+(c-1)*4,v[0],!0),n.setFloat64(o+56+g*16+(c-1)*4+8,v[1],!0)}),o+=p+8}};Ne.shpLength=function(e){return e.length*56+ii(e).length*16};Ne.shxLength=function(e){return e.length*8};Ne.extent=function(e){return ii(e).reduce(function(i,t){return Kt.enlarge(i,t)},Kt.blank())};function Mr(e,i){var t=1;return(i===mn.geometries.POLYGON||i===mn.geometries.POLYLINE)&&(t=e.reduce(function(n,r){return n+=r.length,Array.isArray(r[0][0][0])&&(n+=r.reduce(function(a,o){return a+o.length-1},0)),n},0)),t}Ne.parts=Mr;function ii(e,i){return i===void 0&&(i=[]),typeof e[0][0]=="object"?e.reduce(function(t,n){return t.concat(ii(n))},i):e}var ps=ji,gs=zr,vs=Rr,_s=Me,bn=Ne,xs={1:_s,5:bn,3:bn},Nr=ys;function ys(e,i,t,n){var r=ps.geometries[i],a=xs[r],o=a.parts(t,r),s=100+(o-t.length)*4+a.shpLength(t),u=100+a.shxLength(t),l=new ArrayBuffer(s),f=new DataView(l),d=new ArrayBuffer(u),h=new DataView(d),c=a.extent(t);An(f,r),An(h,r),Cn(c,f),Cn(c,h),a.write(t,c,new DataView(l,100),new DataView(d,100),r),f.setInt32(24,s/2),h.setInt32(24,50+t.length*4);var p=gs.structure(e);n(null,{shp:f,shx:h,dbf:p,prj:vs})}function An(e,i){e.setInt32(0,9994),e.setInt32(28,1e3,!0),e.setInt32(32,i,!0)}function Cn(e,i){i.setFloat64(36,e.xmin,!0),i.setFloat64(44,e.ymin,!0),i.setFloat64(52,e.xmax,!0),i.setFloat64(60,e.ymax,!0)}var ni={};ni.point=Ki("Point","POINT");ni.line=Ki("LineString","POLYLINE");ni.polygon=Ki("Polygon","POLYGON");function Ki(e,i){return function(t){var n=t.features.filter(ms(e));return{geometries:i==="POLYGON"||i==="POLYLINE"?[n.map(En)]:n.map(En),properties:n.map(ws),type:i}}}function En(e){return e.geometry.coordinates[0]!==void 0&&e.geometry.coordinates[0][0]!==void 0&&e.geometry.coordinates[0][0][0]!==void 0?e.geometry.coordinates[0]:e.geometry.coordinates}function ws(e){return e.properties}function ms(e){return function(i){return i.geometry.type===e}}var pt={},ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";pt.encode=function(e,i){for(var t="",n,r,a,o,s,u,l,f=0;f<e.length;)n=e.charCodeAt(f++),r=e.charCodeAt(f++),a=e.charCodeAt(f++),o=n>>2,s=(n&3)<<4|r>>4,u=(r&15)<<2|a>>6,l=a&63,isNaN(r)?u=l=64:isNaN(a)&&(l=64),t=t+ge.charAt(o)+ge.charAt(s)+ge.charAt(u)+ge.charAt(l);return t};pt.decode=function(e,i){var t="",n,r,a,o,s,u,l,f=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");f<e.length;)o=ge.indexOf(e.charAt(f++)),s=ge.indexOf(e.charAt(f++)),u=ge.indexOf(e.charAt(f++)),l=ge.indexOf(e.charAt(f++)),n=o<<2|s>>4,r=(s&15)<<4|u>>2,a=(u&3)<<6|l,t=t+String.fromCharCode(n),u!=64&&(t=t+String.fromCharCode(r)),l!=64&&(t=t+String.fromCharCode(a));return t};var M={},Bt;M.base64=!0;M.array=!0;M.string=!0;M.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u";M.nodebuffer=typeof Buffer<"u";M.uint8array=typeof Uint8Array<"u";if(typeof ArrayBuffer>"u")Bt=M.blob=!1;else{var Sn=new ArrayBuffer(0);try{Bt=M.blob=new Blob([Sn],{type:"application/zip"}).size===0}catch{try{var bs=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,Dn=new bs;Dn.append(Sn),Bt=M.blob=Dn.getBlob("application/zip").size===0}catch{Bt=M.blob=!1}}}var X={},gt={},Ue={},oe={};(function(e){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";e.assign=function(r){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var o=a.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var s in o)o.hasOwnProperty(s)&&(r[s]=o[s])}}return r},e.shrinkBuf=function(r,a){return r.length===a?r:r.subarray?r.subarray(0,a):(r.length=a,r)};var t={arraySet:function(r,a,o,s,u){if(a.subarray&&r.subarray){r.set(a.subarray(o,o+s),u);return}for(var l=0;l<s;l++)r[u+l]=a[o+l]},flattenChunks:function(r){var a,o,s,u,l,f;for(s=0,a=0,o=r.length;a<o;a++)s+=r[a].length;for(f=new Uint8Array(s),u=0,a=0,o=r.length;a<o;a++)l=r[a],f.set(l,u),u+=l.length;return f}},n={arraySet:function(r,a,o,s,u){for(var l=0;l<s;l++)r[u+l]=a[o+l]},flattenChunks:function(r){return[].concat.apply([],r)}};e.setTyped=function(r){r?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,t)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,n))},e.setTyped(i)})(oe);var vt={},ne={},Ze={},As=oe,Cs=4,Ln=0,kn=1,Es=2;function Ge(e){for(var i=e.length;--i>=0;)e[i]=0}var Ss=0,Ur=1,Ds=2,Ls=3,ks=258,$i=29,_t=256,ot=_t+1+$i,Oe=30,Yi=19,Zr=2*ot+1,me=15,hi=16,Is=7,Vi=256,Gr=16,Hr=17,Wr=18,Ii=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Zt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Bs=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],jr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ts=512,ae=new Array((ot+2)*2);Ge(ae);var Ye=new Array(Oe*2);Ge(Ye);var st=new Array(Ts);Ge(st);var lt=new Array(ks-Ls+1);Ge(lt);var Xi=new Array($i);Ge(Xi);var $t=new Array(Oe);Ge($t);function di(e,i,t,n,r){this.static_tree=e,this.extra_bits=i,this.extra_base=t,this.elems=n,this.max_length=r,this.has_stree=e&&e.length}var Kr,$r,Yr;function ci(e,i){this.dyn_tree=e,this.max_code=0,this.stat_desc=i}function Vr(e){return e<256?st[e]:st[256+(e>>>7)]}function ft(e,i){e.pending_buf[e.pending++]=i&255,e.pending_buf[e.pending++]=i>>>8&255}function N(e,i,t){e.bi_valid>hi-t?(e.bi_buf|=i<<e.bi_valid&65535,ft(e,e.bi_buf),e.bi_buf=i>>hi-e.bi_valid,e.bi_valid+=t-hi):(e.bi_buf|=i<<e.bi_valid&65535,e.bi_valid+=t)}function te(e,i,t){N(e,t[i*2],t[i*2+1])}function Xr(e,i){var t=0;do t|=e&1,e>>>=1,t<<=1;while(--i>0);return t>>>1}function Ps(e){e.bi_valid===16?(ft(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function Fs(e,i){var t=i.dyn_tree,n=i.max_code,r=i.stat_desc.static_tree,a=i.stat_desc.has_stree,o=i.stat_desc.extra_bits,s=i.stat_desc.extra_base,u=i.stat_desc.max_length,l,f,d,h,c,p,_=0;for(h=0;h<=me;h++)e.bl_count[h]=0;for(t[e.heap[e.heap_max]*2+1]=0,l=e.heap_max+1;l<Zr;l++)f=e.heap[l],h=t[t[f*2+1]*2+1]+1,h>u&&(h=u,_++),t[f*2+1]=h,!(f>n)&&(e.bl_count[h]++,c=0,f>=s&&(c=o[f-s]),p=t[f*2],e.opt_len+=p*(h+c),a&&(e.static_len+=p*(r[f*2+1]+c)));if(_!==0){do{for(h=u-1;e.bl_count[h]===0;)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[u]--,_-=2}while(_>0);for(h=u;h!==0;h--)for(f=e.bl_count[h];f!==0;)d=e.heap[--l],!(d>n)&&(t[d*2+1]!==h&&(e.opt_len+=(h-t[d*2+1])*t[d*2],t[d*2+1]=h),f--)}}function Qr(e,i,t){var n=new Array(me+1),r=0,a,o;for(a=1;a<=me;a++)n[a]=r=r+t[a-1]<<1;for(o=0;o<=i;o++){var s=e[o*2+1];s!==0&&(e[o*2]=Xr(n[s]++,s))}}function zs(){var e,i,t,n,r,a=new Array(me+1);for(t=0,n=0;n<$i-1;n++)for(Xi[n]=t,e=0;e<1<<Ii[n];e++)lt[t++]=n;for(lt[t-1]=n,r=0,n=0;n<16;n++)for($t[n]=r,e=0;e<1<<Zt[n];e++)st[r++]=n;for(r>>=7;n<Oe;n++)for($t[n]=r<<7,e=0;e<1<<Zt[n]-7;e++)st[256+r++]=n;for(i=0;i<=me;i++)a[i]=0;for(e=0;e<=143;)ae[e*2+1]=8,e++,a[8]++;for(;e<=255;)ae[e*2+1]=9,e++,a[9]++;for(;e<=279;)ae[e*2+1]=7,e++,a[7]++;for(;e<=287;)ae[e*2+1]=8,e++,a[8]++;for(Qr(ae,ot+1,a),e=0;e<Oe;e++)Ye[e*2+1]=5,Ye[e*2]=Xr(e,5);Kr=new di(ae,Ii,_t+1,ot,me),$r=new di(Ye,Zt,0,Oe,me),Yr=new di(new Array(0),Bs,0,Yi,Is)}function Jr(e){var i;for(i=0;i<ot;i++)e.dyn_ltree[i*2]=0;for(i=0;i<Oe;i++)e.dyn_dtree[i*2]=0;for(i=0;i<Yi;i++)e.bl_tree[i*2]=0;e.dyn_ltree[Vi*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function qr(e){e.bi_valid>8?ft(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Os(e,i,t,n){qr(e),n&&(ft(e,t),ft(e,~t)),As.arraySet(e.pending_buf,e.window,i,t,e.pending),e.pending+=t}function In(e,i,t,n){var r=i*2,a=t*2;return e[r]<e[a]||e[r]===e[a]&&n[i]<=n[t]}function pi(e,i,t){for(var n=e.heap[t],r=t<<1;r<=e.heap_len&&(r<e.heap_len&&In(i,e.heap[r+1],e.heap[r],e.depth)&&r++,!In(i,n,e.heap[r],e.depth));)e.heap[t]=e.heap[r],t=r,r<<=1;e.heap[t]=n}function Bn(e,i,t){var n,r,a=0,o,s;if(e.last_lit!==0)do n=e.pending_buf[e.d_buf+a*2]<<8|e.pending_buf[e.d_buf+a*2+1],r=e.pending_buf[e.l_buf+a],a++,n===0?te(e,r,i):(o=lt[r],te(e,o+_t+1,i),s=Ii[o],s!==0&&(r-=Xi[o],N(e,r,s)),n--,o=Vr(n),te(e,o,t),s=Zt[o],s!==0&&(n-=$t[o],N(e,n,s)));while(a<e.last_lit);te(e,Vi,i)}function Bi(e,i){var t=i.dyn_tree,n=i.stat_desc.static_tree,r=i.stat_desc.has_stree,a=i.stat_desc.elems,o,s,u=-1,l;for(e.heap_len=0,e.heap_max=Zr,o=0;o<a;o++)t[o*2]!==0?(e.heap[++e.heap_len]=u=o,e.depth[o]=0):t[o*2+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=u<2?++u:0,t[l*2]=1,e.depth[l]=0,e.opt_len--,r&&(e.static_len-=n[l*2+1]);for(i.max_code=u,o=e.heap_len>>1;o>=1;o--)pi(e,t,o);l=a;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pi(e,t,1),s=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=s,t[l*2]=t[o*2]+t[s*2],e.depth[l]=(e.depth[o]>=e.depth[s]?e.depth[o]:e.depth[s])+1,t[o*2+1]=t[s*2+1]=l,e.heap[1]=l++,pi(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Fs(e,i),Qr(t,u,e.bl_count)}function Tn(e,i,t){var n,r=-1,a,o=i[0*2+1],s=0,u=7,l=4;for(o===0&&(u=138,l=3),i[(t+1)*2+1]=65535,n=0;n<=t;n++)a=o,o=i[(n+1)*2+1],!(++s<u&&a===o)&&(s<l?e.bl_tree[a*2]+=s:a!==0?(a!==r&&e.bl_tree[a*2]++,e.bl_tree[Gr*2]++):s<=10?e.bl_tree[Hr*2]++:e.bl_tree[Wr*2]++,s=0,r=a,o===0?(u=138,l=3):a===o?(u=6,l=3):(u=7,l=4))}function Pn(e,i,t){var n,r=-1,a,o=i[0*2+1],s=0,u=7,l=4;for(o===0&&(u=138,l=3),n=0;n<=t;n++)if(a=o,o=i[(n+1)*2+1],!(++s<u&&a===o)){if(s<l)do te(e,a,e.bl_tree);while(--s!==0);else a!==0?(a!==r&&(te(e,a,e.bl_tree),s--),te(e,Gr,e.bl_tree),N(e,s-3,2)):s<=10?(te(e,Hr,e.bl_tree),N(e,s-3,3)):(te(e,Wr,e.bl_tree),N(e,s-11,7));s=0,r=a,o===0?(u=138,l=3):a===o?(u=6,l=3):(u=7,l=4)}}function Rs(e){var i;for(Tn(e,e.dyn_ltree,e.l_desc.max_code),Tn(e,e.dyn_dtree,e.d_desc.max_code),Bi(e,e.bl_desc),i=Yi-1;i>=3&&e.bl_tree[jr[i]*2+1]===0;i--);return e.opt_len+=3*(i+1)+5+5+4,i}function Ms(e,i,t,n){var r;for(N(e,i-257,5),N(e,t-1,5),N(e,n-4,4),r=0;r<n;r++)N(e,e.bl_tree[jr[r]*2+1],3);Pn(e,e.dyn_ltree,i-1),Pn(e,e.dyn_dtree,t-1)}function Ns(e){var i=4093624447,t;for(t=0;t<=31;t++,i>>>=1)if(i&1&&e.dyn_ltree[t*2]!==0)return Ln;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return kn;for(t=32;t<_t;t++)if(e.dyn_ltree[t*2]!==0)return kn;return Ln}var Fn=!1;function Us(e){Fn||(zs(),Fn=!0),e.l_desc=new ci(e.dyn_ltree,Kr),e.d_desc=new ci(e.dyn_dtree,$r),e.bl_desc=new ci(e.bl_tree,Yr),e.bi_buf=0,e.bi_valid=0,Jr(e)}function ea(e,i,t,n){N(e,(Ss<<1)+(n?1:0),3),Os(e,i,t,!0)}function Zs(e){N(e,Ur<<1,3),te(e,Vi,ae),Ps(e)}function Gs(e,i,t,n){var r,a,o=0;e.level>0?(e.strm.data_type===Es&&(e.strm.data_type=Ns(e)),Bi(e,e.l_desc),Bi(e,e.d_desc),o=Rs(e),r=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=r&&(r=a)):r=a=t+5,t+4<=r&&i!==-1?ea(e,i,t,n):e.strategy===Cs||a===r?(N(e,(Ur<<1)+(n?1:0),3),Bn(e,ae,Ye)):(N(e,(Ds<<1)+(n?1:0),3),Ms(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Bn(e,e.dyn_ltree,e.dyn_dtree)),Jr(e),n&&qr(e)}function Hs(e,i,t){return e.pending_buf[e.d_buf+e.last_lit*2]=i>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=i&255,e.pending_buf[e.l_buf+e.last_lit]=t&255,e.last_lit++,i===0?e.dyn_ltree[t*2]++:(e.matches++,i--,e.dyn_ltree[(lt[t]+_t+1)*2]++,e.dyn_dtree[Vr(i)*2]++),e.last_lit===e.lit_bufsize-1}Ze._tr_init=Us;Ze._tr_stored_block=ea;Ze._tr_flush_block=Gs;Ze._tr_tally=Hs;Ze._tr_align=Zs;function Ws(e,i,t,n){for(var r=e&65535|0,a=e>>>16&65535|0,o=0;t!==0;){o=t>2e3?2e3:t,t-=o;do r=r+i[n++]|0,a=a+r|0;while(--o);r%=65521,a%=65521}return r|a<<16|0}var ta=Ws;function js(){for(var e,i=[],t=0;t<256;t++){e=t;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;i[t]=e}return i}var Ks=js();function $s(e,i,t,n){var r=Ks,a=n+t;e^=-1;for(var o=n;o<a;o++)e=e>>>8^r[(e^i[o])&255];return e^-1}var ia=$s,Qi={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},R=oe,H=Ze,na=ta,he=ia,Ys=Qi,ke=0,Vs=1,Xs=3,xe=4,zn=5,ie=0,On=1,W=-2,Qs=-3,gi=-5,Js=-1,qs=1,Tt=2,el=3,tl=4,il=0,nl=2,ri=8,rl=9,al=15,ol=8,sl=29,ll=256,Ti=ll+1+sl,fl=30,ul=19,hl=2*Ti+1,dl=15,C=3,ve=258,Y=ve+C+1,cl=32,ai=42,Pi=69,Gt=73,Ht=91,Wt=103,be=113,$e=666,z=1,xt=2,Ce=3,He=4,pl=3;function _e(e,i){return e.msg=Ys[i],i}function Rn(e){return(e<<1)-(e>4?9:0)}function ce(e){for(var i=e.length;--i>=0;)e[i]=0}function de(e){var i=e.state,t=i.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(R.arraySet(e.output,i.pending_buf,i.pending_out,t,e.next_out),e.next_out+=t,i.pending_out+=t,e.total_out+=t,e.avail_out-=t,i.pending-=t,i.pending===0&&(i.pending_out=0))}function O(e,i){H._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,i),e.block_start=e.strstart,de(e.strm)}function L(e,i){e.pending_buf[e.pending++]=i}function je(e,i){e.pending_buf[e.pending++]=i>>>8&255,e.pending_buf[e.pending++]=i&255}function gl(e,i,t,n){var r=e.avail_in;return r>n&&(r=n),r===0?0:(e.avail_in-=r,R.arraySet(i,e.input,e.next_in,r,t),e.state.wrap===1?e.adler=na(e.adler,i,r,t):e.state.wrap===2&&(e.adler=he(e.adler,i,r,t)),e.next_in+=r,e.total_in+=r,r)}function ra(e,i){var t=e.max_chain_length,n=e.strstart,r,a,o=e.prev_length,s=e.nice_match,u=e.strstart>e.w_size-Y?e.strstart-(e.w_size-Y):0,l=e.window,f=e.w_mask,d=e.prev,h=e.strstart+ve,c=l[n+o-1],p=l[n+o];e.prev_length>=e.good_match&&(t>>=2),s>e.lookahead&&(s=e.lookahead);do if(r=i,!(l[r+o]!==p||l[r+o-1]!==c||l[r]!==l[n]||l[++r]!==l[n+1])){n+=2,r++;do;while(l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&l[++n]===l[++r]&&n<h);if(a=ve-(h-n),n=h-ve,a>o){if(e.match_start=i,o=a,a>=s)break;c=l[n+o-1],p=l[n+o]}}while((i=d[i&f])>u&&--t!==0);return o<=e.lookahead?o:e.lookahead}function Ee(e){var i=e.w_size,t,n,r,a,o;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=i+(i-Y)){R.arraySet(e.window,e.window,i,i,0),e.match_start-=i,e.strstart-=i,e.block_start-=i,n=e.hash_size,t=n;do r=e.head[--t],e.head[t]=r>=i?r-i:0;while(--n);n=i,t=n;do r=e.prev[--t],e.prev[t]=r>=i?r-i:0;while(--n);a+=i}if(e.strm.avail_in===0)break;if(n=gl(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=n,e.lookahead+e.insert>=C)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+C-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<C)););}while(e.lookahead<Y&&e.strm.avail_in!==0)}function vl(e,i){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Ee(e),e.lookahead===0&&i===ke)return z;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+t;if((e.strstart===0||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,O(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-Y&&(O(e,!1),e.strm.avail_out===0))return z}return e.insert=0,i===xe?(O(e,!0),e.strm.avail_out===0?Ce:He):(e.strstart>e.block_start&&(O(e,!1),e.strm.avail_out===0),z)}function vi(e,i){for(var t,n;;){if(e.lookahead<Y){if(Ee(e),e.lookahead<Y&&i===ke)return z;if(e.lookahead===0)break}if(t=0,e.lookahead>=C&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-Y&&(e.match_length=ra(e,t)),e.match_length>=C)if(n=H._tr_tally(e,e.strstart-e.match_start,e.match_length-C),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=C){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=H._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(O(e,!1),e.strm.avail_out===0))return z}return e.insert=e.strstart<C-1?e.strstart:C-1,i===xe?(O(e,!0),e.strm.avail_out===0?Ce:He):e.last_lit&&(O(e,!1),e.strm.avail_out===0)?z:xt}function Te(e,i){for(var t,n,r;;){if(e.lookahead<Y){if(Ee(e),e.lookahead<Y&&i===ke)return z;if(e.lookahead===0)break}if(t=0,e.lookahead>=C&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=C-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-Y&&(e.match_length=ra(e,t),e.match_length<=5&&(e.strategy===qs||e.match_length===C&&e.strstart-e.match_start>4096)&&(e.match_length=C-1)),e.prev_length>=C&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-C,n=H._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-C),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=C-1,e.strstart++,n&&(O(e,!1),e.strm.avail_out===0))return z}else if(e.match_available){if(n=H._tr_tally(e,0,e.window[e.strstart-1]),n&&O(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return z}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=H._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<C-1?e.strstart:C-1,i===xe?(O(e,!0),e.strm.avail_out===0?Ce:He):e.last_lit&&(O(e,!1),e.strm.avail_out===0)?z:xt}function _l(e,i){for(var t,n,r,a,o=e.window;;){if(e.lookahead<=ve){if(Ee(e),e.lookahead<=ve&&i===ke)return z;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=C&&e.strstart>0&&(r=e.strstart-1,n=o[r],n===o[++r]&&n===o[++r]&&n===o[++r])){a=e.strstart+ve;do;while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<a);e.match_length=ve-(a-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=C?(t=H._tr_tally(e,1,e.match_length-C),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=H._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(O(e,!1),e.strm.avail_out===0))return z}return e.insert=0,i===xe?(O(e,!0),e.strm.avail_out===0?Ce:He):e.last_lit&&(O(e,!1),e.strm.avail_out===0)?z:xt}function xl(e,i){for(var t;;){if(e.lookahead===0&&(Ee(e),e.lookahead===0)){if(i===ke)return z;break}if(e.match_length=0,t=H._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(O(e,!1),e.strm.avail_out===0))return z}return e.insert=0,i===xe?(O(e,!0),e.strm.avail_out===0?Ce:He):e.last_lit&&(O(e,!1),e.strm.avail_out===0)?z:xt}function J(e,i,t,n,r){this.good_length=e,this.max_lazy=i,this.nice_length=t,this.max_chain=n,this.func=r}var ze;ze=[new J(0,0,0,0,vl),new J(4,4,8,4,vi),new J(4,5,16,8,vi),new J(4,6,32,32,vi),new J(4,4,16,16,Te),new J(8,16,32,32,Te),new J(8,16,128,128,Te),new J(8,32,128,256,Te),new J(32,128,258,1024,Te),new J(32,258,258,4096,Te)];function yl(e){e.window_size=2*e.w_size,ce(e.head),e.max_lazy_match=ze[e.level].max_lazy,e.good_match=ze[e.level].good_length,e.nice_match=ze[e.level].nice_length,e.max_chain_length=ze[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=C-1,e.match_available=0,e.ins_h=0}function wl(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ri,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new R.Buf16(hl*2),this.dyn_dtree=new R.Buf16((2*fl+1)*2),this.bl_tree=new R.Buf16((2*ul+1)*2),ce(this.dyn_ltree),ce(this.dyn_dtree),ce(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new R.Buf16(dl+1),this.heap=new R.Buf16(2*Ti+1),ce(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new R.Buf16(2*Ti+1),ce(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function aa(e){var i;return!e||!e.state?_e(e,W):(e.total_in=e.total_out=0,e.data_type=nl,i=e.state,i.pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap?ai:be,e.adler=i.wrap===2?0:1,i.last_flush=ke,H._tr_init(i),ie)}function oa(e){var i=aa(e);return i===ie&&yl(e.state),i}function ml(e,i){return!e||!e.state||e.state.wrap!==2?W:(e.state.gzhead=i,ie)}function sa(e,i,t,n,r,a){if(!e)return W;var o=1;if(i===Js&&(i=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),r<1||r>rl||t!==ri||n<8||n>15||i<0||i>9||a<0||a>tl)return _e(e,W);n===8&&(n=9);var s=new wl;return e.state=s,s.strm=e,s.wrap=o,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+C-1)/C),s.window=new R.Buf8(s.w_size*2),s.head=new R.Buf16(s.hash_size),s.prev=new R.Buf16(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new R.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=(1+2)*s.lit_bufsize,s.level=i,s.strategy=a,s.method=t,oa(e)}function bl(e,i){return sa(e,i,ri,al,ol,il)}function Al(e,i){var t,n,r,a;if(!e||!e.state||i>zn||i<0)return e?_e(e,W):W;if(n=e.state,!e.output||!e.input&&e.avail_in!==0||n.status===$e&&i!==xe)return _e(e,e.avail_out===0?gi:W);if(n.strm=e,t=n.last_flush,n.last_flush=i,n.status===ai)if(n.wrap===2)e.adler=0,L(n,31),L(n,139),L(n,8),n.gzhead?(L(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),L(n,n.gzhead.time&255),L(n,n.gzhead.time>>8&255),L(n,n.gzhead.time>>16&255),L(n,n.gzhead.time>>24&255),L(n,n.level===9?2:n.strategy>=Tt||n.level<2?4:0),L(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(L(n,n.gzhead.extra.length&255),L(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=he(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=Pi):(L(n,0),L(n,0),L(n,0),L(n,0),L(n,0),L(n,n.level===9?2:n.strategy>=Tt||n.level<2?4:0),L(n,pl),n.status=be);else{var o=ri+(n.w_bits-8<<4)<<8,s=-1;n.strategy>=Tt||n.level<2?s=0:n.level<6?s=1:n.level===6?s=2:s=3,o|=s<<6,n.strstart!==0&&(o|=cl),o+=31-o%31,n.status=be,je(n,o),n.strstart!==0&&(je(n,e.adler>>>16),je(n,e.adler&65535)),e.adler=1}if(n.status===Pi)if(n.gzhead.extra){for(r=n.pending;n.gzindex<(n.gzhead.extra.length&65535)&&!(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>r&&(e.adler=he(e.adler,n.pending_buf,n.pending-r,r)),de(e),r=n.pending,n.pending===n.pending_buf_size));)L(n,n.gzhead.extra[n.gzindex]&255),n.gzindex++;n.gzhead.hcrc&&n.pending>r&&(e.adler=he(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=Gt)}else n.status=Gt;if(n.status===Gt)if(n.gzhead.name){r=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>r&&(e.adler=he(e.adler,n.pending_buf,n.pending-r,r)),de(e),r=n.pending,n.pending===n.pending_buf_size)){a=1;break}n.gzindex<n.gzhead.name.length?a=n.gzhead.name.charCodeAt(n.gzindex++)&255:a=0,L(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>r&&(e.adler=he(e.adler,n.pending_buf,n.pending-r,r)),a===0&&(n.gzindex=0,n.status=Ht)}else n.status=Ht;if(n.status===Ht)if(n.gzhead.comment){r=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>r&&(e.adler=he(e.adler,n.pending_buf,n.pending-r,r)),de(e),r=n.pending,n.pending===n.pending_buf_size)){a=1;break}n.gzindex<n.gzhead.comment.length?a=n.gzhead.comment.charCodeAt(n.gzindex++)&255:a=0,L(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>r&&(e.adler=he(e.adler,n.pending_buf,n.pending-r,r)),a===0&&(n.status=Wt)}else n.status=Wt;if(n.status===Wt&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&de(e),n.pending+2<=n.pending_buf_size&&(L(n,e.adler&255),L(n,e.adler>>8&255),e.adler=0,n.status=be)):n.status=be),n.pending!==0){if(de(e),e.avail_out===0)return n.last_flush=-1,ie}else if(e.avail_in===0&&Rn(i)<=Rn(t)&&i!==xe)return _e(e,gi);if(n.status===$e&&e.avail_in!==0)return _e(e,gi);if(e.avail_in!==0||n.lookahead!==0||i!==ke&&n.status!==$e){var u=n.strategy===Tt?xl(n,i):n.strategy===el?_l(n,i):ze[n.level].func(n,i);if((u===Ce||u===He)&&(n.status=$e),u===z||u===Ce)return e.avail_out===0&&(n.last_flush=-1),ie;if(u===xt&&(i===Vs?H._tr_align(n):i!==zn&&(H._tr_stored_block(n,0,0,!1),i===Xs&&(ce(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),de(e),e.avail_out===0))return n.last_flush=-1,ie}return i!==xe?ie:n.wrap<=0?On:(n.wrap===2?(L(n,e.adler&255),L(n,e.adler>>8&255),L(n,e.adler>>16&255),L(n,e.adler>>24&255),L(n,e.total_in&255),L(n,e.total_in>>8&255),L(n,e.total_in>>16&255),L(n,e.total_in>>24&255)):(je(n,e.adler>>>16),je(n,e.adler&65535)),de(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?ie:On)}function Cl(e){var i;return!e||!e.state?W:(i=e.state.status,i!==ai&&i!==Pi&&i!==Gt&&i!==Ht&&i!==Wt&&i!==be&&i!==$e?_e(e,W):(e.state=null,i===be?_e(e,Qs):ie))}function El(e,i){var t=i.length,n,r,a,o,s,u,l,f;if(!e||!e.state||(n=e.state,o=n.wrap,o===2||o===1&&n.status!==ai||n.lookahead))return W;for(o===1&&(e.adler=na(e.adler,i,t,0)),n.wrap=0,t>=n.w_size&&(o===0&&(ce(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new R.Buf8(n.w_size),R.arraySet(f,i,t-n.w_size,n.w_size,0),i=f,t=n.w_size),s=e.avail_in,u=e.next_in,l=e.input,e.avail_in=t,e.next_in=0,e.input=i,Ee(n);n.lookahead>=C;){r=n.strstart,a=n.lookahead-(C-1);do n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+C-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++;while(--a);n.strstart=r,n.lookahead=C-1,Ee(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=C-1,n.match_available=0,e.next_in=u,e.input=l,e.avail_in=s,n.wrap=o,ie}ne.deflateInit=bl;ne.deflateInit2=sa;ne.deflateReset=oa;ne.deflateResetKeep=aa;ne.deflateSetHeader=ml;ne.deflate=Al;ne.deflateEnd=Cl;ne.deflateSetDictionary=El;ne.deflateInfo="pako deflate (from Nodeca project)";var Ie={},oi=oe,la=!0,fa=!0;try{String.fromCharCode.apply(null,[0])}catch{la=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{fa=!1}var ut=new oi.Buf8(256);for(var se=0;se<256;se++)ut[se]=se>=252?6:se>=248?5:se>=240?4:se>=224?3:se>=192?2:1;ut[254]=ut[254]=1;Ie.string2buf=function(e){var i,t,n,r,a,o=e.length,s=0;for(r=0;r<o;r++)t=e.charCodeAt(r),(t&64512)===55296&&r+1<o&&(n=e.charCodeAt(r+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),r++)),s+=t<128?1:t<2048?2:t<65536?3:4;for(i=new oi.Buf8(s),a=0,r=0;a<s;r++)t=e.charCodeAt(r),(t&64512)===55296&&r+1<o&&(n=e.charCodeAt(r+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),r++)),t<128?i[a++]=t:t<2048?(i[a++]=192|t>>>6,i[a++]=128|t&63):t<65536?(i[a++]=224|t>>>12,i[a++]=128|t>>>6&63,i[a++]=128|t&63):(i[a++]=240|t>>>18,i[a++]=128|t>>>12&63,i[a++]=128|t>>>6&63,i[a++]=128|t&63);return i};function ua(e,i){if(i<65537&&(e.subarray&&fa||!e.subarray&&la))return String.fromCharCode.apply(null,oi.shrinkBuf(e,i));for(var t="",n=0;n<i;n++)t+=String.fromCharCode(e[n]);return t}Ie.buf2binstring=function(e){return ua(e,e.length)};Ie.binstring2buf=function(e){for(var i=new oi.Buf8(e.length),t=0,n=i.length;t<n;t++)i[t]=e.charCodeAt(t);return i};Ie.buf2string=function(e,i){var t,n,r,a,o=i||e.length,s=new Array(o*2);for(n=0,t=0;t<o;){if(r=e[t++],r<128){s[n++]=r;continue}if(a=ut[r],a>4){s[n++]=65533,t+=a-1;continue}for(r&=a===2?31:a===3?15:7;a>1&&t<o;)r=r<<6|e[t++]&63,a--;if(a>1){s[n++]=65533;continue}r<65536?s[n++]=r:(r-=65536,s[n++]=55296|r>>10&1023,s[n++]=56320|r&1023)}return ua(s,n)};Ie.utf8border=function(e,i){var t;for(i=i||e.length,i>e.length&&(i=e.length),t=i-1;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?i:t+ut[e[t]]>i?t:i};function Sl(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var ha=Sl,Ve=ne,Xe=oe,Fi=Ie,Mn=Qi,Dl=ha,da=Object.prototype.toString,Ll=0,_i=4,Re=0,Nn=1,Un=2,kl=-1,Il=0,Bl=8;function Se(e){if(!(this instanceof Se))return new Se(e);this.options=Xe.assign({level:kl,method:Bl,chunkSize:16384,windowBits:15,memLevel:8,strategy:Il,to:""},e||{});var i=this.options;i.raw&&i.windowBits>0?i.windowBits=-i.windowBits:i.gzip&&i.windowBits>0&&i.windowBits<16&&(i.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Dl,this.strm.avail_out=0;var t=Ve.deflateInit2(this.strm,i.level,i.method,i.windowBits,i.memLevel,i.strategy);if(t!==Re)throw new Error(Mn[t]);if(i.header&&Ve.deflateSetHeader(this.strm,i.header),i.dictionary){var n;if(typeof i.dictionary=="string"?n=Fi.string2buf(i.dictionary):da.call(i.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(i.dictionary):n=i.dictionary,t=Ve.deflateSetDictionary(this.strm,n),t!==Re)throw new Error(Mn[t]);this._dict_set=!0}}Se.prototype.push=function(e,i){var t=this.strm,n=this.options.chunkSize,r,a;if(this.ended)return!1;a=i===~~i?i:i===!0?_i:Ll,typeof e=="string"?t.input=Fi.string2buf(e):da.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new Xe.Buf8(n),t.next_out=0,t.avail_out=n),r=Ve.deflate(t,a),r!==Nn&&r!==Re)return this.onEnd(r),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(a===_i||a===Un))&&(this.options.to==="string"?this.onData(Fi.buf2binstring(Xe.shrinkBuf(t.output,t.next_out))):this.onData(Xe.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&r!==Nn);return a===_i?(r=Ve.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Re):(a===Un&&(this.onEnd(Re),t.avail_out=0),!0)};Se.prototype.onData=function(e){this.chunks.push(e)};Se.prototype.onEnd=function(e){e===Re&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Xe.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Ji(e,i){var t=new Se(i);if(t.push(e,!0),t.err)throw t.msg;return t.result}function Tl(e,i){return i=i||{},i.raw=!0,Ji(e,i)}function Pl(e,i){return i=i||{},i.gzip=!0,Ji(e,i)}vt.Deflate=Se;vt.deflate=Ji;vt.deflateRaw=Tl;vt.gzip=Pl;var yt={},Q={},Pt=30,Fl=12,zl=function(i,t){var n,r,a,o,s,u,l,f,d,h,c,p,_,w,x,m,v,g,y,S,E,b,D,T,A;n=i.state,r=i.next_in,T=i.input,a=r+(i.avail_in-5),o=i.next_out,A=i.output,s=o-(t-i.avail_out),u=o+(i.avail_out-257),l=n.dmax,f=n.wsize,d=n.whave,h=n.wnext,c=n.window,p=n.hold,_=n.bits,w=n.lencode,x=n.distcode,m=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{_<15&&(p+=T[r++]<<_,_+=8,p+=T[r++]<<_,_+=8),g=w[p&m];t:for(;;){if(y=g>>>24,p>>>=y,_-=y,y=g>>>16&255,y===0)A[o++]=g&65535;else if(y&16){S=g&65535,y&=15,y&&(_<y&&(p+=T[r++]<<_,_+=8),S+=p&(1<<y)-1,p>>>=y,_-=y),_<15&&(p+=T[r++]<<_,_+=8,p+=T[r++]<<_,_+=8),g=x[p&v];i:for(;;){if(y=g>>>24,p>>>=y,_-=y,y=g>>>16&255,y&16){if(E=g&65535,y&=15,_<y&&(p+=T[r++]<<_,_+=8,_<y&&(p+=T[r++]<<_,_+=8)),E+=p&(1<<y)-1,E>l){i.msg="invalid distance too far back",n.mode=Pt;break e}if(p>>>=y,_-=y,y=o-s,E>y){if(y=E-y,y>d&&n.sane){i.msg="invalid distance too far back",n.mode=Pt;break e}if(b=0,D=c,h===0){if(b+=f-y,y<S){S-=y;do A[o++]=c[b++];while(--y);b=o-E,D=A}}else if(h<y){if(b+=f+h-y,y-=h,y<S){S-=y;do A[o++]=c[b++];while(--y);if(b=0,h<S){y=h,S-=y;do A[o++]=c[b++];while(--y);b=o-E,D=A}}}else if(b+=h-y,y<S){S-=y;do A[o++]=c[b++];while(--y);b=o-E,D=A}for(;S>2;)A[o++]=D[b++],A[o++]=D[b++],A[o++]=D[b++],S-=3;S&&(A[o++]=D[b++],S>1&&(A[o++]=D[b++]))}else{b=o-E;do A[o++]=A[b++],A[o++]=A[b++],A[o++]=A[b++],S-=3;while(S>2);S&&(A[o++]=A[b++],S>1&&(A[o++]=A[b++]))}}else if(y&64){i.msg="invalid distance code",n.mode=Pt;break e}else{g=x[(g&65535)+(p&(1<<y)-1)];continue i}break}}else if(y&64)if(y&32){n.mode=Fl;break e}else{i.msg="invalid literal/length code",n.mode=Pt;break e}else{g=w[(g&65535)+(p&(1<<y)-1)];continue t}break}}while(r<a&&o<u);S=_>>3,r-=S,_-=S<<3,p&=(1<<_)-1,i.next_in=r,i.next_out=o,i.avail_in=r<a?5+(a-r):5-(r-a),i.avail_out=o<u?257+(u-o):257-(o-u),n.hold=p,n.bits=_},Zn=oe,Pe=15,Gn=852,Hn=592,Wn=0,xi=1,jn=2,Ol=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Rl=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Ml=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Nl=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],Ul=function(i,t,n,r,a,o,s,u){var l=u.bits,f=0,d=0,h=0,c=0,p=0,_=0,w=0,x=0,m=0,v=0,g,y,S,E,b,D=null,T=0,A,$=new Zn.Buf16(Pe+1),bt=new Zn.Buf16(Pe+1),At=null,ln=0,fn,Ct,Et;for(f=0;f<=Pe;f++)$[f]=0;for(d=0;d<r;d++)$[t[n+d]]++;for(p=l,c=Pe;c>=1&&$[c]===0;c--);if(p>c&&(p=c),c===0)return a[o++]=1<<24|64<<16|0,a[o++]=1<<24|64<<16|0,u.bits=1,0;for(h=1;h<c&&$[h]===0;h++);for(p<h&&(p=h),x=1,f=1;f<=Pe;f++)if(x<<=1,x-=$[f],x<0)return-1;if(x>0&&(i===Wn||c!==1))return-1;for(bt[1]=0,f=1;f<Pe;f++)bt[f+1]=bt[f]+$[f];for(d=0;d<r;d++)t[n+d]!==0&&(s[bt[t[n+d]]++]=d);if(i===Wn?(D=At=s,A=19):i===xi?(D=Ol,T-=257,At=Rl,ln-=257,A=256):(D=Ml,At=Nl,A=-1),v=0,d=0,f=h,b=o,_=p,w=0,S=-1,m=1<<p,E=m-1,i===xi&&m>Gn||i===jn&&m>Hn)return 1;for(;;){fn=f-w,s[d]<A?(Ct=0,Et=s[d]):s[d]>A?(Ct=At[ln+s[d]],Et=D[T+s[d]]):(Ct=32+64,Et=0),g=1<<f-w,y=1<<_,h=y;do y-=g,a[b+(v>>w)+y]=fn<<24|Ct<<16|Et|0;while(y!==0);for(g=1<<f-1;v&g;)g>>=1;if(g!==0?(v&=g-1,v+=g):v=0,d++,--$[f]===0){if(f===c)break;f=t[n+s[d]]}if(f>p&&(v&E)!==S){for(w===0&&(w=p),b+=h,_=f-w,x=1<<_;_+w<c&&(x-=$[_+w],!(x<=0));)_++,x<<=1;if(m+=1<<_,i===xi&&m>Gn||i===jn&&m>Hn)return 1;S=v&E,a[S]=p<<24|_<<16|b-o|0}}return v!==0&&(a[b+v]=f-w<<24|64<<16|0),u.bits=p,0},G=oe,zi=ta,q=ia,Zl=zl,Qe=Ul,Gl=0,ca=1,pa=2,Kn=4,Hl=5,Ft=6,De=0,Wl=1,jl=2,j=-2,ga=-3,va=-4,Kl=-5,$n=8,_a=1,Yn=2,Vn=3,Xn=4,Qn=5,Jn=6,qn=7,er=8,tr=9,ir=10,Yt=11,re=12,yi=13,nr=14,wi=15,rr=16,ar=17,or=18,sr=19,zt=20,Ot=21,lr=22,fr=23,ur=24,hr=25,dr=26,mi=27,cr=28,pr=29,k=30,xa=31,$l=32,Yl=852,Vl=592,Xl=15,Ql=Xl;function gr(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function Jl(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new G.Buf16(320),this.work=new G.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ya(e){var i;return!e||!e.state?j:(i=e.state,e.total_in=e.total_out=i.total=0,e.msg="",i.wrap&&(e.adler=i.wrap&1),i.mode=_a,i.last=0,i.havedict=0,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new G.Buf32(Yl),i.distcode=i.distdyn=new G.Buf32(Vl),i.sane=1,i.back=-1,De)}function wa(e){var i;return!e||!e.state?j:(i=e.state,i.wsize=0,i.whave=0,i.wnext=0,ya(e))}function ma(e,i){var t,n;return!e||!e.state||(n=e.state,i<0?(t=0,i=-i):(t=(i>>4)+1,i<48&&(i&=15)),i&&(i<8||i>15))?j:(n.window!==null&&n.wbits!==i&&(n.window=null),n.wrap=t,n.wbits=i,wa(e))}function ba(e,i){var t,n;return e?(n=new Jl,e.state=n,n.window=null,t=ma(e,i),t!==De&&(e.state=null),t):j}function ql(e){return ba(e,Ql)}var vr=!0,bi,Ai;function ef(e){if(vr){var i;for(bi=new G.Buf32(512),Ai=new G.Buf32(32),i=0;i<144;)e.lens[i++]=8;for(;i<256;)e.lens[i++]=9;for(;i<280;)e.lens[i++]=7;for(;i<288;)e.lens[i++]=8;for(Qe(ca,e.lens,0,288,bi,0,e.work,{bits:9}),i=0;i<32;)e.lens[i++]=5;Qe(pa,e.lens,0,32,Ai,0,e.work,{bits:5}),vr=!1}e.lencode=bi,e.lenbits=9,e.distcode=Ai,e.distbits=5}function Aa(e,i,t,n){var r,a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new G.Buf8(a.wsize)),n>=a.wsize?(G.arraySet(a.window,i,t-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>n&&(r=n),G.arraySet(a.window,i,t-n,r,a.wnext),n-=r,n?(G.arraySet(a.window,i,t-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0}function tf(e,i){var t,n,r,a,o,s,u,l,f,d,h,c,p,_,w=0,x,m,v,g,y,S,E,b,D=new G.Buf8(4),T,A,$=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return j;t=e.state,t.mode===re&&(t.mode=yi),o=e.next_out,r=e.output,u=e.avail_out,a=e.next_in,n=e.input,s=e.avail_in,l=t.hold,f=t.bits,d=s,h=u,b=De;e:for(;;)switch(t.mode){case _a:if(t.wrap===0){t.mode=yi;break}for(;f<16;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}if(t.wrap&2&&l===35615){t.check=0,D[0]=l&255,D[1]=l>>>8&255,t.check=q(t.check,D,2,0),l=0,f=0,t.mode=Yn;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){e.msg="incorrect header check",t.mode=k;break}if((l&15)!==$n){e.msg="unknown compression method",t.mode=k;break}if(l>>>=4,f-=4,E=(l&15)+8,t.wbits===0)t.wbits=E;else if(E>t.wbits){e.msg="invalid window size",t.mode=k;break}t.dmax=1<<E,e.adler=t.check=1,t.mode=l&512?ir:re,l=0,f=0;break;case Yn:for(;f<16;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}if(t.flags=l,(t.flags&255)!==$n){e.msg="unknown compression method",t.mode=k;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=k;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&(D[0]=l&255,D[1]=l>>>8&255,t.check=q(t.check,D,2,0)),l=0,f=0,t.mode=Vn;case Vn:for(;f<32;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}t.head&&(t.head.time=l),t.flags&512&&(D[0]=l&255,D[1]=l>>>8&255,D[2]=l>>>16&255,D[3]=l>>>24&255,t.check=q(t.check,D,4,0)),l=0,f=0,t.mode=Xn;case Xn:for(;f<16;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&(D[0]=l&255,D[1]=l>>>8&255,t.check=q(t.check,D,2,0)),l=0,f=0,t.mode=Qn;case Qn:if(t.flags&1024){for(;f<16;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&(D[0]=l&255,D[1]=l>>>8&255,t.check=q(t.check,D,2,0)),l=0,f=0}else t.head&&(t.head.extra=null);t.mode=Jn;case Jn:if(t.flags&1024&&(c=t.length,c>s&&(c=s),c&&(t.head&&(E=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),G.arraySet(t.head.extra,n,a,c,E)),t.flags&512&&(t.check=q(t.check,n,c,a)),s-=c,a+=c,t.length-=c),t.length))break e;t.length=0,t.mode=qn;case qn:if(t.flags&2048){if(s===0)break e;c=0;do E=n[a+c++],t.head&&E&&t.length<65536&&(t.head.name+=String.fromCharCode(E));while(E&&c<s);if(t.flags&512&&(t.check=q(t.check,n,c,a)),s-=c,a+=c,E)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=er;case er:if(t.flags&4096){if(s===0)break e;c=0;do E=n[a+c++],t.head&&E&&t.length<65536&&(t.head.comment+=String.fromCharCode(E));while(E&&c<s);if(t.flags&512&&(t.check=q(t.check,n,c,a)),s-=c,a+=c,E)break e}else t.head&&(t.head.comment=null);t.mode=tr;case tr:if(t.flags&512){for(;f<16;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}if(l!==(t.check&65535)){e.msg="header crc mismatch",t.mode=k;break}l=0,f=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=re;break;case ir:for(;f<32;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}e.adler=t.check=gr(l),l=0,f=0,t.mode=Yt;case Yt:if(t.havedict===0)return e.next_out=o,e.avail_out=u,e.next_in=a,e.avail_in=s,t.hold=l,t.bits=f,jl;e.adler=t.check=1,t.mode=re;case re:if(i===Hl||i===Ft)break e;case yi:if(t.last){l>>>=f&7,f-=f&7,t.mode=mi;break}for(;f<3;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}switch(t.last=l&1,l>>>=1,f-=1,l&3){case 0:t.mode=nr;break;case 1:if(ef(t),t.mode=zt,i===Ft){l>>>=2,f-=2;break e}break;case 2:t.mode=ar;break;case 3:e.msg="invalid block type",t.mode=k}l>>>=2,f-=2;break;case nr:for(l>>>=f&7,f-=f&7;f<32;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}if((l&65535)!==(l>>>16^65535)){e.msg="invalid stored block lengths",t.mode=k;break}if(t.length=l&65535,l=0,f=0,t.mode=wi,i===Ft)break e;case wi:t.mode=rr;case rr:if(c=t.length,c){if(c>s&&(c=s),c>u&&(c=u),c===0)break e;G.arraySet(r,n,a,c,o),s-=c,a+=c,u-=c,o+=c,t.length-=c;break}t.mode=re;break;case ar:for(;f<14;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}if(t.nlen=(l&31)+257,l>>>=5,f-=5,t.ndist=(l&31)+1,l>>>=5,f-=5,t.ncode=(l&15)+4,l>>>=4,f-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=k;break}t.have=0,t.mode=or;case or:for(;t.have<t.ncode;){for(;f<3;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}t.lens[$[t.have++]]=l&7,l>>>=3,f-=3}for(;t.have<19;)t.lens[$[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,T={bits:t.lenbits},b=Qe(Gl,t.lens,0,19,t.lencode,0,t.work,T),t.lenbits=T.bits,b){e.msg="invalid code lengths set",t.mode=k;break}t.have=0,t.mode=sr;case sr:for(;t.have<t.nlen+t.ndist;){for(;w=t.lencode[l&(1<<t.lenbits)-1],x=w>>>24,m=w>>>16&255,v=w&65535,!(x<=f);){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}if(v<16)l>>>=x,f-=x,t.lens[t.have++]=v;else{if(v===16){for(A=x+2;f<A;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}if(l>>>=x,f-=x,t.have===0){e.msg="invalid bit length repeat",t.mode=k;break}E=t.lens[t.have-1],c=3+(l&3),l>>>=2,f-=2}else if(v===17){for(A=x+3;f<A;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}l>>>=x,f-=x,E=0,c=3+(l&7),l>>>=3,f-=3}else{for(A=x+7;f<A;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}l>>>=x,f-=x,E=0,c=11+(l&127),l>>>=7,f-=7}if(t.have+c>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=k;break}for(;c--;)t.lens[t.have++]=E}}if(t.mode===k)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=k;break}if(t.lenbits=9,T={bits:t.lenbits},b=Qe(ca,t.lens,0,t.nlen,t.lencode,0,t.work,T),t.lenbits=T.bits,b){e.msg="invalid literal/lengths set",t.mode=k;break}if(t.distbits=6,t.distcode=t.distdyn,T={bits:t.distbits},b=Qe(pa,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,T),t.distbits=T.bits,b){e.msg="invalid distances set",t.mode=k;break}if(t.mode=zt,i===Ft)break e;case zt:t.mode=Ot;case Ot:if(s>=6&&u>=258){e.next_out=o,e.avail_out=u,e.next_in=a,e.avail_in=s,t.hold=l,t.bits=f,Zl(e,h),o=e.next_out,r=e.output,u=e.avail_out,a=e.next_in,n=e.input,s=e.avail_in,l=t.hold,f=t.bits,t.mode===re&&(t.back=-1);break}for(t.back=0;w=t.lencode[l&(1<<t.lenbits)-1],x=w>>>24,m=w>>>16&255,v=w&65535,!(x<=f);){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}if(m&&!(m&240)){for(g=x,y=m,S=v;w=t.lencode[S+((l&(1<<g+y)-1)>>g)],x=w>>>24,m=w>>>16&255,v=w&65535,!(g+x<=f);){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}l>>>=g,f-=g,t.back+=g}if(l>>>=x,f-=x,t.back+=x,t.length=v,m===0){t.mode=dr;break}if(m&32){t.back=-1,t.mode=re;break}if(m&64){e.msg="invalid literal/length code",t.mode=k;break}t.extra=m&15,t.mode=lr;case lr:if(t.extra){for(A=t.extra;f<A;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,f-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=fr;case fr:for(;w=t.distcode[l&(1<<t.distbits)-1],x=w>>>24,m=w>>>16&255,v=w&65535,!(x<=f);){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}if(!(m&240)){for(g=x,y=m,S=v;w=t.distcode[S+((l&(1<<g+y)-1)>>g)],x=w>>>24,m=w>>>16&255,v=w&65535,!(g+x<=f);){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}l>>>=g,f-=g,t.back+=g}if(l>>>=x,f-=x,t.back+=x,m&64){e.msg="invalid distance code",t.mode=k;break}t.offset=v,t.extra=m&15,t.mode=ur;case ur:if(t.extra){for(A=t.extra;f<A;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,f-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=k;break}t.mode=hr;case hr:if(u===0)break e;if(c=h-u,t.offset>c){if(c=t.offset-c,c>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=k;break}c>t.wnext?(c-=t.wnext,p=t.wsize-c):p=t.wnext-c,c>t.length&&(c=t.length),_=t.window}else _=r,p=o-t.offset,c=t.length;c>u&&(c=u),u-=c,t.length-=c;do r[o++]=_[p++];while(--c);t.length===0&&(t.mode=Ot);break;case dr:if(u===0)break e;r[o++]=t.length,u--,t.mode=Ot;break;case mi:if(t.wrap){for(;f<32;){if(s===0)break e;s--,l|=n[a++]<<f,f+=8}if(h-=u,e.total_out+=h,t.total+=h,h&&(e.adler=t.check=t.flags?q(t.check,r,h,o-h):zi(t.check,r,h,o-h)),h=u,(t.flags?l:gr(l))!==t.check){e.msg="incorrect data check",t.mode=k;break}l=0,f=0}t.mode=cr;case cr:if(t.wrap&&t.flags){for(;f<32;){if(s===0)break e;s--,l+=n[a++]<<f,f+=8}if(l!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=k;break}l=0,f=0}t.mode=pr;case pr:b=Wl;break e;case k:b=ga;break e;case xa:return va;case $l:default:return j}return e.next_out=o,e.avail_out=u,e.next_in=a,e.avail_in=s,t.hold=l,t.bits=f,(t.wsize||h!==e.avail_out&&t.mode<k&&(t.mode<mi||i!==Kn))&&Aa(e,e.output,e.next_out,h-e.avail_out),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,t.total+=h,t.wrap&&h&&(e.adler=t.check=t.flags?q(t.check,r,h,e.next_out-h):zi(t.check,r,h,e.next_out-h)),e.data_type=t.bits+(t.last?64:0)+(t.mode===re?128:0)+(t.mode===zt||t.mode===wi?256:0),(d===0&&h===0||i===Kn)&&b===De&&(b=Kl),b}function nf(e){if(!e||!e.state)return j;var i=e.state;return i.window&&(i.window=null),e.state=null,De}function rf(e,i){var t;return!e||!e.state||(t=e.state,!(t.wrap&2))?j:(t.head=i,i.done=!1,De)}function af(e,i){var t=i.length,n,r,a;return!e||!e.state||(n=e.state,n.wrap!==0&&n.mode!==Yt)?j:n.mode===Yt&&(r=1,r=zi(r,i,t,0),r!==n.check)?ga:(a=Aa(e,i,t,t),a?(n.mode=xa,va):(n.havedict=1,De))}Q.inflateReset=wa;Q.inflateReset2=ma;Q.inflateResetKeep=ya;Q.inflateInit=ql;Q.inflateInit2=ba;Q.inflate=tf;Q.inflateEnd=nf;Q.inflateGetHeader=rf;Q.inflateSetDictionary=af;Q.inflateInfo="pako inflate (from Nodeca project)";var Ca={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function of(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var sf=of,Je=Q,qe=oe,Rt=Ie,F=Ca,lf=Qi,ff=ha,uf=sf,_r=Object.prototype.toString;function Le(e){if(!(this instanceof Le))return new Le(e);this.options=qe.assign({chunkSize:16384,windowBits:0,to:""},e||{});var i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,i.windowBits===0&&(i.windowBits=-15)),i.windowBits>=0&&i.windowBits<16&&!(e&&e.windowBits)&&(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&(i.windowBits&15||(i.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ff,this.strm.avail_out=0;var t=Je.inflateInit2(this.strm,i.windowBits);if(t!==F.Z_OK)throw new Error(lf[t]);this.header=new uf,Je.inflateGetHeader(this.strm,this.header)}Le.prototype.push=function(e,i){var t=this.strm,n=this.options.chunkSize,r=this.options.dictionary,a,o,s,u,l,f,d=!1;if(this.ended)return!1;o=i===~~i?i:i===!0?F.Z_FINISH:F.Z_NO_FLUSH,typeof e=="string"?t.input=Rt.binstring2buf(e):_r.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new qe.Buf8(n),t.next_out=0,t.avail_out=n),a=Je.inflate(t,F.Z_NO_FLUSH),a===F.Z_NEED_DICT&&r&&(typeof r=="string"?f=Rt.string2buf(r):_r.call(r)==="[object ArrayBuffer]"?f=new Uint8Array(r):f=r,a=Je.inflateSetDictionary(this.strm,f)),a===F.Z_BUF_ERROR&&d===!0&&(a=F.Z_OK,d=!1),a!==F.Z_STREAM_END&&a!==F.Z_OK)return this.onEnd(a),this.ended=!0,!1;t.next_out&&(t.avail_out===0||a===F.Z_STREAM_END||t.avail_in===0&&(o===F.Z_FINISH||o===F.Z_SYNC_FLUSH))&&(this.options.to==="string"?(s=Rt.utf8border(t.output,t.next_out),u=t.next_out-s,l=Rt.buf2string(t.output,s),t.next_out=u,t.avail_out=n-u,u&&qe.arraySet(t.output,t.output,s,u,0),this.onData(l)):this.onData(qe.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(d=!0)}while((t.avail_in>0||t.avail_out===0)&&a!==F.Z_STREAM_END);return a===F.Z_STREAM_END&&(o=F.Z_FINISH),o===F.Z_FINISH?(a=Je.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===F.Z_OK):(o===F.Z_SYNC_FLUSH&&(this.onEnd(F.Z_OK),t.avail_out=0),!0)};Le.prototype.onData=function(e){this.chunks.push(e)};Le.prototype.onEnd=function(e){e===F.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=qe.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function qi(e,i){var t=new Le(i);if(t.push(e,!0),t.err)throw t.msg;return t.result}function hf(e,i){return i=i||{},i.raw=!0,qi(e,i)}yt.Inflate=Le;yt.inflate=qi;yt.inflateRaw=hf;yt.ungzip=qi;var df=oe.assign,cf=vt,pf=yt,gf=Ca,Ea={};df(Ea,cf,pf,gf);var vf=Ea,Sa=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",Da=vf;Ue.uncompressInputType=Sa?"uint8array":"array";Ue.compressInputType=Sa?"uint8array":"array";Ue.magic="\b\0";Ue.compress=function(e,i){return Da.deflateRaw(e,{level:i.level||-1})};Ue.uncompress=function(e){return Da.inflateRaw(e)};gt.STORE={magic:"\0\0",compress:function(e,i){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null};gt.DEFLATE=Ue;var en={exports:{}};en.exports=function(e,i){return new Buffer(e,i)};en.exports.test=function(e){return Buffer.isBuffer(e)};var tn=en.exports;(function(e){var i=M,t=gt,n=tn;e.string2binary=function(l){for(var f="",d=0;d<l.length;d++)f+=String.fromCharCode(l.charCodeAt(d)&255);return f},e.arrayBuffer2Blob=function(l,f){e.checkSupport("blob"),f=f||"application/zip";try{return new Blob([l],{type:f})}catch{try{var d=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,h=new d;return h.append(l),h.getBlob(f)}catch{throw new Error("Bug : can't construct the Blob.")}}};function r(l){return l}function a(l,f){for(var d=0;d<l.length;++d)f[d]=l.charCodeAt(d)&255;return f}function o(l){var f=65536,d=[],h=l.length,c=e.getTypeOf(l),p=0,_=!0;try{switch(c){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,n(0));break}}catch{_=!1}if(!_){for(var w="",x=0;x<l.length;x++)w+=String.fromCharCode(l[x]);return w}for(;p<h&&f>1;)try{c==="array"||c==="nodebuffer"?d.push(String.fromCharCode.apply(null,l.slice(p,Math.min(p+f,h)))):d.push(String.fromCharCode.apply(null,l.subarray(p,Math.min(p+f,h)))),p+=f}catch{f=Math.floor(f/2)}return d.join("")}e.applyFromCharCode=o;function s(l,f){for(var d=0;d<l.length;d++)f[d]=l[d];return f}var u={};u.string={string:r,array:function(l){return a(l,new Array(l.length))},arraybuffer:function(l){return u.string.uint8array(l).buffer},uint8array:function(l){return a(l,new Uint8Array(l.length))},nodebuffer:function(l){return a(l,n(l.length))}},u.array={string:o,array:r,arraybuffer:function(l){return new Uint8Array(l).buffer},uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return n(l)}},u.arraybuffer={string:function(l){return o(new Uint8Array(l))},array:function(l){return s(new Uint8Array(l),new Array(l.byteLength))},arraybuffer:r,uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return n(new Uint8Array(l))}},u.uint8array={string:o,array:function(l){return s(l,new Array(l.length))},arraybuffer:function(l){return l.buffer},uint8array:r,nodebuffer:function(l){return n(l)}},u.nodebuffer={string:o,array:function(l){return s(l,new Array(l.length))},arraybuffer:function(l){return u.nodebuffer.uint8array(l).buffer},uint8array:function(l){return s(l,new Uint8Array(l.length))},nodebuffer:r},e.transformTo=function(l,f){if(f||(f=""),!l)return f;e.checkSupport(l);var d=e.getTypeOf(f),h=u[d][l](f);return h},e.getTypeOf=function(l){if(typeof l=="string")return"string";if(Object.prototype.toString.call(l)==="[object Array]")return"array";if(i.nodebuffer&&n.test(l))return"nodebuffer";if(i.uint8array&&l instanceof Uint8Array)return"uint8array";if(i.arraybuffer&&l instanceof ArrayBuffer)return"arraybuffer"},e.checkSupport=function(l){var f=i[l.toLowerCase()];if(!f)throw new Error(l+" is not supported by this browser")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(l){var f="",d,h;for(h=0;h<(l||"").length;h++)d=l.charCodeAt(h),f+="\\x"+(d<16?"0":"")+d.toString(16).toUpperCase();return f},e.findCompression=function(l){for(var f in t)if(t.hasOwnProperty(f)&&t[f].magic===l)return t[f];return null},e.isRegExp=function(l){return Object.prototype.toString.call(l)==="[object RegExp]"}})(X);var _f=X,xf=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],yf=function(i,t){if(typeof i>"u"||!i.length)return 0;var n=_f.getTypeOf(i)!=="string";typeof t>"u"&&(t=0);var r=0,a=0,o=0;t=t^-1;for(var s=0,u=i.length;s<u;s++)o=n?i[s]:i.charCodeAt(s),a=(t^o)&255,r=xf[a],t=t>>>8^r;return t^-1},ye={};ye.LOCAL_FILE_HEADER="PK";ye.CENTRAL_FILE_HEADER="PK";ye.CENTRAL_DIRECTORY_END="PK";ye.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07";ye.ZIP64_CENTRAL_DIRECTORY_END="PK";ye.DATA_DESCRIPTOR="PK\x07\b";var K={};K.base64=!1;K.binary=!1;K.dir=!1;K.createFolders=!1;K.date=null;K.compression=null;K.compressionOptions=null;K.comment=null;K.unixPermissions=null;K.dosPermissions=null;function La(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}La.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};var ka=La,nn={},Oi=X,et=M,wf=tn,ht=new Array(256);for(var le=0;le<256;le++)ht[le]=le>=252?6:le>=248?5:le>=240?4:le>=224?3:le>=192?2:1;ht[254]=ht[254]=1;var mf=function(e){var i,t,n,r,a,o=e.length,s=0;for(r=0;r<o;r++)t=e.charCodeAt(r),(t&64512)===55296&&r+1<o&&(n=e.charCodeAt(r+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),r++)),s+=t<128?1:t<2048?2:t<65536?3:4;for(et.uint8array?i=new Uint8Array(s):i=new Array(s),a=0,r=0;a<s;r++)t=e.charCodeAt(r),(t&64512)===55296&&r+1<o&&(n=e.charCodeAt(r+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),r++)),t<128?i[a++]=t:t<2048?(i[a++]=192|t>>>6,i[a++]=128|t&63):t<65536?(i[a++]=224|t>>>12,i[a++]=128|t>>>6&63,i[a++]=128|t&63):(i[a++]=240|t>>>18,i[a++]=128|t>>>12&63,i[a++]=128|t>>>6&63,i[a++]=128|t&63);return i},bf=function(e,i){var t;for(i=i||e.length,i>e.length&&(i=e.length),t=i-1;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?i:t+ht[e[t]]>i?t:i},xr=function(e){var i,t,n,r,a=e.length,o=new Array(a*2);for(t=0,i=0;i<a;){if(n=e[i++],n<128){o[t++]=n;continue}if(r=ht[n],r>4){o[t++]=65533,i+=r-1;continue}for(n&=r===2?31:r===3?15:7;r>1&&i<a;)n=n<<6|e[i++]&63,r--;if(r>1){o[t++]=65533;continue}n<65536?o[t++]=n:(n-=65536,o[t++]=55296|n>>10&1023,o[t++]=56320|n&1023)}return o.length!==t&&(o.subarray?o=o.subarray(0,t):o.length=t),Oi.applyFromCharCode(o)};nn.utf8encode=function(i){return et.nodebuffer?wf(i,"utf-8"):mf(i)};nn.utf8decode=function(i){if(et.nodebuffer)return Oi.transformTo("nodebuffer",i).toString("utf-8");i=Oi.transformTo(et.uint8array?"uint8array":"array",i);for(var t=[],n=0,r=i.length,a=65536;n<r;){var o=bf(i,Math.min(n+a,r));et.uint8array?t.push(xr(i.subarray(n,o))):t.push(xr(i.slice(n,o))),n=o}return t.join("")};var Af=X,Ia=function(){this.data=[]};Ia.prototype={append:function(e){e=Af.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}};var Cf=Ia,Ef=X,Ba=function(e){this.data=new Uint8Array(e),this.index=0};Ba.prototype={append:function(e){e.length!==0&&(e=Ef.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}};var Sf=Ba,Df=M,P=X,rn=yf,Ri=ye,Lf=K,Ta=pt,Mi=gt,Vt=ka,kf=tn,Xt=nn,If=Cf,Bf=Sf,Pa=function(e){if(e._data instanceof Vt&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,P.getTypeOf(e._data)==="uint8array")){var i=e._data;e._data=new Uint8Array(i.length),i.length!==0&&e._data.set(i,0)}return e._data},Ni=function(e){var i=Pa(e),t=P.getTypeOf(i);return t==="string"?!e.options.binary&&Df.nodebuffer?kf(i,"utf-8"):e.asBinary():i},yr=function(e){var i=Pa(this);return i===null||typeof i>"u"?"":(this.options.base64&&(i=Ta.decode(i)),e&&this.options.binary?i=Zi.utf8decode(i):i=P.transformTo("string",i),!e&&!this.options.binary&&(i=P.transformTo("string",Zi.utf8encode(i))),i)},an=function(e,i,t){this.name=e,this.dir=t.dir,this.date=t.date,this.comment=t.comment,this.unixPermissions=t.unixPermissions,this.dosPermissions=t.dosPermissions,this._data=i,this.options=t,this._initialMetadata={dir:t.dir,date:t.date}};an.prototype={asText:function(){return yr.call(this,!0)},asBinary:function(){return yr.call(this,!1)},asNodeBuffer:function(){var e=Ni(this);return P.transformTo("nodebuffer",e)},asUint8Array:function(){var e=Ni(this);return P.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var B=function(e,i){var t="",n;for(n=0;n<i;n++)t+=String.fromCharCode(e&255),e=e>>>8;return t},Ui=function(){var e={},i,t;for(i=0;i<arguments.length;i++)for(t in arguments[i])arguments[i].hasOwnProperty(t)&&typeof e[t]>"u"&&(e[t]=arguments[i][t]);return e},Tf=function(e){return e=e||{},e.base64===!0&&(e.binary===null||e.binary===void 0)&&(e.binary=!0),e=Ui(e,Lf),e.date=e.date||new Date,e.compression!==null&&(e.compression=e.compression.toUpperCase()),e},Fa=function(e,i,t){var n=P.getTypeOf(i),r;if(t=Tf(t),typeof t.unixPermissions=="string"&&(t.unixPermissions=parseInt(t.unixPermissions,8)),t.unixPermissions&&t.unixPermissions&16384&&(t.dir=!0),t.dosPermissions&&t.dosPermissions&16&&(t.dir=!0),t.dir&&(e=za(e)),t.createFolders&&(r=Pf(e))&&Oa.call(this,r,!0),t.dir||i===null||typeof i>"u")t.base64=!1,t.binary=!1,i=null,n=null;else if(n==="string")t.binary&&!t.base64&&t.optimizedBinaryString!==!0&&(i=P.string2binary(i));else{if(t.base64=!1,t.binary=!0,!n&&!(i instanceof Vt))throw new Error("The data of '"+e+"' is in an unsupported format !");n==="arraybuffer"&&(i=P.transformTo("uint8array",i))}var a=new an(e,i,t);return this.files[e]=a,a},Pf=function(e){e.slice(-1)=="/"&&(e=e.substring(0,e.length-1));var i=e.lastIndexOf("/");return i>0?e.substring(0,i):""},za=function(e){return e.slice(-1)!="/"&&(e+="/"),e},Oa=function(e,i){return i=typeof i<"u"?i:!1,e=za(e),this.files[e]||Fa.call(this,e,null,{dir:!0,createFolders:i}),this.files[e]},Ff=function(e,i,t){var n=new Vt,r;return e._data instanceof Vt?(n.uncompressedSize=e._data.uncompressedSize,n.crc32=e._data.crc32,n.uncompressedSize===0||e.dir?(i=Mi.STORE,n.compressedContent="",n.crc32=0):e._data.compressionMethod===i.magic?n.compressedContent=e._data.getCompressedContent():(r=e._data.getContent(),n.compressedContent=i.compress(P.transformTo(i.compressInputType,r),t))):(r=Ni(e),(!r||r.length===0||e.dir)&&(i=Mi.STORE,r=""),n.uncompressedSize=r.length,n.crc32=rn(r),n.compressedContent=i.compress(P.transformTo(i.compressInputType,r),t)),n.compressedSize=n.compressedContent.length,n.compressionMethod=i.magic,n},zf=function(e,i){var t=e;return e||(t=i?16893:33204),(t&65535)<<16},Of=function(e,i){return(e||0)&63},Rf=function(e,i,t,n,r){t.compressedContent;var a=P.transformTo("string",Xt.utf8encode(i.name)),o=i.comment||"",s=P.transformTo("string",Xt.utf8encode(o)),u=a.length!==i.name.length,l=s.length!==o.length,f=i.options,d,h,c="",p="",_="",w,x;i._initialMetadata.dir!==i.dir?w=i.dir:w=f.dir,i._initialMetadata.date!==i.date?x=i.date:x=f.date;var m=0,v=0;w&&(m|=16),r==="UNIX"?(v=798,m|=zf(i.unixPermissions,w)):(v=20,m|=Of(i.dosPermissions)),d=x.getHours(),d=d<<6,d=d|x.getMinutes(),d=d<<5,d=d|x.getSeconds()/2,h=x.getFullYear()-1980,h=h<<4,h=h|x.getMonth()+1,h=h<<5,h=h|x.getDate(),u&&(p=B(1,1)+B(rn(a),4)+a,c+="up"+B(p.length,2)+p),l&&(_=B(1,1)+B(this.crc32(s),4)+s,c+="uc"+B(_.length,2)+_);var g="";g+=`
\0`,g+=u||l?"\0\b":"\0\0",g+=t.compressionMethod,g+=B(d,2),g+=B(h,2),g+=B(t.crc32,4),g+=B(t.compressedSize,4),g+=B(t.uncompressedSize,4),g+=B(a.length,2),g+=B(c.length,2);var y=Ri.LOCAL_FILE_HEADER+g+a+c,S=Ri.CENTRAL_FILE_HEADER+B(v,2)+g+B(s.length,2)+"\0\0\0\0"+B(m,4)+B(n,4)+a+c+s;return{fileRecord:y,dirRecord:S,compressedObject:t}},Zi={load:function(e,i){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var i=[],t,n,r,a;for(t in this.files)this.files.hasOwnProperty(t)&&(r=this.files[t],a=new an(r.name,r._data,Ui(r.options)),n=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root&&e(n,a)&&i.push(a));return i},file:function(e,i,t){if(arguments.length===1)if(P.isRegExp(e)){var n=e;return this.filter(function(r,a){return!a.dir&&n.test(r)})}else return this.filter(function(r,a){return!a.dir&&r===e})[0]||null;else e=this.root+e,Fa.call(this,e,i,t);return this},folder:function(e){if(!e)return this;if(P.isRegExp(e))return this.filter(function(r,a){return a.dir&&e.test(r)});var i=this.root+e,t=Oa.call(this,i),n=this.clone();return n.root=t.name,n},remove:function(e){e=this.root+e;var i=this.files[e];if(i||(e.slice(-1)!="/"&&(e+="/"),i=this.files[e]),i&&!i.dir)delete this.files[e];else for(var t=this.filter(function(r,a){return a.name.slice(0,e.length)===e}),n=0;n<t.length;n++)delete this.files[t[n].name];return this},generate:function(e){e=Ui(e||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip"}),P.checkSupport(e.type),(e.platform==="darwin"||e.platform==="freebsd"||e.platform==="linux"||e.platform==="sunos")&&(e.platform="UNIX"),e.platform==="win32"&&(e.platform="DOS");var i=[],t=0,n=0,r,a,o=P.transformTo("string",this.utf8encode(e.comment||this.comment||""));for(var s in this.files)if(this.files.hasOwnProperty(s)){var u=this.files[s],l=u.options.compression||e.compression.toUpperCase(),f=Mi[l];if(!f)throw new Error(l+" is not a valid compression method !");var d=u.options.compressionOptions||e.compressionOptions||{},h=Ff.call(this,u,f,d),c=Rf.call(this,s,u,h,t,e.platform);t+=c.fileRecord.length+h.compressedSize,n+=c.dirRecord.length,i.push(c)}var p="";p=Ri.CENTRAL_DIRECTORY_END+"\0\0\0\0"+B(i.length,2)+B(i.length,2)+B(n,4)+B(t,4)+B(o.length,2)+o;var _=e.type.toLowerCase();for(_==="uint8array"||_==="arraybuffer"||_==="blob"||_==="nodebuffer"?r=new Bf(t+n+p.length):r=new If(t+n+p.length),a=0;a<i.length;a++)r.append(i[a].fileRecord),r.append(i[a].compressedObject.compressedContent);for(a=0;a<i.length;a++)r.append(i[a].dirRecord);r.append(p);var w=r.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return P.transformTo(e.type.toLowerCase(),w);case"blob":return P.arrayBuffer2Blob(P.transformTo("arraybuffer",w),e.mimeType);case"base64":return e.base64?Ta.encode(w):w;default:return w}},crc32:function(e,i){return rn(e,i)},utf8encode:function(e){return P.transformTo("string",Xt.utf8encode(e))},utf8decode:function(e){return Xt.utf8decode(e)}},on=Zi,Mf=X;function Ra(e){this.data=null,this.length=0,this.index=0}Ra.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var i=0,t;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)i=(i<<8)+this.byteAt(t);return this.index+=e,i},readString:function(e){return Mf.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1)}};var Ma=Ra,Nf=Ma,Uf=X;function wt(e,i){this.data=e,i||(this.data=Uf.string2binary(this.data)),this.length=this.data.length,this.index=0}wt.prototype=new Nf;wt.prototype.byteAt=function(e){return this.data.charCodeAt(e)};wt.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)};wt.prototype.readData=function(e){this.checkOffset(e);var i=this.data.slice(this.index,this.index+e);return this.index+=e,i};var Na=wt,Zf=Ma;function mt(e){e&&(this.data=e,this.length=this.data.length,this.index=0)}mt.prototype=new Zf;mt.prototype.byteAt=function(e){return this.data[e]};mt.prototype.lastIndexOfSignature=function(e){for(var i=e.charCodeAt(0),t=e.charCodeAt(1),n=e.charCodeAt(2),r=e.charCodeAt(3),a=this.length-4;a>=0;--a)if(this.data[a]===i&&this.data[a+1]===t&&this.data[a+2]===n&&this.data[a+3]===r)return a;return-1};mt.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var i=this.data.subarray(this.index,this.index+e);return this.index+=e,i};var Ua=mt,Gf=Ua;function sn(e){this.data=e,this.length=this.data.length,this.index=0}sn.prototype=new Gf;sn.prototype.readData=function(e){this.checkOffset(e);var i=this.data.slice(this.index,this.index+e);return this.index+=e,i};var Hf=sn,Ci=Na,fe=X,Wf=ka,we=on,jf=0,Kf=3;function Za(e,i){this.options=e,this.loadOptions=i}Za.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},prepareCompressedContent:function(e,i,t){return function(){var n=e.index;e.setIndex(i);var r=e.readData(t);return e.setIndex(n),r}},prepareContent:function(e,i,t,n,r){return function(){var a=fe.transformTo(n.uncompressInputType,this.getCompressedContent()),o=n.uncompress(a);if(o.length!==r)throw new Error("Bug : uncompressed data size mismatch");return o}},readLocalPart:function(e){var i,t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readString(this.fileNameLength),e.skip(t),this.compressedSize==-1||this.uncompressedSize==-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(i=fe.findCompression(this.compressionMethod),i===null)throw new Error("Corrupted zip : compression "+fe.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new Wf,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,i),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,i,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=fe.transformTo("string",this.decompressed.getContent()),we.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readInt(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readString(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),e===jf&&(this.dosPermissions=this.externalFileAttributes&63),e===Kf&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileName.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var i=new Ci(this.extraFields[1].value);this.uncompressedSize===fe.MAX_VALUE_32BITS&&(this.uncompressedSize=i.readInt(8)),this.compressedSize===fe.MAX_VALUE_32BITS&&(this.compressedSize=i.readInt(8)),this.localHeaderOffset===fe.MAX_VALUE_32BITS&&(this.localHeaderOffset=i.readInt(8)),this.diskNumberStart===fe.MAX_VALUE_32BITS&&(this.diskNumberStart=i.readInt(4))}},readExtraFields:function(e){var i=e.index,t,n,r;for(this.extraFields=this.extraFields||{};e.index<i+this.extraFieldsLength;)t=e.readInt(2),n=e.readInt(2),r=e.readString(n),this.extraFields[t]={id:t,length:n,value:r}},handleUTF8:function(){if(this.useUTF8())this.fileName=we.utf8decode(this.fileName),this.fileComment=we.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();e!==null&&(this.fileName=e);var i=this.findExtraFieldUnicodeComment();i!==null&&(this.fileComment=i)}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var i=new Ci(e.value);return i.readInt(1)!==1||we.crc32(this.fileName)!==i.readInt(4)?null:we.utf8decode(i.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var i=new Ci(e.value);return i.readInt(1)!==1||we.crc32(this.fileComment)!==i.readInt(4)?null:we.utf8decode(i.readString(e.length-5))}return null}};var $f=Za,Yf=Na,Vf=Hf,Xf=Ua,ee=X,ue=ye,Qf=$f,Jf=M,qf=on;function Ga(e,i){this.files=[],this.loadOptions=i,e&&this.load(e)}Ga.prototype={checkSignature:function(e){var i=this.reader.readString(4);if(i!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+ee.pretty(i)+", expected "+ee.pretty(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=qf.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e=this.zip64EndOfCentralSize-44,i=0,t,n,r;i<e;)t=this.reader.readInt(2),n=this.reader.readInt(4),r=this.reader.readString(n),this.zip64ExtensibleData[t]={id:t,length:n,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,i;for(e=0;e<this.files.length;e++)i=this.files[e],this.reader.setIndex(i.localHeaderOffset),this.checkSignature(ue.LOCAL_FILE_HEADER),i.readLocalPart(this.reader),i.handleUTF8(),i.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===ue.CENTRAL_FILE_HEADER;)e=new Qf({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(ue.CENTRAL_DIRECTORY_END);if(e===-1){var i=!0;try{this.reader.setIndex(0),this.checkSignature(ue.LOCAL_FILE_HEADER),i=!1}catch{}throw i?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory")}if(this.reader.setIndex(e),this.checkSignature(ue.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===ee.MAX_VALUE_16BITS||this.diskWithCentralDirStart===ee.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===ee.MAX_VALUE_16BITS||this.centralDirRecords===ee.MAX_VALUE_16BITS||this.centralDirSize===ee.MAX_VALUE_32BITS||this.centralDirOffset===ee.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(ue.ZIP64_CENTRAL_DIRECTORY_LOCATOR),e===-1)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(e),this.checkSignature(ue.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(ue.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var i=ee.getTypeOf(e);i==="string"&&!Jf.uint8array?this.reader=new Yf(e,this.loadOptions.optimizedBinaryString):i==="nodebuffer"?this.reader=new Vf(e):this.reader=new Xf(ee.transformTo("uint8array",e))},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var eu=Ga,tu=pt,iu=eu,nu=function(e,i){var t,n,r,a;for(i=i||{},i.base64&&(e=tu.decode(e)),n=new iu(e,i),t=n.files,r=0;r<t.length;r++)a=t[r],this.file(a.fileName,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileComment.length?a.fileComment:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:i.createFolders});return n.zipComment.length&&(this.comment=n.zipComment),this},Z={},U=X;Z.string2binary=function(e){return U.string2binary(e)};Z.string2Uint8Array=function(e){return U.transformTo("uint8array",e)};Z.uint8Array2String=function(e){return U.transformTo("string",e)};Z.string2Blob=function(e){var i=U.transformTo("arraybuffer",e);return U.arrayBuffer2Blob(i)};Z.arrayBuffer2Blob=function(e){return U.arrayBuffer2Blob(e)};Z.transformTo=function(e,i){return U.transformTo(e,i)};Z.getTypeOf=function(e){return U.getTypeOf(e)};Z.checkSupport=function(e){return U.checkSupport(e)};Z.MAX_VALUE_16BITS=U.MAX_VALUE_16BITS;Z.MAX_VALUE_32BITS=U.MAX_VALUE_32BITS;Z.pretty=function(e){return U.pretty(e)};Z.findCompression=function(e){return U.findCompression(e)};Z.isRegExp=function(e){return U.isRegExp(e)};var wr=pt;function V(e,i){if(!(this instanceof V))return new V(e,i);this.files={},this.comment=null,this.root="",e&&this.load(e,i),this.clone=function(){var t=new V;for(var n in this)typeof this[n]!="function"&&(t[n]=this[n]);return t}}V.prototype=on;V.prototype.load=nu;V.support=M;V.defaults=K;V.utils=Z;V.base64={encode:function(e){return wr.encode(e)},decode:function(e){return wr.decode(e)}};V.compressions=gt;var ru=V,au=Nr,Ei=ni,ou=Rr,su=ru,Ha=function(e,i){var t=new su,n=t.folder(i&&i.folder?i.folder:"layers");[Ei.point(e),Ei.line(e),Ei.polygon(e)].forEach(function(a){a.geometries.length&&a.geometries[0].length&&au(a.properties,a.type,a.geometries,function(o,s){var u=i&&i.types[a.type.toLowerCase()]?i.types[a.type.toLowerCase()]:a.type;n.file(u+".shp",s.shp.buffer,{binary:!0}),n.file(u+".shx",s.shx.buffer,{binary:!0}),n.file(u+".dbf",s.dbf.buffer,{binary:!0}),n.file(u+".prj",ou)})});var r={type:"base64"};return t.generateAsync(r)},lu=Ha,fu=async function(e,i){var t=await lu(e,i);location.href="data:application/zip;base64,"+t};qt.download=fu;qt.write=Nr;qt.zip=Ha;const uu={layers:[],mapStyle:tt.getters.mapStyle,controller:!0,screenshotFilename:"",useDevicePixels:!1,getCursor:({isDragging:e,isHovering:i})=>e?"grabbing":i?"pointer":""},mr={position:"absolute",left:0,top:0,width:"100%",height:"100%"};tt.state.colorScheme,$a.DarkMode;function hu(e){let{container:i=document.body}=e;if(typeof i=="string"&&(i=document.querySelector(i)),!i)throw new Error("[DeckMap] container not found");window.getComputedStyle(i).position==="static"&&(i.style.position="relative");const n=document.createElement("div");i.appendChild(n),Object.assign(n.style,mr);const r=document.createElement("canvas");return r.width=window.innerWidth,r.height=window.innerHeight,r.oncontextmenu=()=>!1,i.appendChild(r),Object.assign(r.style,mr),{container:i,mapboxCanvas:n,deckCanvas:r}}class du extends ro{constructor(i={}){i={...uu,onResize:()=>{this._map&&this._map.resize()},onAfterRender:()=>{this.props.screenshotFilename&&(this.savePNGcallback(),this.props.screenshotFilename="")},...i};const{mapboxCanvas:t,deckCanvas:n}=hu(i),r=i.viewState,a=i.basemap;super({canvas:n,...i}),a?this._map=a:this._map=new Ya.Map({container:t,style:i.mapStyle,interactive:!1,center:[r.longitude,r.latitude],zoom:r.zoom,bearing:r.bearing||0,pitch:r.pitch||0}),this._onBeforeRender=o=>{if(this.onBeforeRender(o),this._map){const s=this.getViewports()[0];this._map.jumpTo({center:[s.longitude,s.latitude],zoom:s.zoom,bearing:s.bearing,pitch:s.pitch}),this.redrawMapbox()}}}redrawMapbox(){const i=this._map;i.style&&(i._frame&&(i._frame.cancel(),i._frame=null),i._render())}setMapStyle(i){this._map&&this._map.setStyle(i)}getMapboxMap(){return this._map}finalize(){this._map&&this._map.remove(),this._map=null,super.finalize()}setProps(i){"onBeforeRender"in i&&this._onBeforeRender&&i.onBeforeRender!==this._onBeforeRender&&(this.onBeforeRender=i.onBeforeRender,i.onBeforeRender=this._onBeforeRender),super.setProps(i)}takeScreenshot(){this.props.useDevicePixels=!0,this.props.screenshotFilename="screenshot1.png",this.redraw()}savePNGcallback(){const i=this._map._canvas.toDataURL("image/png"),t=this.canvas.toDataURL("image/png"),n=this.mergeImageURIs({width:this.canvas.width,height:this.canvas.height,imageDataURLs:[i,t]});this.props.useDevicePixels=!1,n.then(r=>{var a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download","screenshot.png"),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)})}mergeImageURIs(i){return new Promise((t,n)=>{var r=document.createElement("canvas");r.width=i.width,r.height=i.height,Promise.all(i.imageDataURLs.map(a=>this.add2canvas(r,a))).then(()=>{const a=r.getContext("2d"),o=r.width-152,s=r.height-8;a.beginPath(),a.rect(o-4,s-14,158,22),a.fillStyle="#ffffff44",a.fill(),a.font="11px Arial",a.fillStyle="#888",a.fillText(" Mapbox   OpenStreetMap",o,s),t(r.toDataURL("image/png"))})})}add2canvas(i,t){return new Promise((n,r)=>{i||r(),t||r();var a=new Image;a.onload=function(){i.getContext("2d").drawImage(this,0,0),n(!0)},a.src=t})}}class cu{constructor(){si(this,"layers");si(this,"deckInstance");this.layers={},this.deckInstance=null}init(i){if(this.deckInstance=new du({...i,map:Va}),i.mapStyle!==null){const t=tt.getters.mapStyle;this.deckInstance.setMapStyle(t)}}destroy(){this.deckInstance&&(this.deckInstance.finalize(),delete this.deckInstance)}hasLayer(i){return!!this.layers[i]}getLayers(){return this.layers}isVisible(i){return this.layers[i]&&this.layers[i].props.visible!==!1}updateDeckInstance(){if(!this.deckInstance)return;const i=[...Object.values(this.layers)];this.deckInstance.setProps({layers:i})}updateStyle(){if(!this.deckInstance)return;const i=tt.getters.mapStyle;this.deckInstance.setMapStyle(i)}addLayer(i){if(!i.id)throw new Error(`[layerManager.addLayer] layer id must defined. Received "${i.id}" instead`);this.layers[i.id]=i,this.updateDeckInstance()}updateLayer(i,t){if(!this.layers[i])return;const n=this.layers[i];this.layers[i]=n.clone(t),this.updateDeckInstance()}removeLayer(i){this.hasLayer(i)&&(delete this.layers[i],this.updateDeckInstance())}hideLayer(i){this.hasLayer(i)&&this.updateLayer(i,{visible:!1})}showLayer(i){this.hasLayer(i)&&this.updateLayer(i,{visible:!0})}takeScreenshot(){this.deckInstance.takeScreenshot()}}const pu={messages:{en:{title:"Draw Shapes",hint:"Click on map to draw shapes.",clear:"Clear",shapefile:"Export","close-shape":"Add more points to close shape.","more-shapes":"Export now or start new shape."},de:{}}},gu=Xa({name:"DrawingTool",i18n:pu,data:()=>{const e=[];return{canExport:!1,hint:"",isDark:tt.state.isDarkMode,points:e,showShapeDrawer:!1,layerManager:new cu,mapID:`map-id-${Math.floor(1e12*Math.random())}`,polygons:[{type:"Feature",geometry:{type:"Polygon",coordinates:[e]},finished:!1}]}},mounted(){console.log("DRATWOOL"),this.hint=this.$t("hint"),this.setupLayerManager(),this.updateLayers()},beforeDestroy(){this.showShapeDrawer=!1,this.layerManager.destroy()},watch:{viewState(){this.layerManager.deckInstance.setProps({viewState:this.viewState})},"globalStore.state.isDarkMode"(){this.isDark=this.$store.state.isDarkMode,this.layerManager.updateStyle()}},computed:{viewState(){return this.$store.state.viewState}},methods:{toggleShapeDrawer(){this.clearShapes(),this.updateLayers(),this.showShapeDrawer=!this.showShapeDrawer},clearShapes(){this.canExport=!1,this.points=[],this.polygons=[{type:"Feature",geometry:{type:"Polygon",coordinates:[this.points]},finished:!1}]},setupLayerManager(){this.layerManager.init({container:`#${this.mapID}`,viewState:this.$store.state.viewState,pickingRadius:3,mapStyle:null,getCursor:({isDragging:e,isHovering:i})=>e?"grabbing":i?"pointer":"crosshair",onViewStateChange:({viewState:e})=>{this.$store.commit("setMapCamera",e)},onClick:this.handleMapClick})},exportIt(){this.polygons=this.polygons.filter(i=>i.finished),this.points=[],this.updateLayers();const e={type:"FeatureCollection",features:this.polygons};qt.download(e,{folder:"shapefile-wgs84",types:{point:"points",polygon:"polygons",line:"lines"}}),this.startNewPolygon()},cancel(){this.hint=this.$t("hint"),this.clearShapes(),this.updateLayers(),this.showShapeDrawer=!1},handleMapClick(e,i){e.coordinate&&(i.rightButton?this.points.pop():(this.points.push(e.coordinate),this.hint=this.$t("close-shape")),this.updateLayers())},startNewPolygon(){this.points=[],this.polygons.push({type:"Feature",geometry:{type:"Polygon",coordinates:[this.points]},finished:!1})},handlePointClick(e){return e.index===0&&(this.points.push(this.points[0]),this.polygons[this.polygons.length-1].finished=!0,this.startNewPolygon(),this.canExport=!0,this.hint=this.$t("more-shapes"),this.updateLayers()),!0},handleViewState(e){this.$store.commit("setMapCamera",e)},updateLayers(){const e=this.polygons.slice(0),i=this.points.slice(0);this.layerManager.removeLayer("draw-polygon-layer"),this.layerManager.addLayer(new Wi({id:"draw-polygon-layer",data:e,pickable:!1,stroked:!0,filled:!0,extruded:!1,lineWidthMinPixels:4,getFillColor:[175,160,255,80],getLineColor:[255,0,200],getLineWidth:10,parameters:{depthTest:!1}})),this.layerManager.removeLayer("draw-scatterplot-layer"),this.layerManager.addLayer(new Ar({id:"draw-scatterplot-layer",data:i,getPosition:t=>t,pickable:!0,stroked:!0,filled:!0,radiusMinPixels:6,radiusMaxPixels:6,lineWidthMinPixels:2,getFillColor:[255,0,200],getLineColor:[255,255,255],opacity:1,onClick:this.handlePointClick}))}}}),br="/sandbox/assets/draw-icon-dm-04d4af86.png",vu="data:image/png;base64,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";var _u=function(){var i=this,t=i._self._c;return i._self._setupProxy,t("div",{staticClass:"draw-thing"},[t("div",{directives:[{name:"show",rawName:"v-show",value:i.showShapeDrawer,expression:"showShapeDrawer"}],staticClass:"map",attrs:{id:i.mapID},on:{click:i.handleMapClick}}),t("div",{staticClass:"map-actions"},[i.isDark&&i.showShapeDrawer?t("button",{staticClass:"button draw-button is-tiny",class:{"is-drawing":i.showShapeDrawer},style:{border:"1px solid rgb(119,119,119)"},attrs:{title:"Draw"},on:{click:i.toggleShapeDrawer}},[t("img",{attrs:{src:br,width:"16"}})]):i.isDark&&!i.showShapeDrawer?t("button",{staticClass:"button draw-button is-tiny",class:{"is-drawing":i.showShapeDrawer},style:{background:"rgb(43,60,78)",border:"1px solid rgb(119,119,119)"},attrs:{title:"Draw"},on:{click:i.toggleShapeDrawer}},[t("img",{attrs:{src:br,width:"16"}})]):t("button",{staticClass:"button draw-button is-tiny",class:{"is-drawing":i.showShapeDrawer},style:{border:"1px solid rgb(224,224,224)"},attrs:{title:"Draw"},on:{click:i.toggleShapeDrawer}},[t("img",{attrs:{src:vu,width:"16"}})])]),i.showShapeDrawer?t("div",{staticClass:"control-panel"},[t("h3",[i._v(i._s(i.$t("title")))]),t("p",[i._v(i._s(i.hint))]),t("div",{staticClass:"buttons"},[t("button",{staticClass:"button is-small export-button",style:{"is-outlined":!i.canExport},attrs:{disabled:!i.canExport},on:{click:i.exportIt}},[i._v(i._s(i.$t("shapefile")))]),t("button",{staticClass:"button is-small is-outlined",on:{click:i.cancel}},[i._v(i._s(i.$t("clear")))])])]):i._e()])},xu=[];var yu=Qa(gu,_u,xu,!1,null,"a96260c0",null,null);const Su=yu.exports;export{Su as D,Wi as G,Lr as W,_o as g,kr as m,Eu as p};
//# sourceMappingURL=DrawingTool-66208c73.js.map
