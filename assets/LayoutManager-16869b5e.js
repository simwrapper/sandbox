import{d as Y,n as G,p as gt,g as T,V as mt,S as rs,f as jt,a as Ue,s as Bt}from"./index-04a97e2f.js";import{H as qe,m as K}from"./HTTPFileSystem-1abeeaf0.js";import{m as Ye}from"./index-b64711ff.js";import{y as Ge}from"./index-56badaec.js";import{D as os}from"./DashBoard-b344bd03.js";import{T as ns}from"./TopSheet-ad8207ae.js";import{D as ls}from"./DashboardDataManager-654ce543.js";import"./util-f1a89f99.js";import"./RoadNetworkLoader.worker-758f3878.js";import"./index-f6506551.js";/*! @license DOMPurify 2.4.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.0/LICENSE */function ne(t){"@babel/helpers - typeof";return ne=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(t)}function ht(t,e){return ht=Object.setPrototypeOf||function(a,r){return a.__proto__=r,a},ht(t,e)}function cs(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function We(t,e,s){return cs()?We=Reflect.construct:We=function(r,o,u){var m=[null];m.push.apply(m,o);var _=Function.bind.apply(r,m),D=new _;return u&&ht(D,u.prototype),D},We.apply(null,arguments)}function V(t){return ds(t)||us(t)||ms(t)||hs()}function ds(t){if(Array.isArray(t))return ft(t)}function us(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ms(t,e){if(t){if(typeof t=="string")return ft(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ft(t,e)}}function ft(t,e){(e==null||e>t.length)&&(e=t.length);for(var s=0,a=new Array(e);s<e;s++)a[s]=t[s];return a}function hs(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var fs=Object.hasOwnProperty,Ot=Object.setPrototypeOf,ps=Object.isFrozen,gs=Object.getPrototypeOf,vs=Object.getOwnPropertyDescriptor,M=Object.freeze,J=Object.seal,ys=Object.create,Ut=typeof Reflect<"u"&&Reflect,Ve=Ut.apply,pt=Ut.construct;Ve||(Ve=function(e,s,a){return e.apply(s,a)});M||(M=function(e){return e});J||(J=function(e){return e});pt||(pt=function(e,s){return We(e,V(s))});var bs=q(Array.prototype.forEach),Ft=q(Array.prototype.pop),Le=q(Array.prototype.push),je=q(String.prototype.toLowerCase),_s=q(String.prototype.match),oe=q(String.prototype.replace),Ss=q(String.prototype.indexOf),Cs=q(String.prototype.trim),I=q(RegExp.prototype.test),ot=ws(TypeError);function q(t){return function(e){for(var s=arguments.length,a=new Array(s>1?s-1:0),r=1;r<s;r++)a[r-1]=arguments[r];return Ve(t,e,a)}}function ws(t){return function(){for(var e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return pt(t,s)}}function p(t,e,s){s=s||je,Ot&&Ot(t,null);for(var a=e.length;a--;){var r=e[a];if(typeof r=="string"){var o=s(r);o!==r&&(ps(e)||(e[a]=o),r=o)}t[r]=!0}return t}function ue(t){var e=ys(null),s;for(s in t)Ve(fs,t,[s])&&(e[s]=t[s]);return e}function Ie(t,e){for(;t!==null;){var s=vs(t,e);if(s){if(s.get)return q(s.get);if(typeof s.value=="function")return q(s.value)}t=gs(t)}function a(r){return console.warn("fallback value for",r),null}return a}var Pt=M(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),nt=M(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lt=M(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ts=M(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ct=M(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Es=M(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),zt=M(["#text"]),$t=M(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),dt=M(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Nt=M(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Me=M(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),As=J(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ks=J(/<%[\w\W]*|[\w\W]*%>/gm),Ds=J(/^data-[\-\w.\u00B7-\uFFFF]/),Ls=J(/^aria-[\-\w]+$/),xs=J(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Rs=J(/^(?:\w+script|data):/i),Os=J(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Fs=J(/^html$/i),Ps=function(){return typeof window>"u"?null:window},zs=function(e,s){if(ne(e)!=="object"||typeof e.createPolicy!="function")return null;var a=null,r="data-tt-policy-suffix";s.currentScript&&s.currentScript.hasAttribute(r)&&(a=s.currentScript.getAttribute(r));var o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML:function(m){return m},createScriptURL:function(m){return m}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function Gt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ps(),e=function(i){return Gt(i)};if(e.version="2.4.0",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var s=t.document,a=t.document,r=t.DocumentFragment,o=t.HTMLTemplateElement,u=t.Node,m=t.Element,_=t.NodeFilter,D=t.NamedNodeMap,L=D===void 0?t.NamedNodeMap||t.MozNamedAttrMap:D,W=t.HTMLFormElement,B=t.DOMParser,Q=t.trustedTypes,N=m.prototype,Re=Ie(N,"cloneNode"),Ze=Ie(N,"nextSibling"),Xe=Ie(N,"childNodes"),Se=Ie(N,"parentNode");if(typeof o=="function"){var x=a.createElement("template");x.content&&x.content.ownerDocument&&(a=x.content.ownerDocument)}var P=zs(Q,s),ee=P?P.createHTML(""):"",le=a,y=le.implementation,l=le.createNodeIterator,he=le.createDocumentFragment,E=le.getElementsByTagName,R=s.importNode,f={};try{f=ue(a).documentMode?a.documentMode:{}}catch{}var h={};e.isSupported=typeof Se=="function"&&y&&typeof y.createHTMLDocument<"u"&&f!==9;var b=As,C=ks,g=Ds,O=Ls,j=Rs,te=Os,U=xs,w=null,Oe=p({},[].concat(V(Pt),V(nt),V(lt),V(ct),V(zt))),A=null,Fe=p({},[].concat(V($t),V(dt),V(Nt),V(Me))),S=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ce=null,Ce=null,de=!0,we=!0,Pe=!1,se=!1,Z=!1,Te=!1,Ee=!1,X=!1,fe=!1,pe=!1,Ae=!0,vt=!1,Kt="user-content-",Ke=!0,ke=!1,ge={},ve=null,yt=p({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),bt=null,_t=p({},["audio","video","img","source","image","track"]),Je=null,St=p({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Qe="http://www.w3.org/1998/Math/MathML",et="http://www.w3.org/2000/svg",re="http://www.w3.org/1999/xhtml",ze=re,tt=!1,ye,Jt=["application/xhtml+xml","text/html"],Qt="text/html",k,be=null,es=a.createElement("form"),Ct=function(i){return i instanceof RegExp||i instanceof Function},st=function(i){be&&be===i||((!i||ne(i)!=="object")&&(i={}),i=ue(i),ye=Jt.indexOf(i.PARSER_MEDIA_TYPE)===-1?ye=Qt:ye=i.PARSER_MEDIA_TYPE,k=ye==="application/xhtml+xml"?function(n){return n}:je,w="ALLOWED_TAGS"in i?p({},i.ALLOWED_TAGS,k):Oe,A="ALLOWED_ATTR"in i?p({},i.ALLOWED_ATTR,k):Fe,Je="ADD_URI_SAFE_ATTR"in i?p(ue(St),i.ADD_URI_SAFE_ATTR,k):St,bt="ADD_DATA_URI_TAGS"in i?p(ue(_t),i.ADD_DATA_URI_TAGS,k):_t,ve="FORBID_CONTENTS"in i?p({},i.FORBID_CONTENTS,k):yt,ce="FORBID_TAGS"in i?p({},i.FORBID_TAGS,k):{},Ce="FORBID_ATTR"in i?p({},i.FORBID_ATTR,k):{},ge="USE_PROFILES"in i?i.USE_PROFILES:!1,de=i.ALLOW_ARIA_ATTR!==!1,we=i.ALLOW_DATA_ATTR!==!1,Pe=i.ALLOW_UNKNOWN_PROTOCOLS||!1,se=i.SAFE_FOR_TEMPLATES||!1,Z=i.WHOLE_DOCUMENT||!1,X=i.RETURN_DOM||!1,fe=i.RETURN_DOM_FRAGMENT||!1,pe=i.RETURN_TRUSTED_TYPE||!1,Ee=i.FORCE_BODY||!1,Ae=i.SANITIZE_DOM!==!1,vt=i.SANITIZE_NAMED_PROPS||!1,Ke=i.KEEP_CONTENT!==!1,ke=i.IN_PLACE||!1,U=i.ALLOWED_URI_REGEXP||U,ze=i.NAMESPACE||re,i.CUSTOM_ELEMENT_HANDLING&&Ct(i.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(S.tagNameCheck=i.CUSTOM_ELEMENT_HANDLING.tagNameCheck),i.CUSTOM_ELEMENT_HANDLING&&Ct(i.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(S.attributeNameCheck=i.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),i.CUSTOM_ELEMENT_HANDLING&&typeof i.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(S.allowCustomizedBuiltInElements=i.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),se&&(we=!1),fe&&(X=!0),ge&&(w=p({},V(zt)),A=[],ge.html===!0&&(p(w,Pt),p(A,$t)),ge.svg===!0&&(p(w,nt),p(A,dt),p(A,Me)),ge.svgFilters===!0&&(p(w,lt),p(A,dt),p(A,Me)),ge.mathMl===!0&&(p(w,ct),p(A,Nt),p(A,Me))),i.ADD_TAGS&&(w===Oe&&(w=ue(w)),p(w,i.ADD_TAGS,k)),i.ADD_ATTR&&(A===Fe&&(A=ue(A)),p(A,i.ADD_ATTR,k)),i.ADD_URI_SAFE_ATTR&&p(Je,i.ADD_URI_SAFE_ATTR,k),i.FORBID_CONTENTS&&(ve===yt&&(ve=ue(ve)),p(ve,i.FORBID_CONTENTS,k)),Ke&&(w["#text"]=!0),Z&&p(w,["html","head","body"]),w.table&&(p(w,["tbody"]),delete ce.tbody),M&&M(i),be=i)},wt=p({},["mi","mo","mn","ms","mtext"]),Tt=p({},["foreignobject","desc","title","annotation-xml"]),ts=p({},["title","style","font","a","script"]),$e=p({},nt);p($e,lt),p($e,Ts);var at=p({},ct);p(at,Es);var ss=function(i){var n=Se(i);(!n||!n.tagName)&&(n={namespaceURI:re,tagName:"template"});var c=je(i.tagName),v=je(n.tagName);return i.namespaceURI===et?n.namespaceURI===re?c==="svg":n.namespaceURI===Qe?c==="svg"&&(v==="annotation-xml"||wt[v]):!!$e[c]:i.namespaceURI===Qe?n.namespaceURI===re?c==="math":n.namespaceURI===et?c==="math"&&Tt[v]:!!at[c]:i.namespaceURI===re?n.namespaceURI===et&&!Tt[v]||n.namespaceURI===Qe&&!wt[v]?!1:!at[c]&&(ts[c]||!$e[c]):!1},ae=function(i){Le(e.removed,{element:i});try{i.parentNode.removeChild(i)}catch{try{i.outerHTML=ee}catch{i.remove()}}},it=function(i,n){try{Le(e.removed,{attribute:n.getAttributeNode(i),from:n})}catch{Le(e.removed,{attribute:null,from:n})}if(n.removeAttribute(i),i==="is"&&!A[i])if(X||fe)try{ae(n)}catch{}else try{n.setAttribute(i,"")}catch{}},Et=function(i){var n,c;if(Ee)i="<remove></remove>"+i;else{var v=_s(i,/^[\r\n\t ]+/);c=v&&v[0]}ye==="application/xhtml+xml"&&(i='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+i+"</body></html>");var H=P?P.createHTML(i):i;if(ze===re)try{n=new B().parseFromString(H,ye)}catch{}if(!n||!n.documentElement){n=y.createDocument(ze,"template",null);try{n.documentElement.innerHTML=tt?"":H}catch{}}var z=n.body||n.documentElement;return i&&c&&z.insertBefore(a.createTextNode(c),z.childNodes[0]||null),ze===re?E.call(n,Z?"html":"body")[0]:Z?n.documentElement:z},At=function(i){return l.call(i.ownerDocument||i,i,_.SHOW_ELEMENT|_.SHOW_COMMENT|_.SHOW_TEXT,null,!1)},as=function(i){return i instanceof W&&(typeof i.nodeName!="string"||typeof i.textContent!="string"||typeof i.removeChild!="function"||!(i.attributes instanceof L)||typeof i.removeAttribute!="function"||typeof i.setAttribute!="function"||typeof i.namespaceURI!="string"||typeof i.insertBefore!="function")},De=function(i){return ne(u)==="object"?i instanceof u:i&&ne(i)==="object"&&typeof i.nodeType=="number"&&typeof i.nodeName=="string"},ie=function(i,n,c){h[i]&&bs(h[i],function(v){v.call(e,n,c,be)})},kt=function(i){var n;if(ie("beforeSanitizeElements",i,null),as(i)||I(/[\u0080-\uFFFF]/,i.nodeName))return ae(i),!0;var c=k(i.nodeName);if(ie("uponSanitizeElement",i,{tagName:c,allowedTags:w}),i.hasChildNodes()&&!De(i.firstElementChild)&&(!De(i.content)||!De(i.content.firstElementChild))&&I(/<[/\w]/g,i.innerHTML)&&I(/<[/\w]/g,i.textContent)||c==="select"&&I(/<template/i,i.innerHTML))return ae(i),!0;if(!w[c]||ce[c]){if(!ce[c]&&Lt(c)&&(S.tagNameCheck instanceof RegExp&&I(S.tagNameCheck,c)||S.tagNameCheck instanceof Function&&S.tagNameCheck(c)))return!1;if(Ke&&!ve[c]){var v=Se(i)||i.parentNode,H=Xe(i)||i.childNodes;if(H&&v)for(var z=H.length,F=z-1;F>=0;--F)v.insertBefore(Re(H[F],!0),Ze(i))}return ae(i),!0}return i instanceof m&&!ss(i)||(c==="noscript"||c==="noembed")&&I(/<\/no(script|embed)/i,i.innerHTML)?(ae(i),!0):(se&&i.nodeType===3&&(n=i.textContent,n=oe(n,b," "),n=oe(n,C," "),i.textContent!==n&&(Le(e.removed,{element:i.cloneNode()}),i.textContent=n)),ie("afterSanitizeElements",i,null),!1)},Dt=function(i,n,c){if(Ae&&(n==="id"||n==="name")&&(c in a||c in es))return!1;if(!(we&&!Ce[n]&&I(g,n))){if(!(de&&I(O,n))){if(!A[n]||Ce[n]){if(!(Lt(i)&&(S.tagNameCheck instanceof RegExp&&I(S.tagNameCheck,i)||S.tagNameCheck instanceof Function&&S.tagNameCheck(i))&&(S.attributeNameCheck instanceof RegExp&&I(S.attributeNameCheck,n)||S.attributeNameCheck instanceof Function&&S.attributeNameCheck(n))||n==="is"&&S.allowCustomizedBuiltInElements&&(S.tagNameCheck instanceof RegExp&&I(S.tagNameCheck,c)||S.tagNameCheck instanceof Function&&S.tagNameCheck(c))))return!1}else if(!Je[n]){if(!I(U,oe(c,te,""))){if(!((n==="src"||n==="xlink:href"||n==="href")&&i!=="script"&&Ss(c,"data:")===0&&bt[i])){if(!(Pe&&!I(j,oe(c,te,"")))){if(c)return!1}}}}}}return!0},Lt=function(i){return i.indexOf("-")>0},xt=function(i){var n,c,v,H;ie("beforeSanitizeAttributes",i,null);var z=i.attributes;if(z){var F={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:A};for(H=z.length;H--;){n=z[H];var Ne=n,$=Ne.name,rt=Ne.namespaceURI;if(c=$==="value"?n.value:Cs(n.value),v=k($),F.attrName=v,F.attrValue=c,F.keepAttr=!0,F.forceKeepAttr=void 0,ie("uponSanitizeAttribute",i,F),c=F.attrValue,!F.forceKeepAttr&&(it($,i),!!F.keepAttr)){if(I(/\/>/i,c)){it($,i);continue}se&&(c=oe(c,b," "),c=oe(c,C," "));var Rt=k(i.nodeName);if(Dt(Rt,v,c)){if(vt&&(v==="id"||v==="name")&&(it($,i),c=Kt+c),P&&ne(Q)==="object"&&typeof Q.getAttributeType=="function"&&!rt)switch(Q.getAttributeType(Rt,v)){case"TrustedHTML":c=P.createHTML(c);break;case"TrustedScriptURL":c=P.createScriptURL(c);break}try{rt?i.setAttributeNS(rt,$,c):i.setAttribute($,c),Ft(e.removed)}catch{}}}}ie("afterSanitizeAttributes",i,null)}},is=function d(i){var n,c=At(i);for(ie("beforeSanitizeShadowDOM",i,null);n=c.nextNode();)ie("uponSanitizeShadowNode",n,null),!kt(n)&&(n.content instanceof r&&d(n.content),xt(n));ie("afterSanitizeShadowDOM",i,null)};return e.sanitize=function(d){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,c,v,H,z;if(tt=!d,tt&&(d="<!-->"),typeof d!="string"&&!De(d)){if(typeof d.toString!="function")throw ot("toString is not a function");if(d=d.toString(),typeof d!="string")throw ot("dirty is not a string, aborting")}if(!e.isSupported){if(ne(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof d=="string")return t.toStaticHTML(d);if(De(d))return t.toStaticHTML(d.outerHTML)}return d}if(Te||st(i),e.removed=[],typeof d=="string"&&(ke=!1),ke){if(d.nodeName){var F=k(d.nodeName);if(!w[F]||ce[F])throw ot("root node is forbidden and cannot be sanitized in-place")}}else if(d instanceof u)n=Et("<!---->"),c=n.ownerDocument.importNode(d,!0),c.nodeType===1&&c.nodeName==="BODY"||c.nodeName==="HTML"?n=c:n.appendChild(c);else{if(!X&&!se&&!Z&&d.indexOf("<")===-1)return P&&pe?P.createHTML(d):d;if(n=Et(d),!n)return X?null:pe?ee:""}n&&Ee&&ae(n.firstChild);for(var Ne=At(ke?d:n);v=Ne.nextNode();)v.nodeType===3&&v===H||kt(v)||(v.content instanceof r&&is(v.content),xt(v),H=v);if(H=null,ke)return d;if(X){if(fe)for(z=he.call(n.ownerDocument);n.firstChild;)z.appendChild(n.firstChild);else z=n;return A.shadowroot&&(z=R.call(s,z,!0)),z}var $=Z?n.outerHTML:n.innerHTML;return Z&&w["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&I(Fs,n.ownerDocument.doctype.name)&&($="<!DOCTYPE "+n.ownerDocument.doctype.name+`>
`+$),se&&($=oe($,b," "),$=oe($,C," ")),P&&pe?P.createHTML($):$},e.setConfig=function(d){st(d),Te=!0},e.clearConfig=function(){be=null,Te=!1},e.isValidAttribute=function(d,i,n){be||st({});var c=k(d),v=k(i);return Dt(c,v,n)},e.addHook=function(d,i){typeof i=="function"&&(h[d]=h[d]||[],Le(h[d],i))},e.removeHook=function(d){if(h[d])return Ft(h[d])},e.removeHooks=function(d){h[d]&&(h[d]=[])},e.removeAllHooks=function(){h={}},e}var $s=Gt();/*! medium-zoom 1.0.6 | MIT License | https://github.com/francoischalifour/medium-zoom */var me=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},He=function(e){return e.tagName==="IMG"},Ns=function(e){return NodeList.prototype.isPrototypeOf(e)},Be=function(e){return e&&e.nodeType===1},It=function(e){var s=e.currentSrc||e.src;return s.substr(-4).toLowerCase()===".svg"},Mt=function(e){try{return Array.isArray(e)?e.filter(He):Ns(e)?[].slice.call(e).filter(He):Be(e)?[e].filter(He):typeof e=="string"?[].slice.call(document.querySelectorAll(e)).filter(He):[]}catch{throw new TypeError(`The provided selector is invalid.
Expects a CSS selector, a Node element, a NodeList or an array.
See: https://github.com/francoischalifour/medium-zoom`)}},Is=function(e){var s=document.createElement("div");return s.classList.add("medium-zoom-overlay"),s.style.background=e,s},Ms=function(e){var s=e.getBoundingClientRect(),a=s.top,r=s.left,o=s.width,u=s.height,m=e.cloneNode(),_=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,D=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return m.removeAttribute("id"),m.style.position="absolute",m.style.top=a+_+"px",m.style.left=r+D+"px",m.style.width=o+"px",m.style.height=u+"px",m.style.transform="",m},_e=function(e,s){var a=me({bubbles:!1,cancelable:!1,detail:void 0},s);if(typeof window.CustomEvent=="function")return new CustomEvent(e,a);var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,a.bubbles,a.cancelable,a.detail),r},Hs=function t(e){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=window.Promise||function(f){function h(){}f(h,h)},r=function(f){var h=f.target;if(h===he){N();return}x.indexOf(h)!==-1&&Re({target:h})},o=function(){if(!(ee||!l.original)){var f=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(le-f)>y.scrollOffset&&setTimeout(N,150)}},u=function(f){var h=f.key||f.keyCode;(h==="Escape"||h==="Esc"||h===27)&&N()},m=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=f;if(f.background&&(he.style.background=f.background),f.container&&f.container instanceof Object&&(h.container=me({},y.container,f.container)),f.template){var b=Be(f.template)?f.template:document.querySelector(f.template);h.template=b}return y=me({},y,h),x.forEach(function(C){C.dispatchEvent(_e("medium-zoom:update",{detail:{zoom:E}}))}),E},_=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t(me({},y,f))},D=function(){for(var f=arguments.length,h=Array(f),b=0;b<f;b++)h[b]=arguments[b];var C=h.reduce(function(g,O){return[].concat(g,Mt(O))},[]);return C.filter(function(g){return x.indexOf(g)===-1}).forEach(function(g){x.push(g),g.classList.add("medium-zoom-image")}),P.forEach(function(g){var O=g.type,j=g.listener,te=g.options;C.forEach(function(U){U.addEventListener(O,j,te)})}),E},L=function(){for(var f=arguments.length,h=Array(f),b=0;b<f;b++)h[b]=arguments[b];l.zoomed&&N();var C=h.length>0?h.reduce(function(g,O){return[].concat(g,Mt(O))},[]):x;return C.forEach(function(g){g.classList.remove("medium-zoom-image"),g.dispatchEvent(_e("medium-zoom:detach",{detail:{zoom:E}}))}),x=x.filter(function(g){return C.indexOf(g)===-1}),E},W=function(f,h){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return x.forEach(function(C){C.addEventListener("medium-zoom:"+f,h,b)}),P.push({type:"medium-zoom:"+f,listener:h,options:b}),E},B=function(f,h){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return x.forEach(function(C){C.removeEventListener("medium-zoom:"+f,h,b)}),P=P.filter(function(C){return!(C.type==="medium-zoom:"+f&&C.listener.toString()===h.toString())}),E},Q=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=f.target,b=function(){var g={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},O=void 0,j=void 0;if(y.container)if(y.container instanceof Object)g=me({},g,y.container),O=g.width-g.left-g.right-y.margin*2,j=g.height-g.top-g.bottom-y.margin*2;else{var te=Be(y.container)?y.container:document.querySelector(y.container),U=te.getBoundingClientRect(),w=U.width,Oe=U.height,A=U.left,Fe=U.top;g=me({},g,{width:w,height:Oe,left:A,top:Fe})}O=O||g.width-y.margin*2,j=j||g.height-y.margin*2;var S=l.zoomedHd||l.original,ce=It(S)?O:S.naturalWidth||O,Ce=It(S)?j:S.naturalHeight||j,de=S.getBoundingClientRect(),we=de.top,Pe=de.left,se=de.width,Z=de.height,Te=Math.min(ce,O)/se,Ee=Math.min(Ce,j)/Z,X=Math.min(Te,Ee),fe=(-Pe+(O-se)/2+y.margin+g.left)/X,pe=(-we+(j-Z)/2+y.margin+g.top)/X,Ae="scale("+X+") translate3d("+fe+"px, "+pe+"px, 0)";l.zoomed.style.transform=Ae,l.zoomedHd&&(l.zoomedHd.style.transform=Ae)};return new a(function(C){if(h&&x.indexOf(h)===-1){C(E);return}var g=function w(){ee=!1,l.zoomed.removeEventListener("transitionend",w),l.original.dispatchEvent(_e("medium-zoom:opened",{detail:{zoom:E}})),C(E)};if(l.zoomed){C(E);return}if(h)l.original=h;else if(x.length>0){var O=x;l.original=O[0]}else{C(E);return}if(l.original.dispatchEvent(_e("medium-zoom:open",{detail:{zoom:E}})),le=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,ee=!0,l.zoomed=Ms(l.original),document.body.appendChild(he),y.template){var j=Be(y.template)?y.template:document.querySelector(y.template);l.template=document.createElement("div"),l.template.appendChild(j.content.cloneNode(!0)),document.body.appendChild(l.template)}if(document.body.appendChild(l.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),l.original.classList.add("medium-zoom-image--hidden"),l.zoomed.classList.add("medium-zoom-image--opened"),l.zoomed.addEventListener("click",N),l.zoomed.addEventListener("transitionend",g),l.original.getAttribute("data-zoom-src")){l.zoomedHd=l.zoomed.cloneNode(),l.zoomedHd.removeAttribute("srcset"),l.zoomedHd.removeAttribute("sizes"),l.zoomedHd.src=l.zoomed.getAttribute("data-zoom-src"),l.zoomedHd.onerror=function(){clearInterval(te),console.warn("Unable to reach the zoom image target "+l.zoomedHd.src),l.zoomedHd=null,b()};var te=setInterval(function(){l.zoomedHd.complete&&(clearInterval(te),l.zoomedHd.classList.add("medium-zoom-image--opened"),l.zoomedHd.addEventListener("click",N),document.body.appendChild(l.zoomedHd),b())},10)}else if(l.original.hasAttribute("srcset")){l.zoomedHd=l.zoomed.cloneNode(),l.zoomedHd.removeAttribute("sizes"),l.zoomedHd.removeAttribute("loading");var U=l.zoomedHd.addEventListener("load",function(){l.zoomedHd.removeEventListener("load",U),l.zoomedHd.classList.add("medium-zoom-image--opened"),l.zoomedHd.addEventListener("click",N),document.body.appendChild(l.zoomedHd),b()})}else b()})},N=function(){return new a(function(f){if(ee||!l.original){f(E);return}var h=function b(){l.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(l.zoomed),l.zoomedHd&&document.body.removeChild(l.zoomedHd),document.body.removeChild(he),l.zoomed.classList.remove("medium-zoom-image--opened"),l.template&&document.body.removeChild(l.template),ee=!1,l.zoomed.removeEventListener("transitionend",b),l.original.dispatchEvent(_e("medium-zoom:closed",{detail:{zoom:E}})),l.original=null,l.zoomed=null,l.zoomedHd=null,l.template=null,f(E)};ee=!0,document.body.classList.remove("medium-zoom--opened"),l.zoomed.style.transform="",l.zoomedHd&&(l.zoomedHd.style.transform=""),l.template&&(l.template.style.transition="opacity 150ms",l.template.style.opacity=0),l.original.dispatchEvent(_e("medium-zoom:close",{detail:{zoom:E}})),l.zoomed.addEventListener("transitionend",h)})},Re=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=f.target;return l.original?N():Q({target:h})},Ze=function(){return y},Xe=function(){return x},Se=function(){return l.original},x=[],P=[],ee=!1,le=0,y=s,l={original:null,zoomed:null,zoomedHd:null,template:null};Object.prototype.toString.call(e)==="[object Object]"?y=e:(e||typeof e=="string")&&D(e),y=me({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},y);var he=Is(y.background);document.addEventListener("click",r),document.addEventListener("keyup",u),document.addEventListener("scroll",o),window.addEventListener("resize",N);var E={open:Q,close:N,toggle:Re,update:m,clone:_,attach:D,detach:L,on:W,off:B,getOptions:Ze,getImages:Xe,getZoomedImage:Se};return E};function Ws(t,e){e===void 0&&(e={});var s=e.insertAt;if(!(!t||typeof document>"u")){var a=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",s==="top"&&a.firstChild?a.insertBefore(r,a.firstChild):a.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}var js=".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}";Ws(js);const Vt=Hs,Bs={messages:{en:{title:"Key Performance Indicators"}}},Us=Y({name:"TopsheetsFinder",i18n:Bs,components:{TopSheet:ns},props:{fileSystemConfig:{type:Object,required:!0},subfolder:{type:String,required:!0},files:{type:Array,required:!0}},computed:{fileApi(){return new qe(this.fileSystemConfig)}},data:()=>({allConfigFiles:{},topsheets:[]}),watch:{subfolder(){this.filesUpdated()},files(){this.filesUpdated()}},methods:{async findTopsheetsForThisFolder(){return this.allConfigFiles=await this.fileApi.findAllYamlConfigs(this.subfolder),Object.values(this.allConfigFiles.topsheets)},async filesUpdated(){this.files.length&&(this.topsheets=await this.findTopsheetsForThisFolder())}}});var Gs=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"topsheets-finder curate-content"},e._l(e.topsheets,function(a){return s("top-sheet",{key:a,attrs:{fileSystemConfig:e.fileSystemConfig,subfolder:e.subfolder,files:e.files,yaml:a,allConfigFiles:e.allConfigFiles}})}),1)},Vs=[];var qs=G(Us,Gs,Vs,!1,null,"2ec385c7",null,null);const qt=qs.exports,Ys={messages:{en:{Maps:"Maps",Images:"Images",Analysis:"Analysis",Files:"Files",Folders:"Folders",Topsheet:"Topsheet"},de:{Maps:"Karten",Images:"Bilder",Analysis:"Ergebnisse",Files:"Dateien",Folders:"Ordner",Topsheet:"Topsheet"}}},Zs={"":"#118860","aggregate-od":"#E98B52","vehicle-anim":"#330033","x-y-t":"#583270","carrier-viewer":"#c97A2C",events:"#4400ff",hexagons:"#900564","area-map":"#c94264",network:"#894654",sankey:"#D8A672",summary:"#2EA95B",transit:"#3B6FE4"},Xs=Y({name:"FolderBrowser",i18n:Ys,components:Object.assign({TopsheetsFinder:qt},gt),props:{root:{type:String,required:!0},allConfigFiles:{type:Object,required:!0},xsubfolder:String},data:()=>({globalState:T.state,summaryYamlFilename:"viz-summary.yml",mdRenderer:new Ye({html:!0,linkify:!0,typographer:!0}),myState:{errorStatus:"",folders:[],files:[],isLoading:!1,readme:"",svnProject:null,svnRoot:void 0,subfolder:"",vizes:[],summary:!1}}),computed:{vizImages(){const t={};for(let e=0;e<this.myState.vizes.length;e++)this.myState.vizes[e].component==="image-view"&&(t[e]=this.myState.vizes[e]);return t},vizMaps(){const t={};for(let e=0;e<this.myState.vizes.length;e++)this.myState.vizes[e].component!=="image-view"&&(t[e]=this.myState.vizes[e]);return t}},methods:{cleanName(t){return decodeURIComponent(t)},getFileSystem(t){const e=T.state.svnProjects.filter(s=>s.slug===t);if(e.length===0)throw console.log("no such project"),Error;return e[0]},generateBreadcrumbs(){if(!this.myState.svnProject)return[];const t=[{label:"SimWrapper",url:"/"},{label:this.myState.svnProject.name,url:"/"+this.myState.svnProject.slug}],e=this.myState.subfolder.split("/");let s="/";for(const a of e)a&&(s+=a+"/",t.push({label:a,url:"/"+this.myState.svnProject.slug+s}));return T.commit("setBreadCrumbs",t),t},clickedVisualization(t){const e=this.myState.vizes[t];if(e.component==="image-view"||!this.myState.svnProject)return;const s={root:this.myState.svnProject.slug,xsubfolder:this.myState.subfolder,subfolder:this.myState.subfolder,yamlConfig:e.config,thumbnail:!1};this.$emit("navigate",{component:e.component,props:s})},updateTitle(t,e){this.myState.vizes[t].title=e},async showReadme(){this.myState.readme="";const t="readme.md";if(this.myState.files.map(e=>e.toLocaleLowerCase()).indexOf(t)>-1){if(!this.myState.svnRoot)return;const e=await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+t);this.myState.readme=this.mdRenderer.render(e)}},buildShowEverythingView(){for(const t of this.globalState.visualizationTypes.values()){const e=K(this.myState.files,t.filePatterns,{nocase:!0});for(const s of e)this.myState.vizes.push({component:t.kebabName,config:s,title:".."})}},async buildCuratedSummaryView(){if(!this.myState.svnRoot)return;const t=Ge.parse(await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+this.summaryYamlFilename));for(const e of t.plugins){const s=this.globalState.visualizationTypes.get(e);if(s)if(t[s.kebabName])for(const a of t[s.kebabName]){const r=await this.findMatchingFiles(a);for(const o of r)this.myState.vizes.push({component:s.kebabName,config:o,title:o})}else{const a=K(this.myState.files,s.filePatterns);for(const r of a)this.myState.vizes.push({component:s.kebabName,config:r,title:".."})}}},async findMatchingFiles(t){if(this.myState.files.indexOf(t)>-1)return[t];const e=K(this.myState.files,t);if(e.length)return e;if(!this.myState.svnRoot)return[];try{const s=t.split("/"),a=this.myState.subfolder+"/"+s[0];console.log(a);const r=await this.myState.svnRoot.getDirectory(a);return K(r.files,s[1]).map(u=>s[0]+"/"+u)}catch{}return[]},async fetchFolderContents(){if(!this.myState.svnRoot)return[];this.myState.isLoading=!0,this.myState.errorStatus="",this.myState.files=[];try{const t=await this.myState.svnRoot.getDirectory(this.myState.subfolder),e=t.dirs.filter(o=>!o.startsWith(".")).sort(),s=t.files.filter(o=>!o.startsWith(".")).sort(),a=Object.assign({},this.allConfigFiles.vizes);for(const o of s)a[o]=o;const r=Object.values(a);this.myState.errorStatus="",this.myState.folders=e,this.myState.files=r}catch(t){const e=t;console.log("BAD PAGE"),console.log({eeee:e}),this.myState.folders=[],this.myState.files=[],this.myState.errorStatus="<h3>",e.status&&(this.myState.errorStatus+=`${e.status} `),e.statusText&&(this.myState.errorStatus+=`${e.statusText}`),this.myState.errorStatus==="<h3>"&&(this.myState.errorStatus+="Error"),this.myState.errorStatus+="</h3>",e.url&&(this.myState.errorStatus+=`<p>${e.url}</p>`),e.message&&(this.myState.errorStatus+=`<p>${e.message}</p>`),this.myState.errorStatus==="<h3>Error</h3>"&&(this.myState.errorStatus=""+e),this.myState.svnProject&&(this.myState.errorStatus+=`<p><i>${this.myState.svnProject.baseURL}${this.myState.subfolder}</i></p>`),this.myState.svnProject&&this.myState.svnProject.needPassword&&e.status===401&&T.commit("requestLogin",this.myState.svnProject.slug)}finally{this.myState.isLoading=!1}},openOutputFolder(t){if(this.myState.isLoading||!this.myState.svnProject)return;const e=t===".."?this.myState.subfolder.substring(0,this.myState.subfolder.lastIndexOf("/")):this.myState.subfolder+"/"+t,s={root:this.myState.svnProject.slug,xsubfolder:e};!e&&!this.myState.subfolder?this.$emit("navigate",{component:"SplashPage",props:{}}):this.$emit("navigate",{component:"TabbedDashboardView",props:s})},getTabColor(t){return{backgroundColor:Zs[t]||"#8778BB"}},updateRoute(){const t=this.getFileSystem(this.root);this.myState.svnProject=t,this.myState.subfolder=this.xsubfolder||"",this.myState.readme="",this.myState.svnProject&&(this.myState.svnRoot=new qe(this.myState.svnProject),this.generateBreadcrumbs(),this.fetchFolderContents())}},watch:{"globalState.colorScheme"(){this.fetchFolderContents()},xsubfolder(){this.updateRoute()},allConfigFiles(){this.updateRoute()},"globalState.authAttempts"(){console.log("AUTH CHANGED - Reload"),this.updateRoute()},async"myState.files"(){this.myState.vizes=[],this.myState.files.length!==0&&(this.showReadme(),this.myState.summary=this.myState.files.indexOf(this.summaryYamlFilename)!==-1,this.myState.summary?await this.buildCuratedSummaryView():this.buildShowEverythingView(),await this.$nextTick(),Vt(".medium-zoom",{background:"#444450"}))}},mounted(){this.updateRoute()}});var Ks=function(){var a,r;var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"folder-browser"},[e.myState.errorStatus?s("div",{staticClass:"stripe details"},[s("div",{staticClass:"vessel"},[s("div",{staticClass:"badnews",domProps:{innerHTML:e._s(e.myState.errorStatus)}})])]):s("div",{staticClass:"stripe details"},[s("div",{staticClass:"vessel"},[s("div",{staticClass:"curated-sections"},[s("b",{staticClass:"up-link"},[s("a",{on:{click:function(o){return e.$emit("up")}}},[e._v("^ UP")])]),s("div",{staticClass:"readme-header markdown"},[e.myState.readme?s("div",{staticClass:"curate-content markdown",domProps:{innerHTML:e._s(e.myState.readme)}}):e._e()]),e.myState.folders.length?s("h3",{staticClass:"curate-heading"},[e._v(" "+e._s(e.$t("Folders")))]):e._e(),e.myState.folders.length?s("div",{staticClass:"curate-content"},[s("div",{staticClass:"folder-table"},e._l(e.myState.folders,function(o){return s("div",{key:o.name,staticClass:"folder",class:{fade:e.myState.isLoading},on:{click:function(u){return e.openOutputFolder(o)}}},[s("p",[s("i",{staticClass:"fa fa-folder-open"}),e._v(" "+e._s(e.cleanName(o)))])])}),0)]):e._e(),Object.keys(e.vizMaps).length?s("div",{staticClass:"section-maps"},[s("h3",{staticClass:"curate-heading"},[e._v(e._s(e.$t("Maps")))]),s("div",{staticClass:"curate-content"},[s("div",{staticClass:"viz-table"},e._l(Object.entries(e.vizMaps),function([o,u]){return s("div",{key:o,staticClass:"viz-grid-item",on:{click:function(m){return e.clickedVisualization(o)}}},[s("div",{staticClass:"viz-frame"},[s("p",{staticClass:"v-title"},[s("b",[e._v(e._s(u.title))])]),s("p",{staticClass:"v-filename"},[e._v(e._s(u.config))]),s("p",{staticClass:"v-plugin",style:e.getTabColor(u.component)},[e._v(e._s(u.component||"dashboard"))]),s(u.component,{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],tag:"component",staticClass:"viz-frame-component",style:{"pointer-events":"none"},attrs:{root:e.myState.svnProject.slug,subfolder:e.myState.subfolder,yamlConfig:u.config,thumbnail:!0,fileApi:e.myState.svnRoot},on:{title:function(m){return e.updateTitle(o,m)}}})],1)])}),0)])]):e._e(),Object.keys(e.vizImages).length?s("div",{staticClass:"section-images"},[s("h3",{staticClass:"curate-heading"},[e._v(e._s(e.$t("Images")))]),s("div",{staticClass:"curate-content"},[s("div",{staticClass:"viz-image-table"},e._l(Object.entries(e.vizImages),function([o,u]){return s("div",{key:o,staticClass:"viz-image-grid-item",on:{click:function(m){return e.clickedVisualization(o)}}},[s("div",{staticClass:"viz-image-frame"},[s(u.component,{tag:"component",staticClass:"viz-image-frame-component",style:{"pointer-events":"auto"},attrs:{root:e.myState.svnProject.slug,subfolder:e.myState.subfolder,yamlConfig:u.config,thumbnail:!0,fileApi:e.myState.svnRoot},on:{title:function(m){return e.updateTitle(o,m)}}}),s("p",[e._v(e._s(u.title))])],1)])}),0)])]):e._e(),(r=(a=e.myState)==null?void 0:a.svnProject)!=null&&r.baseURL?s("div",{staticClass:"files-section"},[e.myState.files.length?s("h3",{staticClass:"curate-heading"},[e._v(e._s(e.$t("Files")))]):e._e(),e.myState.files.length?s("div",{staticClass:"curate-content"},[s("div",{staticClass:"file-table"},e._l(e.myState.files,function(o){return s("div",{key:o,staticClass:"file",class:{fade:e.myState.isLoading}},[s("a",{attrs:{href:`${e.myState.svnProject.baseURL}/${e.myState.subfolder}/${o}`}},[e._v(e._s(e.cleanName(o)))])])}),0)]):e._e()]):e._e()])])])])},Js=[];var Qs=G(Xs,Ks,Js,!1,null,"f281c271",null,null);const Yt=Qs.exports,ea=[".nodashboards","nodashboards","nodashboards.txt"],Ht=new Ye({html:!0,linkify:!0,typographer:!0}),ta=Y({name:"TabbedDashboardView",components:{DashBoard:os,FolderBrowser:Yt},props:{root:{type:String,required:!0},xsubfolder:{type:String,required:!0}},data:()=>({dashboards:[],dashboardDataManager:null,allConfigFiles:{dashboards:{},topsheets:{},vizes:{},configs:{}},isZoomed:!1,styleElement:null,loadErrorMessage:"",activeTab:"",pageHeader:"",folderReadme:"",header:"",footer:"",customCSS:"",dashboardTabWithDelay:"",showFooter:!1}),computed:{fileApi(){return new qe(this.fileSystem,T)},fileSystem(){const t=this.$store.state.svnProjects.filter(e=>e.slug===this.root);if(t.length===0)throw console.log("no such project"),Error;return t[0]},wiide(){return this.$store.state.isFullWidth},dashWidthCalculator(){return this.$store.state.dashboardWidth&&this.$store.state.isFullWidth?{maxWidth:this.$store.state.dashboardWidth}:{}}},watch:{root(){this.updateRoute()},xsubfolder(){this.updateRoute()}},methods:{clearStyles(){this.styleElement&&(document.getElementsByTagName("head")[0].removeChild(this.styleElement),this.styleElement=null)},getPageHeader(){return this.xsubfolder?this.xsubfolder.substring(1+this.xsubfolder.lastIndexOf("/")):this.fileSystem.name||this.root},onNavigate(t){this.$emit("navigate",t)},async getFolderReadme(){try{this.folderReadme="";const{files:t}=await this.fileApi.getDirectory(this.xsubfolder),e=t.filter(r=>r.toLocaleLowerCase()==="readme.md");if(!e.length)return;const s=await this.fileApi.getFileText(`${this.xsubfolder}/${e[0]}`),a=Ht.render(s);this.folderReadme=a}catch{this.folderReadme=""}},async findConfigsAndDashboards(){if(this.loadErrorMessage="",!this.fileApi)return[];await this.fileApi.getChromePermission(this.fileSystem.handle),this.getFolderReadme();try{this.allConfigFiles=await this.fileApi.findAllYamlConfigs(this.xsubfolder);const{files:t}=await this.fileApi.getDirectory(this.xsubfolder);let e=!0;if(ea.forEach(s=>{t.indexOf(s)>-1&&(e=!1)}),e)for(const s of Object.values(this.allConfigFiles.dashboards))mt.set(this.dashboards,s,{header:{tab:"..."}}),await this.initDashboard(s)||delete this.dashboards[s];if(mt.set(this.dashboards,"FILE__BROWSER",{header:{tab:"Files"}}),this.$route.query.tab)try{const s=parseInt(""+this.$route.query.tab)-1,a=Object.keys(this.dashboards)[s];this.activeTab=a||Object.keys(this.dashboards)[0]}catch{this.activeTab=Object.keys(this.dashboards)[0]}else this.activeTab=Object.keys(this.dashboards)[0];this.dashboardTabWithDelay=this.activeTab,await this.setupProjectConfig()}catch(t){console.warn({eeee:t}),this.fileSystem.handle?this.loadErrorMessage=`Click to grant access to folder "${this.fileSystem.handle.name}"`:this.loadErrorMessage=this.fileSystem.baseURL+"/"+this.xsubfolder+": Could not load"}},async setupProjectConfig(){if(Object.keys(this.allConfigFiles.configs).length)for(const t of Object.values(this.allConfigFiles.configs))try{const e=await this.fileApi.getFileText(t),s=Ge.parse(e),a=t.startsWith("http")?"":t.substring(0,t.indexOf("simwrapper-config.y"));s.hideLeftBar===!0&&this.$store.commit("setShowLeftBar",!1),s.hideLeftBar===!1&&this.$store.commit("setShowLeftBar",!0),this.$store.commit("setFullWidth",!!s.fullWidth),this.$store.commit("setDashboardWidth",""),s.width!==void 0&&(this.$store.commit("setDashboardWidth",""+s.width),this.$store.commit("setFullWidth",!0));try{s.css&&(this.customCSS=await this.fileApi.getFileText(`${a}${s.css}`),this.styleElement=document.createElement("style"),this.styleElement.appendChild(document.createTextNode(this.customCSS)),document.getElementsByTagName("head")[0].appendChild(this.styleElement))}catch{}this.header=await this.buildPanel("header",s,a),this.footer=await this.buildPanel("footer",s,a)}catch(e){console.error(""+e)}},handleRemoveDashboard(){},async buildPanel(t,e,s){let a="";if(this.$store.state.locale==="de"?a=e[t+"_de"]||e[t]||e[t+"_en"]||"":a=e[t+"_en"]||e[t]||e[t+"_de"]||"",!a)return"";a.indexOf(`
`)==-1&&a.endsWith(".md")&&(a=await this.fileApi.getFileText(`${s}${a}`));const r=Ht.render(a);return $s.sanitize(r,{USE_PROFILES:{html:!0}})},async initDashboard(t){var e;try{const s=await this.fileApi.getFileText(t),a=Ge.parse(s);if((e=a.header)!=null&&e.triggerPattern){const{files:o,dirs:u}=await this.fileApi.getDirectory(this.xsubfolder),m=[...o,...u];if(K.match(m,a.header.triggerPattern).length===0)return!1}const r=t.substring(0,t.lastIndexOf("."));return a.header||(a.header={title:t,tab:r}),a.header.tab||(a.header.tab=a.header.title||r),this.dashboards[t]=a,console.log("DASHBOARD:",t),!0}catch(s){return this.$store.commit("setStatus",{type:rs.ERROR,msg:""+s}),!1}},updateRoute(){this.clearStyles(),this.dashboardDataManager&&this.dashboardDataManager.clearCache(),this.dashboardDataManager=new ls(this.root,this.xsubfolder),this.header="",this.footer="",this.dashboards=[],this.pageHeader=this.getPageHeader(),this.findConfigsAndDashboards()},async switchTab(t,e){t!==this.activeTab&&(this.activeTab="",this.dashboardTabWithDelay="",this.showFooter=!1,await this.$nextTick(),this.activeTab=t,setTimeout(()=>{this.dashboardTabWithDelay=t,e?this.$router.replace({query:{tab:`${e+1}`}}):this.$router.replace({query:{}})},125))},handleZoom(t){this.isZoomed=!!t,this.$emit("zoom",this.isZoomed)},handleLayoutComplete(){this.showFooter=!0},getFileSystem(t){const e=this.$store.state.svnProjects.filter(s=>s.slug===t);return e.length===0?(console.warn("no such project"),this.loadErrorMessage=`Can't locate "${t}": please check running services and browser version.`,null):e[0]},goUpOneFolder(){let t=this.xsubfolder;this.xsubfolder.endsWith("/")&&(t=this.xsubfolder.slice(0,length-1)),t=t.substring(0,t.lastIndexOf("/"));const e={root:this.fileSystem.slug,xsubfolder:t};!t&&!this.xsubfolder?this.onNavigate({component:"SplashPage",props:{}}):this.onNavigate({component:"TabbedDashboardView",props:e})},async authorizeAfterError(){try{const t=this.fileSystem.handle;t&&await t.requestPermission({mode:"read"})==="granted"&&this.updateRoute()}catch{}},setTitle(){const t=this.xsubfolder.startsWith("/")?this.xsubfolder.slice(1):this.xsubfolder,e=`${this.fileSystem.name}: ${t}`;this.$emit("title",e)}},mounted(){this.updateRoute(),this.setTitle()},beforeDestroy(){this.dashboardDataManager&&this.dashboardDataManager.clearCache(),this.clearStyles()}});var sa=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"tabbed-folder-view"},[s("div",{staticClass:"centered-vessel",class:{wiide:e.wiide}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isZoomed,expression:"!isZoomed"}],staticClass:"tabholder",style:e.dashWidthCalculator},[s("div",{staticClass:"tabholdercontainer"},[e.header?s("div",{staticClass:"project-header",domProps:{innerHTML:e._s(e.header)}}):e._e(),s("div",{staticClass:"tabs is-centered"},[s("ul",{staticStyle:{"margin-right":"1rem"}},e._l(Object.keys(e.dashboards),function(a,r){return s("li",{key:a,class:{"is-active":a===e.activeTab,"is-not-active":a!==e.activeTab},style:{opacity:a===e.activeTab?1:.5}},[s("b",[e.dashboards[a].header?s("a",{on:{click:function(o){return e.switchTab(a,r)}}},[e._v(e._s(e.dashboards[a].header.tab))]):e._e()])])}),0)])])]),e.dashboardTabWithDelay&&e.dashboardTabWithDelay!=="FILE__BROWSER"&&e.dashboards[e.dashboardTabWithDelay]&&e.dashboards[e.dashboardTabWithDelay].header.tab!=="..."?s("dash-board",{attrs:{root:e.root,xsubfolder:e.xsubfolder,config:e.dashboards[e.dashboardTabWithDelay],datamanager:e.dashboardDataManager,zoomed:e.isZoomed,allConfigFiles:e.allConfigFiles},on:{zoom:e.handleZoom,layoutComplete:e.handleLayoutComplete}}):e._e(),e.dashboardTabWithDelay&&e.dashboardTabWithDelay==="FILE__BROWSER"?s("folder-browser",{attrs:{root:e.root,xsubfolder:e.xsubfolder,allConfigFiles:e.allConfigFiles},on:{navigate:e.onNavigate,up:function(a){return e.goUpOneFolder()}}}):e._e(),s("p",{directives:[{name:"show",rawName:"v-show",value:e.loadErrorMessage,expression:"loadErrorMessage"}],staticClass:"load-error",on:{click:e.authorizeAfterError}},[s("b",[e._v(e._s(e.loadErrorMessage))])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showFooter&&!e.isZoomed,expression:"showFooter && !isZoomed"}],staticClass:"tabholder",class:{wiide:e.wiide},style:e.dashWidthCalculator},[s("div",{staticClass:"tabholdercontainer",class:{wiide:e.wiide}},[e.footer?s("div",{staticClass:"project-footer",class:{wiide:e.wiide},domProps:{innerHTML:e._s(e.footer)}}):e._e()])])],1)])},aa=[];var ia=G(ta,sa,aa,!1,null,"169927c7",null,null);const ra=ia.exports,oa=Y({name:"FileSystemComponents",data:()=>({sources:[]}),mounted(){this.sources=T.state.svnProjects.filter(t=>!t.hidden&&!t.slug.startsWith("fs"))},methods:{openProjectPage(t){const e=Object.assign({},t);e.component="TabbedDashboardView",e.props={root:t.slug,xsubfolder:""},this.$emit("navigate",e)},openProjectTab(t){window.open(t,"_blank")}}});var na=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"svn-projects"},e._l(e.sources,function(a){return s("div",{key:a.url,staticClass:"project",on:{click:[function(r){return e.openProjectPage(a)},function(r){return r.metaKey?e.openProjectTab(a):null},function(r){return r.ctrlKey?e.openProjectTab(a):null}],mouseup:function(r){return"button"in r&&r.button!==1?null:e.openProjectTab(a)}}},[s("div",{staticClass:"desc"},[s("h3",[e._v(e._s(a.name))]),s("p",[e._v(e._s(a.description))])])])}),0)},la=[];var ca=G(oa,na,la,!1,null,"c18a2dce",null,null);const Zt=ca.exports,da={},ua={data(){return{frontmatter:da}}};var ma=function(){var e=this;return e._self._c,e._m(0)},ha=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"markdown-body"},[e("ul",[e("li",[e("p",[e("a",{attrs:{href:"https://simwrapper.github.io/docs"}},[t._v("Documentation and users guide")]),t._v(" including examples and getting started")])]),e("li",[e("p",[e("a",{attrs:{href:"https://github.com/simwrapper/simwrapper"}},[t._v("Source code")]),t._v(" available on Github")])])])])}],fa=G(ua,ma,ha,!1,null,null,null,null);const pa=fa.exports,ga={messages:{en:{"more-info":"Documentation:",tagLine:"the simulation browser and data visualizer from TU&nbsp;Berlin.",privacy:`SimWrapper is a client-side app, which means there is no upstream server collecting or storing data.

SimWrapper does not collect, handle or process any data about you while you use the site. SimWrapper does not contain any tracking devices or analytics software. No user cookies are stored or transmitted.`},de:{"more-info":"Für weitere Informationen:",tagLine:"Der Modellergebnis-Browser der TU Berlin."}}},Wt="/sandbox/",va=[{url:"https://vsp.berlin/en/",image:"vsp-logo-300dpi.png",name:"VSP TU-Berlin"},{url:"https://matsim.org/",image:"matsim-logo-blue.png",name:"MATSim"},{url:"https://tu.berlin",image:"tu-logo.png",name:"TU Berlin"},{url:"https://bmbf.de",image:"bmbf-logo.png",name:"German Federal BMBF"},{url:"https://www.sfcta.org/",image:"sfcta.png",name:"SFCTA"},{url:"https://metrocouncil.org/",image:"metcouncil.png",name:"Met Council"},{url:"http://www.sandag.org/",image:"sandag.jpg",name:"SANDAG"},{url:"https://mtc.ca.gov/",image:"mtc.png",name:"MTC"},{url:"https://www.psrc.org/",image:"psrc.png",name:"Puget Sound Regional Council"},{url:"https://www.mwcog.org/",image:"mwcog.png",name:"MWCOG"},{url:"https://www.oregon.gov/ODOT",image:"oregondot.png",name:"Oregon DOT"},{url:"https://atlantaregional.org/",image:"arc.png",name:"ARC"},{url:"https://www.transportation.ohio.gov/",image:"ohiodot.png",name:"Ohio DOT"},{url:"http://semcog.org/",image:"semcog.jpg",name:"SEMCOG"}],ya=Y({name:"SplashPage",i18n:ga,components:{FileSystemProjects:Zt,InfoBottom:pa},data:()=>({state:T.state,allRoots:[]}),computed:{allLogos(){return va.map(t=>({url:t.url,image:`${Wt}images/logos/${t.image}`}))},isChrome(){return!!window.showDirectoryPicker},localFileHandles(){return this.$store.state.localFileHandles.concat().sort((t,e)=>parseInt(t.key.substring(2))<parseInt(e.key.substring(2))?-1:1)}},methods:{onNavigate(t){this.$emit("navigate",t)},updateShortcuts(){const t=this.state.svnProjects.filter(e=>!e.hidden&&!e.slug.startsWith("fs"));this.allRoots=t},configureSources(){this.$emit("activate",{name:"Settings",class:"SettingsPanel"})},clickedOnFolder(t){const{folder:e,root:s,i:a}=t;let r=`${s}`;e&&(r+=`/${e}`),this.$router.push(r)},async clickedBrowseChromeLocalFolder(t){try{const e=await t.handle.requestPermission({mode:"read"});if(console.log(t.handle,e),e!=="granted")return;jt.find(r=>r.slug==t.key)||Ue(t.handle,t.key);const a={root:t.key};this.clickedOnFolder(a)}catch(e){console.error(""+e)}},async showChromeDirectory(){try{const e=await window.showDirectoryPicker(),s=Ue(e,null);this.$router.push(`${Wt}${s}/`)}catch{}},async clickedDelete(t){const s=this.$store.state.localFileHandles.filter(a=>a.key!==t.key);await Bt("fs",s),this.$store.commit("setLocalFileSystem",s)}},mounted(){if(!this.state.breadcrumbs.length){const t=[{label:"SimWrapper",url:"/"}];T.commit("setBreadCrumbs",t)}this.updateShortcuts()}}),ba="/sandbox/assets/SW_logo_yellow-abf06ffb.png",_a="/sandbox/assets/SW_logo_purple-175fca9f.png";var Sa=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"splash-page"},[s("div",{staticClass:"scrolly"},[s("div",{staticClass:"thing-area"},[s("div",{staticClass:"top-area"},[s("div",{staticClass:"simwrapper-logo"},[e.state.isDarkMode?s("img",{attrs:{src:ba}}):s("img",{attrs:{src:_a}})])]),s("div",{staticClass:"middle-area"},[e.isChrome?s("div",{staticClass:"is-chrome"},[s("h3",[e._v("Local Folders")]),e.localFileHandles.length?e._e():s("p",[e._v("Chrome & Edge can browse folders directly:")]),s("div",{staticClass:"roots"},e._l(e.localFileHandles,function(a){return s("div",{key:a.key,staticClass:"project-root local",on:{click:function(r){return e.clickedBrowseChromeLocalFolder(a)}}},[s("h5",{staticClass:"remove-local",staticStyle:{flex:"1"}},[e._v(e._s(a.handle.name)),s("i",{staticClass:"fa fa-times",on:{click:function(r){return r.stopPropagation(),e.clickedDelete(a)}}})]),s("p",[e._v("Local folder")])])}),0),s("p",{staticClass:"config-sources"},[s("a",{on:{click:e.showChromeDirectory}},[e._v("Add local folder...")])])]):e._e(),s("h3",{staticStyle:{"margin-top":"1rem"}},[e._v("Browse Data Sources")]),s("div",{staticClass:"roots"},e._l(e.allRoots,function(a){return s("div",{key:a.slug,staticClass:"project-root",on:{click:function(r){return e.clickedOnFolder({root:a.slug})}}},[s("h5",[e._v(e._s(a.name))]),s("p",[e._v(e._s(a.description))])])}),0),s("p",{staticClass:"config-sources"},[s("a",{on:{click:e.configureSources}},[e._v("Edit data sources...")])]),s("p",{staticClass:"funding"},[e._v("Funded by TU Berlin, the German Bundesministerium für Bildung und Forschung, and the ActivitySim Consortium member agencies.")]),e._m(0),e._m(1)])]),s("div",{staticClass:"links-and-logos"},[s("div",{staticClass:"logos"},e._l(e.allLogos,function(a){return s("a",{attrs:{href:a.url,title:a.name,target:"_blank"}},[s("img",{staticClass:"img-logo",attrs:{src:a.image}})])}),0)])])])},Ca=[function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"legal"},[e("p",[t._v("SimWrapper is open source and available on "),e("a",{attrs:{href:"https://github.com/simwrapper/simwrapper"}},[t._v("GitHub.")])])])},function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"legal"},[e("p",[e("a",{attrs:{href:"https://vsp.berlin/en/",target:"_blank"}},[t._v("VSP TU Berlin")]),e("a",{attrs:{href:"https://vsp.berlin/impressum/",target:"_blank"}},[t._v("Impressum")]),e("a",{attrs:{href:"https://www.vsp.tu-berlin.de/menue/service/privacy/parameter/en/",target:"_blank"}},[t._v("Privacy")])])])}];var wa=G(ya,Sa,Ca,!1,null,"d8d04bba",null,null);const Ta=wa.exports,Ea="/sandbox/assets/files-911c3024.svg",Aa="/sandbox/assets/issues-ff4b6076.svg",ka="/sandbox/assets/settings-6e19bc2b.svg",Da="/sandbox/assets/readme-bff70382.svg",La="https://simwrapper.github.io/docs",xa=Y({name:"LeftIconPanel",props:{activeSection:{type:String,required:!0}},data:()=>({state:T.state,topSections:[{name:"Files",class:"BrowserPanel",icon:Ea},{name:"Issues",class:"ErrorPanel",icon:Aa,colorize:!0}],bottomSections:[{name:"Docs",link:La,icon:Da},{name:"Settings",class:"SettingsPanel",icon:ka}]}),computed:{issueColor(){return this.state.statusErrors.length?"invert(60%) sepia(100%) hue-rotate(310deg) saturate(8.5)":this.state.statusWarnings.length?"invert(75%) sepia(100%) hue-rotate(15deg) saturate(5.5)":"invert(100%)"}},methods:{select(t){this.$emit("activate",t)},buttonStyle(t){const e=this.state.statusErrors.length||this.state.statusWarnings.length?.8:.4;return this.activeSection!==t.name?{opacity:t.colorize?e:.4}:{opacity:1,borderLeft:"3px solid white"}}}});var Ra=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"left-nav-panel"},[s("div",{staticClass:"top"},e._l(e.topSections,function(a){return s("button",{key:a.name,staticClass:"item",style:e.buttonStyle(a),on:{click:function(r){return e.select(a)}}},[s("img",{staticClass:"svg-icon",style:{filter:a.colorize?e.issueColor:"invert(100%)"},attrs:{src:a.icon,draggable:!1}}),s("p",[e._v(e._s(a.name))])])}),0),s("div",{staticClass:"bottom"},e._l(e.bottomSections,function(a){return s("button",{key:a.name,staticClass:"item",style:e.buttonStyle(a),on:{click:function(r){return e.select(a)}}},[s("img",{staticClass:"svg-icon",style:{filter:a.colorize?e.issueColor:"invert(100%)"},attrs:{src:a.icon,draggable:!1}}),s("p",[e._v(e._s(a.name))])])}),0)])},Oa=[];var Fa=G(xa,Ra,Oa,!1,null,"dc3aef3e",null,null);const Pa=Fa.exports,za={messages:{en:{sync:"Sync folders",theme:"Light/Dark",lang:"EN/DE",split:"Split view"},de:{sync:"Sync",theme:"Hell/Dunkel",lang:"DE/EN",split:"Aufteilen"}}},$a=Y({name:"ErrorPanel",i18n:za,data:()=>({state:T.state,showDescription:!1,descriptionIndexListWarning:[],descriptionIndexListError:[],isError:!1}),watch:{"$route.path"(){this.clearAllButtons()}},computed:{headerTextColor(){let t={};return this.state.statusWarnings.length&&(t={color:"#fe8"}),this.state.statusErrors.length&&(t={color:"#f66"}),t}},methods:{cleanError(t){return t?t.startsWith("Error: ")?t.slice(7):t:""},clearAllButtons(){this.$store.commit("clearAllErrors"),this.$emit("activate",{name:"Files",class:"BrowserPanel",onlyIfVisible:!0})},toggleShowDescription(t,e){if(this.isError=e,e)if(this.descriptionIndexListError.includes(t)){var s=this.descriptionIndexListError.indexOf(t);this.descriptionIndexListError.splice(s,1)}else this.descriptionIndexListError.push(t);else if(this.descriptionIndexListWarning.includes(t)){var s=this.descriptionIndexListWarning.indexOf(t);this.descriptionIndexListWarning.splice(s,1)}else this.descriptionIndexListWarning.push(t)}}});var Na=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"panel"},[s("div",{staticClass:"top-panel"},[s("h4",{style:e.headerTextColor},[e._v("Issues")]),s("div",{staticClass:"warnings"},[!e.state.statusErrors.length&&!e.state.statusWarnings.length?s("div",{staticClass:"no-error"},[s("p",{staticClass:"check"},[e._v("☑️")]),s("p",[e._v("No issues for this page.")])]):s("div",{staticClass:"message-area"},[e.state.statusErrors.length?s("h3",[e._v("Errors: "+e._s(e.state.statusErrors.length))]):e._e(),e._l(e.state.statusErrors,function(a,r){return s("div",{staticClass:"single-message"},[s("p",{domProps:{innerHTML:e._s(e.cleanError(a.msg))},on:{click:function(o){return e.toggleShowDescription(r,!0)}}}),e.descriptionIndexListError.includes(r)?s("div",{staticClass:"description"},[s("p",{domProps:{innerHTML:e._s(a.desc)}})]):e._e()])}),e.state.statusWarnings.length?s("h3",[e._v("Warnings: "+e._s(e.state.statusWarnings.length))]):e._e(),e._l(e.state.statusWarnings,function(a,r){return s("div",{staticClass:"single-message"},[s("p",{domProps:{innerHTML:e._s(a.msg)},on:{click:function(o){return e.toggleShowDescription(r,!1)}}}),e.descriptionIndexListWarning.includes(r)?s("div",{staticClass:"description"},[s("p",{domProps:{innerHTML:e._s(a.desc)}})]):e._e()])})],2)])]),s("div",{staticClass:"bottom-panel"},[e.state.statusErrors.length||e.state.statusWarnings.length?s("b-button",{staticClass:"clear-button",attrs:{expanded:""},on:{click:function(a){return e.clearAllButtons()}}},[e._v("Clear all messages")]):e._e()],1)])},Ia=[];var Ma=G($a,Na,Ia,!1,null,"aef5f931",null,null);const Ha=Ma.exports,Wa=`
Add a local shortcut for any URL-based resource.
SimWrapper requires several server settings, including:

- Open access (no login)
- File and directory listings
-  CORS "Access-Control-Allow-Origin"
`,ja=Y({name:"AddDataSource",props:{},data:()=>({labelField:"",urlField:"",noteField:"",notes:"",mdParser:new Ye}),mounted(){this.notes=this.mdParser.render(Wa)},watch:{labelField(){this.fixField()}},computed:{isValidURL(){return!(!this.labelField||!this.urlField||!this.urlField.startsWith("http"))}},methods:{addURL(){this.fixField(),console.log("Adding",this.labelField,this.urlField);const t="projectShortcuts";try{let e=localStorage.getItem(t)||"{}",s=JSON.parse(e);s[this.labelField]={name:`${this.labelField}`,slug:`${this.labelField}`,description:this.noteField,baseURL:this.urlField},console.log("NEW ROOTS",s),localStorage.setItem(t,JSON.stringify(s)),T.commit("setURLShortcuts",s)}catch(e){console.error(""+e)}},fixField(){this.labelField=this.labelField.toLowerCase().replaceAll(/[^a-z\-0-9@]*/g,"")}}});var Ba=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"add-data"},[s("div",{staticClass:"add"},[s("div",{staticClass:"markdown",domProps:{innerHTML:e._s(e.notes)}}),s("div",{staticClass:"flex-row"},[e._m(0),s("b-input",{staticClass:"flex5",attrs:{size:"is-small",placeholder:"e.g. server1",maxlength:"32"},model:{value:e.labelField,callback:function(a){e.labelField=a},expression:"labelField"}})],1),s("div",{staticClass:"flex-row"},[e._m(1),s("b-input",{staticClass:"flex5",attrs:{size:"is-small",placeholder:"http://localhost:8001",maxlength:"512"},model:{value:e.urlField,callback:function(a){e.urlField=a},expression:"urlField"}})],1),s("div",{staticClass:"flex-row"},[e._m(2),s("b-input",{staticClass:"flex5",attrs:{size:"is-small",placeholder:"optional",maxlength:"255"},model:{value:e.noteField,callback:function(a){e.noteField=a},expression:"noteField"}})],1),s("div",{staticClass:"flex-row"},[s("p",{staticClass:"flex1"},[e._v(" ")]),s("b-button",{staticClass:"is-primary",attrs:{size:"is-small",disabled:!e.isValidURL,type:e.isValidURL?"":"is-outlined"},on:{click:e.addURL}},[e._v("Add Data URL")])],1)])])},Ua=[function(){var t=this,e=t._self._c;return t._self._setupProxy,e("p",{staticClass:"flex1"},[e("b",[t._v("Label")])])},function(){var t=this,e=t._self._c;return t._self._setupProxy,e("p",{staticClass:"flex1"},[e("b",[t._v("URL")])])},function(){var t=this,e=t._self._c;return t._self._setupProxy,e("p",{staticClass:"flex1"},[e("b",[t._v("Note")])])}];var Ga=G(ja,Ba,Ua,!1,null,"218c231e",null,null);const Xt=Ga.exports,Va="/sandbox/",qa=[".nodashboards","nodashboards","nodashboards.txt"],Ya={messages:{en:{Maps:"Maps & Dashboards",Images:"Images",Analysis:"Analysis",Files:"Files",Folders:"Folders",Topsheet:"Table",privacy:`SimWrapper is a client-side app, which means there is no upstream server collecting or storing data.

SimWrapper does not collect, handle or process any data about you while you use the site. SimWrapper does not contain any tracking devices or analytics software. No user cookies are stored or transmitted.`},de:{Maps:"Karten",Images:"Bilder",Analysis:"Ergebnisse",Files:"Dateien",Folders:"Ordner",Topsheet:"Tabelle"}}},Za={"":"#118860","aggregate-od":"#E98B52","vehicle-anim":"#330033","x-y-t":"#583270",carriers:"#c97A2C",events:"#4400ff",hexagons:"#900564",map:"#c94264",network:"#894654",sankey:"#D8A672",summary:"#2EA95B",transit:"#3B6FE4"},Xa=Object.assign({AddDataSource:Xt,FileSystemProjects:Zt,TopsheetsFinder:qt},gt),Ka=Y({name:"BrowserPanel",i18n:Ya,components:Xa,data:()=>({globalState:T.state,subfolder:"/",root:"",summaryYamlFilename:"viz-summary.yml",highlightedViz:-2,needDoubleClickHint:!1,allConfigFiles:{dashboards:{},topsheets:{},vizes:{},configs:{}},allRoots:[],mdRenderer:new Ye({html:!0,linkify:!0,typographer:!0}),myState:{errorStatus:"",folders:[],files:[],isLoading:!1,readme:"",svnProject:null,svnRoot:void 0,subfolder:"",vizes:[],summary:!1},clicks:0,clickTimer:{}}),mounted(){this.setupHints(),this.updateShortcuts(),this.getRootAndRoute(this.$route.params.pathMatch)},watch:{"globalState.svnProjects"(){this.updateShortcuts()},"globalState.colorScheme"(){this.fetchFolderContents()},subfolder(){this.updateRoute()},"globalState.authAttempts"(){this.authenticationChanged()},"myState.files"(){this.filesChanged()}},computed:{hasDashboards(){return!!Object.keys(this.allConfigFiles.dashboards).length},vizImages(){const t={};for(let e=0;e<this.myState.vizes.length;e++)this.myState.vizes[e].component==="image-view"&&(t[e]=this.myState.vizes[e]);return t},vizMaps(){const t=["image-view","dashboard"],e=new Map;this.hasDashboards&&e.set(-1,{component:"",title:"Dashboard Panel"});for(let s=0;s<this.myState.vizes.length;s++)t.includes(this.myState.vizes[s].component)||e.set(s,this.myState.vizes[s]);return e},isChrome(){return!!window.showDirectoryPicker},localFileHandles(){return this.$store.state.localFileHandles.concat().sort((t,e)=>parseInt(t.key.substring(2))<parseInt(e.key.substring(2))?-1:1)}},methods:{updateRoute(){if(!this.root)return;const t=this.getFileSystem(this.root);this.myState.svnProject=t,this.myState.subfolder=this.subfolder||"",this.myState.readme="",this.highlightedViz=-2,this.myState.svnProject&&(this.myState.svnRoot=new qe(this.myState.svnProject,T),this.generateBreadcrumbs(),this.fetchFolderContents())},authenticationChanged(){console.log("AUTH CHANGED - Reload"),this.updateRoute()},async filesChanged(){this.myState.vizes=[],this.myState.files.length!==0&&(this.showReadme(),this.myState.summary=this.myState.files.indexOf(this.summaryYamlFilename)!==-1,this.myState.summary?await this.buildCuratedSummaryView():this.buildShowEverythingView(),await this.$nextTick(),Vt(".medium-zoom",{background:"#444450"}))},updateShortcuts(){const t=this.globalState.svnProjects.filter(e=>!e.hidden&&!e.slug.startsWith("fs"));this.allRoots=t},cleanName(t){return decodeURIComponent(t)},getFileSystem(t){const e=T.state.svnProjects.filter(s=>s.slug===t);if(e.length===0)throw console.log("no such project"),Error;return e[0]},generateBreadcrumbs(){if(!this.myState.svnProject)return[];const t=[{label:"SimWrapper",url:"/"},{label:this.myState.svnProject.name,url:"/"+this.myState.svnProject.slug}],e=this.myState.subfolder.split("/");let s="/";for(const a of e)a&&(s+=a+"/",t.push({label:a,url:"/"+this.myState.svnProject.slug+s}));return T.commit("setBreadCrumbs",t),t},setupHints(){let t=localStorage.getItem("needsClickHint");t?t=JSON.parse(t):t=0,t>5e3?this.needDoubleClickHint=!1:(t++,localStorage.setItem("needsClickHint",JSON.stringify(t)))},clickedBreadcrumb(t){this.getRootAndRoute(t.url.slice(1))},getRootAndRoute(t){if(!t)return;if(t==="/"){this.root="";return}if(t.startsWith("split/")){console.log("SPLIT"),t.substring(6);return}let e=t,s="";const a=t.indexOf("/");a>-1&&(e=t.substring(0,a),s=t.substring(a+1)),this.root=e,this.subfolder=s},activateVisualization(t){const e=this.myState.vizes[t]||{component:"TabbedDashboardView",title:"Dashboard"};if(e.component==="image-view"||!this.myState.svnProject)return;this.highlightedViz=-2;const s=this.myState.subfolder.replaceAll("//","/"),a={root:this.myState.svnProject.slug,xsubfolder:s,subfolder:s,yamlConfig:e.config,thumbnail:!1};this.$emit("navigate",{component:e.component,props:a})},updateTitle(t,e){this.myState.vizes[t].title=e},configureSources(){this.$emit("activate",{name:"Settings",class:"SettingsPanel"})},getTabColor(t){return{backgroundColor:Za[t]||"#8778BB"}},async showReadme(){this.myState.readme="";const t="readme.md";if(this.myState.files.map(e=>e.toLocaleLowerCase()).indexOf(t)>-1){if(!this.myState.svnRoot)return;const e=await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+t);this.myState.readme=this.mdRenderer.render(e)}},buildShowEverythingView(){for(const t of this.globalState.visualizationTypes.values()){const e=K(this.myState.files,t.filePatterns);for(const s of e)this.myState.vizes.push({component:t.kebabName,config:s,title:".."})}},async buildCuratedSummaryView(){if(!this.myState.svnRoot)return;const t=Ge.parse(await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+this.summaryYamlFilename));for(const e of t.plugins){const s=this.globalState.visualizationTypes.get(e);if(s)if(t[s.kebabName])for(const a of t[s.kebabName]){const r=await this.findMatchingFiles(a);for(const o of r)this.myState.vizes.push({component:s.kebabName,config:o,title:o})}else{const a=K(this.myState.files,s.filePatterns);for(const r of a)this.myState.vizes.push({component:s.kebabName,config:r,title:".."})}}},async findMatchingFiles(t){if(this.myState.files.indexOf(t)>-1)return[t];const e=K(this.myState.files,t);if(e.length)return e;if(!this.myState.svnRoot)return[];try{const s=t.split("/"),a=this.myState.subfolder+"/"+s[0];console.log(a);const r=await this.myState.svnRoot.getDirectory(a);return K(r.files,s[1]).map(u=>s[0]+"/"+u)}catch{}return[]},async fetchFolderContents(){if(!this.myState.svnRoot)return[];this.myState.isLoading=!0,this.myState.errorStatus="",this.myState.files=[];try{this.allConfigFiles=await this.findAllConfigsAndDashboards();const t=await this.myState.svnRoot.getDirectory(this.myState.subfolder),e=t.dirs.filter(o=>!o.startsWith(".")).sort(),s=t.files.filter(o=>!o.startsWith(".")).sort(),a=Object.assign({},this.allConfigFiles.vizes);for(const o of s)a[o]=o;const r=Object.values(a);this.myState.errorStatus="",this.myState.folders=["UP"].concat(e),this.myState.files=r}catch{const e=this.myState.subfolder.lastIndexOf("/");if(e>-1){this.subfolder=this.myState.subfolder.slice(0,e);return}else{this.subfolder="";return}}finally{this.myState.isLoading=!1}},clickedVisualization(t){if(this.myState.isLoading)return;const e=450;this.highlightedViz=t,this.clicks++,this.clicks===1?this.clickTimer=setTimeout(()=>{this.needDoubleClickHint=!0,this.clicks=0},e):(clearTimeout(this.clickTimer),this.needDoubleClickHint=!1,this.activateVisualization(t),this.clicks=0)},clickedOnFolder(t){this.needDoubleClickHint=!1;const{folder:e,root:s,i:a}=t;if(s){this.root=s,this.subfolder="",this.updateRoute();return}if(!this.myState.isLoading&&this.myState.svnProject){if(a==0&&e==="UP"){if(this.subfolder==="/"||this.subfolder==="")this.root="";else{const r=this.subfolder.lastIndexOf("/");this.subfolder=r>-1?this.subfolder.slice(0,r):"/"}return}this.subfolder=`${this.subfolder}/${e}`}},handleSingleClickFolder(t){const{folder:e,root:s,i:a}=t;if(s){this.root=s,this.subfolder="",this.updateRoute();return}if(this.myState.isLoading||!this.myState.svnProject||a==0&&e==="UP")return;const r=e===".."?this.myState.subfolder.substring(0,this.myState.subfolder.lastIndexOf("/")):this.myState.subfolder+"/"+e,o={root:this.myState.svnProject.slug,xsubfolder:r};!r&&!this.myState.subfolder?this.$emit("navigate",{component:"SplashPage",props:{}}):this.$emit("navigate",{component:"TabbedDashboardView",props:o})},dragEnd(){this.$emit("isDragging",!1)},dragStart(t,e){var r;this.$emit("isDragging",!0);const s=Object.assign({},e,{root:this.root,subfolder:this.myState.subfolder,xsubfolder:this.myState.subfolder});s.yamlConfig=s.config,delete s.config;const a=JSON.stringify(s);(r=t.dataTransfer)==null||r.setData("bundle",a)},clickedLogo(){this.$router.push("/")},async findAllConfigsAndDashboards(){if(!this.myState.svnRoot)return{dashboards:{},configs:{},vizes:{},topsheets:{}};try{const{files:t}=await this.myState.svnRoot.getDirectory(this.subfolder);let e=!0;qa.forEach(a=>{t.indexOf(a)>-1&&(e=!1)});const s=await this.myState.svnRoot.findAllYamlConfigs(this.subfolder);return e||(s.dashboards={}),s}catch{return{dashboards:{},configs:{},vizes:{},topsheets:{}}}},async clickedBrowseChromeLocalFolder(t){try{const e=await t.handle.requestPermission({mode:"read"});if(console.log(t.handle,e),e!=="granted")return;jt.find(r=>r.slug==t.key)||Ue(t.handle,t.key);const a={root:t.key};this.clickedOnFolder(a)}catch(e){console.error(""+e)}},async showChromeDirectory(){try{const e=await window.showDirectoryPicker(),s=Ue(e,null);this.$router.push(`${Va}${s}/`)}catch{}},async clickedDelete(t){const s=this.$store.state.localFileHandles.filter(a=>a.key!==t.key);await Bt("fs",s),this.$store.commit("setLocalFileSystem",s)}}});var Ja=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"panel"},[s("div",{staticClass:"top-panel"},[s("h4",[e._v("Files")]),e.root?s("div",{staticClass:"trail"},[s("div",{staticClass:"x-home"},[s("p",{on:{click:function(a){return e.clickedBreadcrumb({url:"//"})}}},[s("i",{staticClass:"fa fa-home"})])]),e.root?s("div",{staticClass:"x-breadcrumbs"},e._l(e.globalState.breadcrumbs.slice(1),function(a,r){return s("p",{key:a.url,on:{click:function(o){return e.clickedBreadcrumb(a)}}},[e._v(" / "+e._s(a.label))])}),0):e._e()]):e._e()]),s("div",{staticClass:"middle-panel"},[e.root?s("div",{staticClass:"curated-sections"},[s("h3",{staticClass:"curate-heading"},[e._v(e._s(e.globalState.breadcrumbs[e.globalState.breadcrumbs.length-1].label))]),e.myState.folders.length?s("div",{staticClass:"curate-content"},[s("div",{staticClass:"folder-table"},e._l(e.myState.folders,function(a,r){return s("div",{key:a,staticClass:"folder",class:{fade:e.myState.isLoading,upfolder:r==0},on:{click:function(o){return e.clickedOnFolder({folder:a,i:r})}}},[s("i",{staticClass:"fa",class:r==0?"fa-arrow-up":"fa-folder-open"}),s("p",[e._v(e._s(e.cleanName(a)))])])}),0),e.myState.folders.length==1?s("p",{staticStyle:{"font-size":"0.9rem",opacity:"0.7",margin:"0.5rem 0","text-align":"right"}},[e._v("No subfolders.")]):e._e()]):e._e(),e.vizMaps.size?s("div",{staticClass:"section-maps"},[s("h3",{staticClass:"curate-heading"},[e._v(e._s(e.$t("Maps")))]),s("div",{staticClass:"curate-content"},[s("div",{staticClass:"viz-table"},e._l(e.vizMaps.entries(),function([a,r]){return s("div",{key:a,staticClass:"viz-grid-item",on:{click:function(o){return e.clickedVisualization(a)}}},[s("div",{staticClass:"viz-frame",class:{highlighted:a===e.highlightedViz},attrs:{draggable:""},on:{dragstart:function(o){return e.dragStart(o,r)},dragend:e.dragEnd}},[s("p",{staticClass:"v-title"},[s("b",[e._v(e._s(r.title))])]),s("p",{staticClass:"v-filename"},[e._v(e._s(r.config))]),s("p",{staticClass:"v-plugin",style:e.getTabColor(r.component)},[e._v(e._s(r.component||"dashboard"))]),s(r.component,{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],tag:"component",staticClass:"viz-frame-component",style:{"pointer-events":"none"},attrs:{root:e.myState.svnProject.slug,subfolder:e.myState.subfolder,yamlConfig:r.config,thumbnail:!0,fileApi:e.myState.svnRoot},on:{title:function(o){return e.updateTitle(a,o)}}})],1)])}),0),s("div",{staticClass:"hint-clicks",style:{opacity:e.needDoubleClickHint?1:0}},[e._m(1)])])]):e._e(),Object.keys(e.vizImages).length?s("div",{staticClass:"section-images"},[s("h3",{staticClass:"curate-heading"},[e._v(e._s(e.$t("Images")))]),s("div",{staticClass:"curate-content"},[s("div",{staticClass:"viz-image-table"},e._l(Object.entries(e.vizImages),function([a,r]){return s("div",{key:a,staticClass:"viz-image-grid-item",on:{click:function(o){return e.clickedVisualization(a)}}},[s("div",{staticClass:"viz-image-frame"},[s(r.component,{tag:"component",staticClass:"viz-image-frame-component",style:{"pointer-events":"auto"},attrs:{root:e.myState.svnProject.slug,subfolder:e.myState.subfolder,yamlConfig:r.config,thumbnail:!0,fileApi:e.myState.svnRoot},on:{title:function(o){return e.updateTitle(a,o)}}}),s("p",[e._v(e._s(r.title))])],1)])}),0)])]):e._e()]):s("div",{staticClass:"curated-sections"},[e._m(0),e.isChrome?s("div",{staticClass:"is-chrome"},[s("h3",[e._v("Local Folders")]),e.localFileHandles.length?e._e():s("p",[e._v("Chrome & Edge can browse folders directly:")]),e._l(e.localFileHandles,function(a){return s("div",{key:a.key,staticClass:"project-root local",on:{click:function(r){return e.clickedBrowseChromeLocalFolder(a)}}},[s("h5",{staticClass:"remove-local",staticStyle:{flex:"1"}},[e._v(e._s(a.handle.name)),s("i",{staticClass:"fa fa-times",on:{click:function(r){return r.stopPropagation(),e.clickedDelete(a)}}})]),s("p",[e._v("Local folder")])])}),s("p",{staticClass:"config-sources"},[s("a",{on:{click:e.showChromeDirectory}},[e._v("Add local folder...")])])],2):e._e(),s("h3",{staticStyle:{"margin-top":"1rem"}},[e._v("Data Sources")]),e._l(e.allRoots,function(a){return s("div",{key:a.slug,staticClass:"project-root",on:{click:function(r){return e.clickedOnFolder({root:a.slug})}}},[s("h5",[e._v(e._s(a.name))]),s("p",[e._v(e._s(a.description))])])}),s("p",{staticClass:"config-sources"},[s("a",{on:{click:e.configureSources}},[e._v("Edit data sources...")])])],2)])])},Qa=[function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"hint-clicks",staticStyle:{"margin-bottom":"1rem",opacity:"1"}},[e("p",[t._v("You can browse to another folder from here. Drag panels into the main window area to open them side-by-side.")])])},function(){var t=this,e=t._self._c;return t._self._setupProxy,e("p",[e("b",[t._v("Drag")]),t._v(" or "),e("b",[t._v("double-click")]),t._v(" a tile"),e("br"),t._v("to open it in the main panel")])}];var ei=G(Ka,Ja,Qa,!1,null,"bd885598",null,null);const ti=ei.exports,si={messages:{en:{translate:"Note: German translations are incomplete, but steadily improving",theme:"Theme",light:"Light",dark:"Dark",language:"Language",dataSources:"Data Sources",addDataSources:"Add Data Source"},de:{translate:"Die Übersetzungen sind unvollständig, werden aber immer besser...",theme:"Thema",light:"Hell",dark:"Dunkel",language:"Sprache",dataSources:"Datenquellen"}}},ai=Y({name:"SettingsPanel",components:{AddDataSource:Xt},i18n:si,data:()=>({state:T.state,theme:"",shortcuts:[]}),mounted(){this.theme=this.state.isDarkMode?"dark":"light",this.setupShortcuts()},watch:{"state.svnProjects"(){this.setupShortcuts()},"state.isDarkMode"(){console.log("ooop!",this.state.isDarkMode),this.theme=this.state.isDarkMode?"dark":"light"}},computed:{isLight(){return this.theme=="light"?{backgroundColor:"#ffdd57",color:"#222",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}},isDark(){return this.theme=="dark"?{backgroundColor:"#7957d5",color:"white",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}},isEN(){return this.state.locale=="en"?{backgroundColor:"#ffdd57",color:"#222",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}},isDE(){return this.state.locale=="de"?{backgroundColor:"#ffdd57",color:"#222",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}}},methods:{setupShortcuts(){try{const t=localStorage.getItem("projectShortcuts");if(t){const e=JSON.parse(t);this.shortcuts=Object.values(e)}}catch(t){console.error("ERROR MERGING URL SHORTCUTS:",""+t)}},deleteShortcut(t){try{const e=localStorage.getItem("projectShortcuts");if(e){const s=JSON.parse(e);delete s[t],localStorage.setItem("projectShortcuts",JSON.stringify(s)),T.commit("removeURLShortcut",t),this.shortcuts=Object.values(s)}}catch(e){console.error("ERROR MERGING URL SHORTCUTS:",""+e)}},setTheme(t){this.theme=t,console.log(this.theme),T.commit("setTheme",t)},setLanguage(t){this.$store.commit("setLocale",t),this.$root.$i18n.locale=t}}});var ii=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"panel"},[e._m(0),s("div",{staticClass:"middle-panel"},[s("div",{staticClass:"option"},[s("h5",[e._v(e._s(e.$t("theme")))]),s("b-button",{staticClass:"button is-white",style:e.isLight,attrs:{outlined:""},on:{click:function(a){return e.setTheme("light")}}},[e._v(e._s(e.$t("light")))]),s("b-button",{staticClass:"button is-gray",style:e.isDark,attrs:{outlined:""},on:{click:function(a){return e.setTheme("dark")}}},[e._v(e._s(e.$t("dark")))])],1),s("div",{staticClass:"option"},[s("h5",[e._v(e._s(e.$t("language")))]),s("b-button",{staticClass:"button is-white",style:e.isEN,attrs:{outlined:""},on:{click:function(a){return e.setLanguage("en")}}},[e._v("EN")]),s("b-button",{staticClass:"button is-gray",style:e.isDE,attrs:{outlined:""},on:{click:function(a){return e.setLanguage("de")}}},[e._v("DE")])],1),s("div",{staticClass:"option"},[s("h5",[e._v(e._s(e.$t("dataSources")))]),e._l(e.shortcuts,function(a){return s("div",{key:a.slug,staticClass:"source flex-row"},[s("div",{staticClass:"desc flex1"},[s("p",[s("b",[e._v(e._s(a.slug))])]),s("p",[e._v(e._s(a.description))])]),s("div",{staticClass:"delete",on:{click:function(r){return e.deleteShortcut(a.slug)}}})])})],2),s("div",{staticClass:"option"},[s("h5",[e._v(e._s(e.$t("addDataSources")))]),s("add-data-source")],1)])])},ri=[function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"top-panel"},[e("h4",[t._v("Settings")])])}];var oi=G(ai,ii,ri,!1,null,"c32d4b8f",null,null);const ni=oi.exports,li={messages:{en:{close:"Close panel",back:"Go back"},de:{close:"Schließen",back:"Zurück"}}},xe="/sandbox/",ut=300,ci=Y({name:"LayoutManager",i18n:li,components:Object.assign({LeftIconPanel:Pa,BrowserPanel:ti,FolderBrowser:Yt,ErrorPanel:Ha,SettingsPanel:ni,SplashPage:Ta,TabbedDashboardView:ra},gt),data:()=>({panels:[],leftSections:["BrowserPanel","ErrorPanel","SettingsPanel"],panelsWithScrollbars:["TabbedDashboardView","FolderBrowser","calc-table"],zoomed:!1,isEmbedded:!1,fullScreenPanel:{x:-1,y:-1},activeLeftSection:{name:"Files",class:"BrowserPanel"},leftSectionWidth:ut,isDraggingDivider:0,dragStartWidth:0,quadrant:null,dragX:-1,dragY:-1,isDragHappening:!1,isShowingActiveSection:!1,authHandles:[]}),computed:{isMultipanel(){return this.panels.length>1?!0:this.panels[0].length>1},showLeftBar(){return this.$store.state.isShowingLeftBar},activeSectionStyle(){return this.activeLeftSection?{width:`${this.leftSectionWidth}px`}:{display:"none"}}},watch:{"$store.state.statusErrors"(){this.$store.state.statusErrors.length&&(this.activeLeftSection={name:"Issues",class:"ErrorPanel"})},$route(t,e){t.path===xe?this.panels=[[{component:"SplashPage",key:Math.random(),props:{}}]]:(this.buildLayoutFromURL(),T.commit("resize"))}},methods:{setActiveLeftSection(t){if(!(t.section.onlyIfVisible&&!this.isShowingActiveSection)){if(this.isShowingActiveSection&&t.section.name===this.activeLeftSection.name){t.toggle&&(this.isShowingActiveSection=!1);return}if(t.section.link){window.open(t.section.link,"_blank");return}this.isShowingActiveSection=!0,this.activeLeftSection=t.section,localStorage.setItem("activeLeftSection",JSON.stringify(t.section)),this.leftSectionWidth<48&&(this.leftSectionWidth=ut)}},buildLayoutFromURL(){let t=this.$route.params.pathMatch;if(t.startsWith("/")&&(t=t.slice(1)),!t||t==="/"){this.panels=[[{component:"SplashPage",key:Math.random(),props:{}}]];return}if(t.startsWith("split/")){const W=t.substring(6);try{const B=atob(W),Q=JSON.parse(B);this.panels=Q}catch(B){console.error("PARSING SPLIT"+B),this.$router.replace("/")}return}let e=t,s="";const a=t.indexOf("/");a>-1&&(e=t.substring(0,a),s=t.substring(a+1));const r=t.substring(1+t.lastIndexOf("/")),o=r.toLocaleLowerCase();for(const W of T.state.visualizationTypes.values())if(K.isMatch(o,W.filePatterns)){if(this.panels.length===1&&this.panels[0].length===1)this.panels=[[this.panels[0][0]]];else{let B=Math.random();this.panels=[[{key:B,component:W.kebabName,title:"",description:"",props:{root:e,subfolder:s.substring(0,s.lastIndexOf("/")),yamlConfig:r,thumbnail:!1}}]]}return}let u=Math.random();this.panels.length===1&&this.panels[0].length===1&&(u=this.panels[0][0].key);const m=this.$store.state.svnProjects.filter(W=>W.slug===e);if(!m.length)throw Error("no such project");const _=m[0],D=s.startsWith("/")?s.slice(1):s,L=`${_.name}: ${D}`;this.panels=[[{key:u,title:L,component:"TabbedDashboardView",props:{root:e,xsubfolder:s}}]]},handleDragStartStop(t){this.isDragHappening=t},buildDragHighlightStyle(t,e){if(t==-1){const r=this.quadrant=="rowTop"?"1":"0",o=this.isDragHappening?"auto":"none";return{top:0,opacity:r,pointerEvents:o,backgroundColor:"#ffcc4480"}}if(t==-2){const r=this.quadrant=="rowBottom"?"1":"0",o=this.isDragHappening?"auto":"none";return{bottom:0,opacity:r,pointerEvents:o,backgroundColor:"#ffcc4480"}}if(t!==this.dragX||e!==this.dragY||!this.quadrant)return{};const a={opacity:1,backgroundColor:this.quadrant.quadrant=="center"?"#079f6f80":"#4444dd90"};return Object.entries(this.quadrant).forEach(r=>a[r[0]]=`${r[1]}px`),a},stillDragging(t){const{event:e,x:s,y:a,row:r}=t;if(r){this.quadrant=r;return}this.dragX=s,this.dragY=a;const o=this.$refs[`dragContainer${s}-${a}`],m=this.$refs.tileTable.offsetLeft,_=o[0],D=(e.clientX-_.offsetLeft-m)/_.offsetWidth;(e.clientY-_.offsetTop)/_.offsetHeight;let L=8;if(D<.3)this.quadrant={quadrant:"left",width:_.offsetWidth/2-L*2,height:_.offsetHeight-L*2,marginLeft:L,marginTop:L};else if(D>.7)this.quadrant={quadrant:"right",width:_.offsetWidth/2-L*2,height:_.offsetHeight-L*2,marginLeft:_.offsetWidth/2+L,marginTop:L};else{L*=5;const W=(_.offsetWidth-L*2)*.95,B=(_.offsetHeight-L*2)*.95;this.quadrant={quadrant:"center",width:W,height:B,marginLeft:(_.offsetWidth-W)/2,marginTop:(_.offsetHeight-B)/2}}},dragEnd(){this.quadrant=null,this.dragX=-1,this.dragY=-1},onDrop(t){var o;if(!this.quadrant)return;const{event:e,x:s,y:a,row:r}=t;try{const u=(o=e.dataTransfer)==null?void 0:o.getData("bundle"),m=JSON.parse(u),D={component:m.component||"TabbedDashboardView",props:m};this.onSplit({x:s,y:a,row:r,quadrant:this.quadrant.quadrant,viz:D})}catch(u){console.warn(""+u)}this.dragEnd()},async onSplit(t){const{x:e,y:s,row:a,quadrant:r,viz:o}=t,u={component:o.component,props:o.props,title:"",description:"",key:Math.random()};if(a)switch(a){case"rowTop":this.panels.unshift([u]);break;case"rowBottom":this.panels.push([u]);break;default:console.warn("HUH?",a);break}else switch(r){case"center":this.panels[s][e]=u;break;case"left":this.panels[s].splice(e,0,u);break;case"right":this.panels[s].splice(e+1,0,u);break;default:console.warn("TOP AND BOTTOM to be added later");return}this.updateURL(),T.commit("resize")},onNavigate(t,e,s){t.component==="SplashPage"?this.panels[s][e]={component:"SplashPage",props:{},key:Math.random()}:this.panels[s][e]=Object.assign({key:Math.random()},t),this.updateURL(),this.buildLayoutFromURL()},onClose(t,e){this.panels[e][t].component=null,this.panels[e].splice(t,1),this.panels[e].length||(this.panels.length>1?this.panels.splice(e,1):this.panels[0].push({component:"SplashPage",key:Math.random(),props:{}})),this.updateURL(),T.commit("resize")},onBack(t,e){this.panels[e][t].component="TabbedDashboardView",this.panels[e][t].props.xsubfolder=this.panels[e][t].props.subfolder,delete this.panels[e][t].props.yamlConfig,this.updateURL()},getShowHeader(t){return t.component==="SplashPage"?!1:this.showLeftBar?!0:!(this.panels.length==1&&this.panels[0].length==1)},updateURL(){if(this.panels.length===1&&this.panels[0].length===1){const t=this.panels[0][0].props,e=t.root||"",s=t.xsubfolder||t.subfolder||"",a=t.yamlConfig||"";if(a.indexOf("/")>-1){const r=a.substring(a.lastIndexOf("/"));this.$router.replace(`${xe}${e}/${s}/${r}`)}else if(a)this.$router.push(`${xe}${e}/${s}/${a}`);else{let r=`${xe}${e}/${s}`;t.config&&(r+=`/${t.config}`),this.$router.push(r)}}else{const t=btoa(JSON.stringify(this.panels));this.$router.push(`${xe}split/${t}`)}},cleanProps(t){const{title:e,...s}=t;return s},dividerDragStart(t){this.isDraggingDivider=t.clientX,this.dragStartWidth=this.leftSectionWidth},dividerDragEnd(t){this.isDraggingDivider=0},dividerDragging(t){if(!this.isDraggingDivider)return;const e=t.clientX-this.isDraggingDivider;this.leftSectionWidth=Math.max(0,this.dragStartWidth+e),localStorage.setItem("leftPanelWidth",`${this.leftSectionWidth}`)},setCardTitles(t,e){typeof e=="string"?(mt.set(t,"title",e),t.description=""):(t.title=e.title,t.description=e.description||"")},async handleToggleInfoClicked(t){console.log("CARD INFO?",t)},async toggleZoom(t,e,s){console.log("ZOOM",t),this.fullScreenPanel.x>-1?this.fullScreenPanel={x:-1,y:-1}:this.fullScreenPanel={x:e,y:s}},updateDimensions(t){},getTileStyle(t){return{overflow:this.panelsWithScrollbars.includes(t.component)?"auto":"hidden"}},getContainerStyle(t,e,s){let a={padding:this.isMultipanel?"5px 5px":"0"};return this.fullScreenPanel.x==-1||(this.fullScreenPanel.x!==e?a.display="none":a={position:"absolute",top:0,bottom:0,left:0,right:0,margin:"5px 5px"}),a}},mounted(){"embed"in this.$route.query&&(this.isEmbedded=!0);const t=localStorage.getItem("leftPanelWidth");this.leftSectionWidth=t==null?ut:parseInt(t),this.leftSectionWidth<0&&(this.leftSectionWidth=2);const e=localStorage.getItem("activeLeftSection");if(e)try{this.activeLeftSection=JSON.parse(e)}catch{this.activeLeftSection={name:"Files",class:"BrowserPanel"}}else this.activeLeftSection={name:"Files",class:"BrowserPanel"};this.buildLayoutFromURL()}});var di=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{style:{userSelect:e.isDraggingDivider?"none":"unset"},attrs:{id:"split-screen"},on:{mousemove:e.dividerDragging,mouseup:e.dividerDragEnd}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showLeftBar,expression:"showLeftBar"}],staticClass:"left-panel"},[s("left-icon-panel",{attrs:{activeSection:e.activeLeftSection.name},on:{activate:function(a){return e.setActiveLeftSection({section:a,toggle:!0})}}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowingActiveSection,expression:"isShowingActiveSection"}],staticClass:"left-panel-active-section",style:e.activeSectionStyle},e._l(e.leftSections,function(a){return s(a,{directives:[{name:"show",rawName:"v-show",value:a==e.activeLeftSection.class,expression:"section==activeLeftSection.class"}],key:a,tag:"component",on:{navigate:function(r){return e.onNavigate(r,0,0)},activate:function(r){return e.setActiveLeftSection({section:r,toggle:!1})},isDragging:e.handleDragStartStop}})}),1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.activeLeftSection,expression:"activeLeftSection"}],staticClass:"left-panel-divider",on:{mousedown:e.dividerDragStart,mouseup:e.dividerDragEnd,mousemove:function(a){return a.stopPropagation(),e.dividerDragging.apply(null,arguments)}}})],1),s("div",{ref:"tileTable",staticClass:"table-of-tiles"},[e.authHandles.length?s("div",{staticClass:"authorization-strip"},e._l(e.authHandles,function(a){return s("div",{staticClass:"auth-row"},[s("p",{staticClass:"flex1"},[e._v(e._s(""+a))]),s("b-button",[e._v("hello")])],1)}),0):e._e(),s("div",{staticClass:"row-drop-target",style:e.buildDragHighlightStyle(-1,-1),on:{drop:function(a){return e.onDrop({event:a,row:"rowTop"})},dragover:[function(a){return e.stillDragging({event:a,row:"rowTop"})},function(a){a.preventDefault()}],dragenter:function(a){a.preventDefault()},dragleave:e.dragEnd}}),e._l(e.panels,function(a,r){return s("div",{directives:[{name:"show",rawName:"v-show",value:e.fullScreenPanel.y==-1||e.fullScreenPanel.y==r,expression:"fullScreenPanel.y == -1 || fullScreenPanel.y == y"}],key:r,staticClass:"tile-row"},e._l(a,function(o,u){return s("div",{key:o.key,ref:`dragContainer${u}-${r}`,refInFor:!0,staticClass:"drag-container",style:e.getContainerStyle(o,u,r),on:{drop:function(m){return e.onDrop({event:m,x:u,y:r})},dragover:[function(m){m.preventDefault()},function(m){return e.stillDragging({event:m,x:u,y:r})}],dragenter:function(m){m.preventDefault()},dragleave:e.dragEnd}},[e.getShowHeader(o)?s("div",{staticClass:"tile-header flex-row"},[s("div",{staticClass:"tile-labels"},[s("h3",{style:{textAlign:e.isMultipanel?"left":"center"}},[e._v(e._s(o.title))]),o.description?s("p",[e._v(e._s(o.description))]):e._e()]),s("div",{staticClass:"tile-buttons"},[o.info?s("div",{staticClass:"nav-button is-small is-white",on:{click:function(m){return e.handleToggleInfoClicked(o)}}},[s("i",{staticClass:"fa fa-info-circle"})]):e._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:e.panels.length>1||e.panels[0].length>1,expression:"panels.length > 1 || panels[0].length > 1"}],staticClass:"nav-button is-small is-white",attrs:{title:e.fullScreenPanel.x>-1?"Restore":"Enlarge"},on:{click:function(m){return e.toggleZoom(o,u,r)}}},[s("i",{staticClass:"fa fa-expand"})]),s("div",{staticClass:"nav-button is-small is-white",attrs:{title:"Close"},on:{click:function(m){return e.onClose(u,r)}}},[s("i",{staticClass:"fa fa-times-circle"})])])]):e._e(),s(o.component,e._b({tag:"component",staticClass:"map-tile",style:e.getTileStyle(o),on:{navigate:function(m){return e.onNavigate(m,u,r)},title:function(m){return e.setCardTitles(o,m)},activate:function(m){return e.setActiveLeftSection({section:m,toggle:!0})}}},"component",e.cleanProps(o.props),!1)),e.isDragHappening?s("div",{staticClass:"drag-highlight",style:e.buildDragHighlightStyle(u,r)}):e._e()],1)}),0)}),e.isDragHappening?s("div",{staticClass:"row-drop-target",style:e.buildDragHighlightStyle(-2,-2),on:{drop:function(a){return e.onDrop({event:a,row:"rowBottom"})},dragover:[function(a){return e.stillDragging({event:a,row:"rowBottom"})},function(a){a.preventDefault()}],dragenter:function(a){a.preventDefault()},dragleave:e.dragEnd}}):e._e()],2)])},ui=[];var mi=G(ci,di,ui,!1,null,"f5a82a4d",null,null);const Ti=mi.exports;export{Ti as default};
//# sourceMappingURL=LayoutManager-16869b5e.js.map
